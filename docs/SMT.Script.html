<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SMT.Script</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="SMT.Theory.html" class="Module">SMT.Theory</a>

<a id="25" class="Keyword">module</a> <a id="32" href="SMT.Script.html" class="Module">SMT.Script</a> <a id="43" class="Symbol">(</a><a id="44" href="SMT.Script.html#44" class="Bound">theory</a> <a id="51" class="Symbol">:</a> <a id="53" href="SMT.Theory.html#1649" class="Record">Theory</a><a id="59" class="Symbol">)</a> <a id="61" class="Keyword">where</a>

<a id="68" class="Keyword">open</a> <a id="73" class="Keyword">import</a> <a id="80" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="89" class="Symbol">as</a> <a id="92" class="Module">Fin</a> <a id="96" class="Keyword">using</a> <a id="102" class="Symbol">(</a><a id="103" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="106" class="Symbol">;</a> <a id="108" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a><a id="111" class="Symbol">;</a> <a id="113" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a><a id="117" class="Symbol">)</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Data.List.html" class="Module">Data.List</a> <a id="141" class="Symbol">as</a> <a id="144" class="Module">List</a> <a id="149" class="Keyword">using</a> <a id="155" class="Symbol">(</a><a id="156" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="160" class="Symbol">;</a> <a id="162" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="165" class="Symbol">;</a> <a id="167" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="169" class="Symbol">;</a> <a id="171" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="175" class="Symbol">)</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="208" class="Symbol">as</a> <a id="211" class="Module">List⁺</a> <a id="217" class="Keyword">using</a> <a id="223" class="Symbol">(</a><a id="224" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a><a id="229" class="Symbol">;</a> <a id="231" href="Data.List.NonEmpty.html#1364" class="InductiveConstructor Operator">_∷_</a><a id="234" class="Symbol">)</a>
<a id="236" class="Keyword">open</a> <a id="241" class="Keyword">import</a> <a id="248" href="Data.Product.html" class="Module">Data.Product</a> <a id="261" class="Symbol">as</a> <a id="264" class="Module">Prod</a> <a id="269" class="Keyword">using</a> <a id="275" class="Symbol">(</a><a id="276" href="Data.Product.html#1369" class="Function">∃</a><a id="277" class="Symbol">;</a> <a id="279" href="Data.Product.html#1788" class="Function">∃-syntax</a><a id="287" class="Symbol">;</a> <a id="289" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="292" class="Symbol">)</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="323" class="Keyword">using</a> <a id="329" class="Symbol">(</a><a id="330" href="Relation.Nullary.html#1508" class="Record">Dec</a><a id="333" class="Symbol">;</a> <a id="335" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a><a id="338" class="Symbol">;</a> <a id="340" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a><a id="342" class="Symbol">)</a>
<a id="344" class="Keyword">open</a> <a id="349" class="Keyword">import</a> <a id="356" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="383" class="Keyword">using</a> <a id="389" class="Symbol">(</a><a id="390" href="Relation.Nullary.Decidable.Core.html#1365" class="Function">True</a><a id="394" class="Symbol">)</a>
<a id="396" class="Keyword">open</a> <a id="401" class="Keyword">import</a> <a id="408" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="446" class="Keyword">using</a> <a id="452" class="Symbol">(</a><a id="453" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="456" class="Symbol">;</a> <a id="458" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="462" class="Symbol">)</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="SMT.Logics.html" class="Module">SMT.Logics</a>
<a id="487" class="Keyword">open</a> <a id="492" class="Keyword">import</a> <a id="499" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="516" class="Symbol">as</a> <a id="519" class="Module">Env</a> <a id="523" class="Keyword">using</a> <a id="529" class="Symbol">(</a><a id="530" href="Data.Environment.html#360" class="Datatype">Env</a><a id="533" class="Symbol">;</a> <a id="535" href="Data.Environment.html#427" class="InductiveConstructor Operator">_∷_</a><a id="538" class="Symbol">;</a> <a id="540" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="542" class="Symbol">)</a>

<a id="545" class="Keyword">open</a> <a id="550" class="Keyword">import</a> <a id="557" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="572" class="Keyword">open</a> <a id="577" class="Keyword">import</a> <a id="584" href="Category.Monad.State.html" class="Module">Category.Monad.State</a> <a id="605" class="Symbol">as</a> <a id="608" class="Module">StateCat</a> <a id="617" class="Keyword">using</a> <a id="623" class="Symbol">(</a><a id="624" href="Category.Monad.State.html#2659" class="Record">RawIMonadState</a><a id="638" class="Symbol">;</a> <a id="640" href="Category.Monad.State.html#666" class="Function">IStateT</a><a id="647" class="Symbol">)</a>
<a id="649" class="Keyword">open</a> <a id="654" class="Keyword">import</a> <a id="661" href="Codata.Musical.Stream.html" class="Module">Codata.Musical.Stream</a> <a id="683" class="Symbol">as</a> <a id="686" class="Module">Stream</a> <a id="693" class="Keyword">using</a> <a id="699" class="Symbol">(</a><a id="700" href="Codata.Musical.Stream.html#674" class="Datatype">Stream</a><a id="706" class="Symbol">)</a>
<a id="708" class="Keyword">open</a> <a id="713" class="Keyword">import</a> <a id="720" href="Data.Char.html" class="Module">Data.Char</a> <a id="730" class="Symbol">as</a> <a id="733" class="Module">Char</a> <a id="738" class="Keyword">using</a> <a id="744" class="Symbol">(</a><a id="745" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="749" class="Symbol">)</a>
<a id="751" class="Keyword">open</a> <a id="756" class="Keyword">import</a> <a id="763" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="774" class="Symbol">as</a> <a id="777" class="Module">Maybe</a> <a id="783" class="Keyword">using</a> <a id="789" class="Symbol">(</a><a id="790" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="795" class="Symbol">;</a> <a id="797" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="801" class="Symbol">;</a> <a id="803" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="810" class="Symbol">)</a>
<a id="812" class="Keyword">open</a> <a id="817" class="Keyword">import</a> <a id="824" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="833" class="Symbol">as</a> <a id="836" class="Module">Nat</a> <a id="840" class="Keyword">using</a> <a id="846" class="Symbol">(</a><a id="847" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="848" class="Symbol">)</a>
<a id="850" class="Keyword">open</a> <a id="855" class="Keyword">import</a> <a id="862" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="876" class="Keyword">renaming</a> <a id="885" class="Symbol">(</a><a id="886" href="Data.Nat.Show.html#1076" class="Function">show</a> <a id="891" class="Symbol">to</a> <a id="Show.show"></a><a id="894" href="SMT.Script.html#894" class="Function">showℕ</a><a id="899" class="Symbol">)</a>
<a id="901" class="Keyword">open</a> <a id="906" class="Keyword">import</a> <a id="913" href="Data.Product.html" class="Module">Data.Product</a> <a id="926" class="Symbol">as</a> <a id="929" class="Module">Product</a> <a id="937" class="Keyword">using</a> <a id="943" class="Symbol">(</a><a id="944" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="947" class="Symbol">;</a> <a id="949" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="952" class="Symbol">;</a> <a id="954" href="Data.Product.html#2211" class="Function Operator">-,_</a><a id="957" class="Symbol">;</a> <a id="959" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="964" class="Symbol">;</a> <a id="966" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="971" class="Symbol">)</a>
<a id="973" class="Keyword">open</a> <a id="978" class="Keyword">import</a> <a id="985" href="Data.String.html" class="Module">Data.String</a> <a id="997" class="Symbol">as</a> <a id="1000" class="Module">String</a> <a id="1007" class="Keyword">using</a> <a id="1013" class="Symbol">(</a><a id="1014" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="1020" class="Symbol">)</a>
<a id="1022" class="Keyword">open</a> <a id="1027" class="Keyword">import</a> <a id="1034" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="1044" class="Symbol">as</a> <a id="1047" class="Module">Unit</a> <a id="1052" class="Keyword">using</a> <a id="1058" class="Symbol">(</a><a id="1059" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="1060" class="Symbol">)</a>
<a id="1062" class="Keyword">open</a> <a id="1067" class="Keyword">import</a> <a id="1074" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1083" class="Symbol">as</a> <a id="1086" class="Module">Vec</a> <a id="1090" class="Keyword">using</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="1100" class="Symbol">)</a>
<a id="1102" class="Keyword">open</a> <a id="1107" class="Keyword">import</a> <a id="1114" href="Function.html" class="Module">Function</a> <a id="1123" class="Keyword">using</a> <a id="1129" class="Symbol">(</a><a id="1130" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="1133" class="Symbol">;</a> <a id="1135" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="1138" class="Symbol">;</a> <a id="1140" href="Function.Base.html#636" class="Function">const</a><a id="1145" class="Symbol">;</a> <a id="1147" href="Function.Base.html#1554" class="Function">flip</a><a id="1151" class="Symbol">;</a> <a id="1153" href="Function.Base.html#615" class="Function">id</a><a id="1155" class="Symbol">)</a>
<a id="1157" class="Keyword">import</a> <a id="1164" href="Function.Identity.Categorical.html" class="Module">Function.Identity.Categorical</a> <a id="1194" class="Symbol">as</a> <a id="1197" class="Module">Identity</a>
<a id="1206" class="Keyword">open</a> <a id="1211" class="Keyword">import</a> <a id="1218" href="Text.Parser.String.html" class="Module">Text.Parser.String</a> <a id="1237" class="Symbol">as</a> <a id="1240" class="Module">P</a> <a id="1242" class="Keyword">hiding</a> <a id="1249" class="Symbol">(</a><a id="1250" href="Text.Parser.String.html#3776" class="Function Operator">_&gt;&gt;=_</a><a id="1255" class="Symbol">)</a>
<a id="1257" class="Keyword">import</a> <a id="1264" href="Reflection.html" class="Module">Reflection</a> <a id="1275" class="Symbol">as</a> <a id="1278" class="Module">Rfl</a>

<a id="1283" class="Keyword">open</a> <a id="1288" href="SMT.Theory.html#1649" class="Module">Theory</a> <a id="1295" href="SMT.Script.html#44" class="Bound">theory</a>

<a id="1303" class="Keyword">open</a> <a id="1308" class="Keyword">import</a> <a id="1315" href="SMT.Script.Base.html" class="Module">SMT.Script.Base</a> <a id="1331" href="SMT.Theory.html#1681" class="Field">baseTheory</a> <a id="1342" class="Keyword">public</a>
<a id="1349" class="Keyword">open</a> <a id="1354" class="Keyword">import</a> <a id="1361" href="SMT.Script.Names.html" class="Module">SMT.Script.Names</a> <a id="1378" href="SMT.Theory.html#1681" class="Field">baseTheory</a>

<a id="1390" class="Keyword">private</a>
  <a id="1400" class="Keyword">variable</a>
    <a id="1413" href="SMT.Script.html#1413" class="Generalizable">σ</a> <a id="1415" href="SMT.Script.html#1415" class="Generalizable">σ′</a>    <a id="1421" class="Symbol">:</a> <a id="1423" href="SMT.Theory.html#928" class="Function">Sort</a>
    <a id="1432" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="1434" href="SMT.Script.html#1434" class="Generalizable">Γ′</a> <a id="1437" href="SMT.Script.html#1437" class="Generalizable">δΓ</a> <a id="1440" class="Symbol">:</a> <a id="1442" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a>
    <a id="1451" href="SMT.Script.html#1451" class="Generalizable">Δ</a> <a id="1453" href="SMT.Script.html#1453" class="Generalizable">Δ′</a>    <a id="1459" class="Symbol">:</a> <a id="1461" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a>
    <a id="1470" href="SMT.Script.html#1470" class="Generalizable">Σ</a>       <a id="1478" class="Symbol">:</a> <a id="1480" href="SMT.Theory.html#372" class="Record">Signature</a> <a id="1490" href="SMT.Script.html#1413" class="Generalizable">σ</a>
    <a id="1496" href="SMT.Script.html#1496" class="Generalizable">Σ′</a>      <a id="1504" class="Symbol">:</a> <a id="1506" href="SMT.Theory.html#372" class="Record">Signature</a> <a id="1516" href="SMT.Script.html#1415" class="Generalizable">σ′</a>
    <a id="1523" href="SMT.Script.html#1523" class="Generalizable">ξ</a> <a id="1525" href="SMT.Script.html#1525" class="Generalizable">ξ′</a>    <a id="1531" class="Symbol">:</a> <a id="1533" href="SMT.Script.Base.html#4623" class="Datatype">OutputType</a>
    <a id="1548" href="SMT.Script.html#1548" class="Generalizable">Ξ</a> <a id="1550" href="SMT.Script.html#1550" class="Generalizable">Ξ′</a> <a id="1553" href="SMT.Script.html#1553" class="Generalizable">δΞ</a> <a id="1556" class="Symbol">:</a> <a id="1558" href="SMT.Script.Base.html#4717" class="Function">OutputCtxt</a>


<a id="1571" class="Comment">-- * Variable parsers</a>

<a id="1594" class="Comment">-- |Environment of variable parsers.</a>
<a id="VarParsers"></a><a id="1631" href="SMT.Script.html#1631" class="Function">VarParsers</a> <a id="1642" class="Symbol">:</a> <a id="1644" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a> <a id="1649" class="Symbol">→</a> <a id="1651" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1655" href="SMT.Script.html#1631" class="Function">VarParsers</a> <a id="1666" class="Symbol">=</a> <a id="1668" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="1672" class="Symbol">(λ</a> <a id="1675" href="SMT.Script.html#1675" class="Bound">σ</a> <a id="1677" href="SMT.Script.html#1677" class="Bound">Γ</a> <a id="1679" class="Symbol">→</a> <a id="1681" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1684" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="1691" class="Symbol">((</a><a id="1693" href="SMT.Script.html#1675" class="Bound">σ</a> <a id="1695" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1697" href="SMT.Script.html#1677" class="Bound">Γ</a><a id="1698" class="Symbol">)</a> <a id="1700" href="SMT.Script.Base.html#1249" class="Function Operator">∋</a> <a id="1702" href="SMT.Script.html#1675" class="Bound">σ</a><a id="1703" class="Symbol">)</a> <a id="1705" href="Relation.Unary.html#3359" class="Function">]</a><a id="1706" class="Symbol">)</a>

<a id="1709" class="Comment">-- |Construct a single variable parser from an environment of variable parsers.</a>
<a id="mkVarParser"></a><a id="1789" href="SMT.Script.html#1789" class="Function">mkVarParser</a> <a id="1801" class="Symbol">:</a> <a id="1803" href="SMT.Script.html#1631" class="Function">VarParsers</a> <a id="1814" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="1816" class="Symbol">→</a> <a id="1818" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1821" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="1828" class="Symbol">(</a><a id="1829" href="Data.Product.html#1788" class="Function">∃[</a> <a id="1832" href="SMT.Script.html#1832" class="Bound">σ</a> <a id="1834" href="Data.Product.html#1788" class="Function">]</a> <a id="1836" class="Symbol">(</a><a id="1837" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="1839" href="SMT.Script.Base.html#1249" class="Function Operator">∋</a> <a id="1841" href="SMT.Script.html#1832" class="Bound">σ</a><a id="1842" class="Symbol">))</a> <a id="1845" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="1847" href="SMT.Script.html#1789" class="Function">mkVarParser</a> <a id="1859" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>            <a id="1873" class="Symbol">=</a> <a id="1875" href="Text.Parser.String.html#4819" class="Function">fail</a>
<a id="1880" href="SMT.Script.html#1789" class="Function">mkVarParser</a> <a id="1892" class="Symbol">(</a><a id="1893" href="SMT.Script.html#1893" class="Bound">p</a> <a id="1895" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="1897" href="SMT.Script.html#1897" class="Bound">env</a><a id="1900" class="Symbol">)</a> <a id="1902" class="Symbol">{</a><a id="1903" href="SMT.Script.html#1903" class="Bound">x</a><a id="1904" class="Symbol">}</a> <a id="1906" class="Symbol">=</a> <a id="1908" class="Symbol">(</a><a id="1909" href="Data.Product.html#2211" class="Function Operator">-,_</a> <a id="1913" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="1917" href="SMT.Script.html#1893" class="Bound">p</a> <a id="1919" class="Symbol">{</a><a id="1920" href="SMT.Script.html#1903" class="Bound">x</a><a id="1921" class="Symbol">})</a> <a id="1924" href="Text.Parser.String.html#4892" class="Function Operator">&lt;|&gt;</a> <a id="1928" class="Symbol">(</a><a id="1929" href="Data.Product.html#2450" class="Function">Prod.map</a> <a id="1938" href="Function.Base.html#615" class="Function">id</a> <a id="1941" href="SMT.Script.Base.html#2364" class="Function">extendVar</a> <a id="1951" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="1955" href="SMT.Script.html#1789" class="Function">mkVarParser</a> <a id="1967" href="SMT.Script.html#1897" class="Bound">env</a> <a id="1971" class="Symbol">{</a><a id="1972" href="SMT.Script.html#1903" class="Bound">x</a><a id="1973" class="Symbol">})</a>


<a id="1978" class="Comment">-- * Output parsers</a>

<a id="1999" class="Comment">-- |Mapping from output types to parser types.</a>
<a id="OutputParser"></a><a id="2046" href="SMT.Script.html#2046" class="Function">OutputParser</a> <a id="2059" class="Symbol">:</a> <a id="2061" href="SMT.Script.Base.html#4623" class="Datatype">OutputType</a> <a id="2072" class="Symbol">→</a> <a id="2074" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2078" href="SMT.Script.html#2046" class="Function">OutputParser</a> <a id="2091" href="SMT.Script.html#2091" class="Bound">ξ</a> <a id="2093" class="Symbol">=</a> <a id="2095" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2098" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2105" class="Symbol">(</a><a id="2106" href="SMT.Script.Base.html#5686" class="Function">Output</a> <a id="2113" href="SMT.Script.html#2091" class="Bound">ξ</a><a id="2114" class="Symbol">)</a> <a id="2116" href="Relation.Unary.html#3359" class="Function">]</a>

<a id="2119" class="Comment">-- |Mapping from output contexts to parser types.</a>
<a id="OutputParsers"></a><a id="2169" href="SMT.Script.html#2169" class="Function">OutputParsers</a> <a id="2183" class="Symbol">:</a> <a id="2185" href="SMT.Script.Base.html#4717" class="Function">OutputCtxt</a> <a id="2196" class="Symbol">→</a> <a id="2198" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2202" href="SMT.Script.html#2169" class="Function">OutputParsers</a> <a id="2216" href="SMT.Script.html#2216" class="Bound">Ξ</a> <a id="2218" class="Symbol">=</a> <a id="2220" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="2224" class="Symbol">(λ</a> <a id="2227" href="SMT.Script.html#2227" class="Bound">ξ</a> <a id="2229" href="SMT.Script.html#2229" class="Bound Operator">_Ξ</a> <a id="2232" class="Symbol">→</a> <a id="2234" href="SMT.Script.html#2046" class="Function">OutputParser</a> <a id="2247" href="SMT.Script.html#2227" class="Bound">ξ</a><a id="2248" class="Symbol">)</a> <a id="2250" href="SMT.Script.html#2216" class="Bound">Ξ</a>

<a id="2253" class="Comment">-- |Parse a satisfiability result.</a>
<a id="pSat"></a><a id="2288" href="SMT.Script.html#2288" class="Function">pSat</a> <a id="2293" class="Symbol">:</a> <a id="2295" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2298" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2305" href="SMT.Script.Base.html#4868" class="Datatype">Sat</a> <a id="2309" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="2311" href="SMT.Script.html#2288" class="Function">pSat</a> <a id="2316" class="Symbol">=</a> <a id="2318" href="SMT.Script.Base.html#4886" class="InductiveConstructor">sat</a>     <a id="2326" href="Text.Parser.String.html#5086" class="Function Operator">&lt;$</a> <a id="2329" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="2336" class="String">&quot;sat&quot;</a>
   <a id="2345" href="Text.Parser.String.html#4892" class="Function Operator">&lt;|&gt;</a> <a id="2349" href="SMT.Script.Base.html#4902" class="InductiveConstructor">unsat</a>   <a id="2357" href="Text.Parser.String.html#5086" class="Function Operator">&lt;$</a> <a id="2360" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="2367" class="String">&quot;unsat&quot;</a>
   <a id="2378" href="Text.Parser.String.html#4892" class="Function Operator">&lt;|&gt;</a> <a id="2382" href="SMT.Script.Base.html#4918" class="InductiveConstructor">unknown</a> <a id="2390" href="Text.Parser.String.html#5086" class="Function Operator">&lt;$</a> <a id="2393" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="2400" class="String">&quot;unknown&quot;</a>

<a id="2411" href="SMT.Script.html#2411" class="Function">_</a> <a id="2413" class="Symbol">:</a> <a id="2415" href="SMT.Script.html#2288" class="Function">pSat</a> <a id="2420" href="Text.Parser.String.html#7777" class="Function Operator">parses</a> <a id="2427" class="String">&quot;sat&quot;</a>
<a id="2433" class="Symbol">_</a> <a id="2435" class="Symbol">=</a> <a id="2437" href="Text.Parser.String.html#7385" class="InductiveConstructor Operator">!</a> <a id="2439" href="SMT.Script.Base.html#4886" class="InductiveConstructor">sat</a>

<a id="2444" href="SMT.Script.html#2444" class="Function">_</a> <a id="2446" class="Symbol">:</a> <a id="2448" href="SMT.Script.html#2288" class="Function">pSat</a> <a id="2453" href="Text.Parser.String.html#7777" class="Function Operator">parses</a> <a id="2460" class="String">&quot;unsat&quot;</a>
<a id="2468" class="Symbol">_</a> <a id="2470" class="Symbol">=</a> <a id="2472" href="Text.Parser.String.html#7385" class="InductiveConstructor Operator">!</a> <a id="2474" href="SMT.Script.Base.html#4902" class="InductiveConstructor">unsat</a>

<a id="2481" href="SMT.Script.html#2481" class="Function">_</a> <a id="2483" class="Symbol">:</a> <a id="2485" href="SMT.Script.html#2288" class="Function">pSat</a> <a id="2490" href="Text.Parser.String.html#7777" class="Function Operator">parses</a> <a id="2497" class="String">&quot;unknown&quot;</a>
<a id="2507" class="Symbol">_</a> <a id="2509" class="Symbol">=</a> <a id="2511" href="Text.Parser.String.html#7385" class="InductiveConstructor Operator">!</a> <a id="2513" href="SMT.Script.Base.html#4918" class="InductiveConstructor">unknown</a>

<a id="2522" href="SMT.Script.html#2522" class="Function">_</a> <a id="2524" class="Symbol">:</a> <a id="2526" href="SMT.Script.html#2288" class="Function">pSat</a> <a id="2531" href="Text.Parser.String.html#8209" class="Function Operator">rejects</a> <a id="2539" class="String">&quot;dogfood&quot;</a>
<a id="2549" class="Symbol">_</a> <a id="2551" class="Symbol">=</a> <a id="2553" class="Symbol">_</a>


<a id="2557" class="Comment">-- |Construct a definitions parser from a variable parser.</a>
<a id="2616" class="Comment">--</a>
<a id="2619" class="Comment">-- @</a>
<a id="2624" class="Comment">--   (define-fun x0 () Int (- 1))</a>
<a id="2658" class="Comment">-- @</a>
<a id="2663" class="Comment">--</a>
<a id="mkDefnParser"></a><a id="2666" href="SMT.Script.html#2666" class="Function">mkDefnParser</a> <a id="2679" class="Symbol">:</a> <a id="2681" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2684" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2691" class="Symbol">(</a><a id="2692" href="SMT.Script.Base.html#8242" class="Function">Var</a> <a id="2696" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="2697" class="Symbol">)</a> <a id="2699" href="Relation.Unary.html#3359" class="Function">]</a> <a id="2701" class="Symbol">→</a> <a id="2703" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2706" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2713" class="Symbol">(</a><a id="2714" href="SMT.Script.Base.html#8317" class="Function">Defn</a> <a id="2719" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="2720" class="Symbol">)</a> <a id="2722" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="2724" href="SMT.Script.html#2666" class="Function">mkDefnParser</a> <a id="2737" class="Symbol">{</a><a id="2738" href="SMT.Script.html#2738" class="Bound">Γ</a><a id="2739" class="Symbol">}</a> <a id="2741" href="SMT.Script.html#2741" class="Bound">pVar</a> <a id="2746" class="Symbol">=</a> <a id="2748" href="Text.Parser.String.html#6027" class="Function">withSpaces</a> <a id="2759" class="Symbol">(</a><a id="2760" href="Text.Parser.String.html#3686" class="Function">guardM</a> <a id="2767" href="SMT.Script.html#2996" class="Function">checkDefn</a> <a id="2777" href="SMT.Script.html#2798" class="Function">pVarVal</a><a id="2784" class="Symbol">)</a>
  <a id="2788" class="Keyword">where</a>
    <a id="2798" href="SMT.Script.html#2798" class="Function">pVarVal</a> <a id="2806" class="Symbol">:</a> <a id="2808" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2811" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2818" class="Symbol">(</a><a id="2819" href="SMT.Script.Base.html#8242" class="Function">Var</a> <a id="2823" href="SMT.Script.html#2738" class="Bound">Γ</a> <a id="2825" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2827" href="SMT.Script.Base.html#8283" class="Function">Val</a><a id="2830" class="Symbol">)</a> <a id="2832" href="Relation.Unary.html#3359" class="Function">]</a>
    <a id="2838" href="SMT.Script.html#2798" class="Function">pVarVal</a> <a id="2846" class="Symbol">=</a>
      <a id="2854" href="Text.Parser.String.html#6422" class="Function">parens</a> <a id="2861" class="Symbol">(</a><a id="2862" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="2866" class="Symbol">(</a><a id="2867" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="2874" class="String">&quot;define-fun&quot;</a> <a id="2887" href="Text.Parser.String.html#4069" class="Function Operator">&amp;&gt;</a> <a id="2890" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="2894" class="Symbol">(</a><a id="2895" href="SMT.Script.html#2741" class="Bound">pVar</a> <a id="2900" href="Text.Parser.String.html#3898" class="Function Operator">&lt;&amp;&gt;</a>
        <a id="2912" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="2916" class="Symbol">(</a><a id="2917" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="2924" class="String">&quot;()&quot;</a> <a id="2929" href="Text.Parser.String.html#4069" class="Function Operator">&amp;&gt;</a> <a id="2932" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="2936" class="Symbol">(</a><a id="2937" href="SMT.Theory.html#1559" class="Function">parseSort</a> <a id="2947" href="Text.Parser.String.html#3776" class="Function Operator">P.&gt;&gt;=</a> <a id="2953" class="Symbol">λ</a> <a id="2955" href="SMT.Script.html#2955" class="Bound">σ</a> <a id="2957" class="Symbol">→</a> <a id="2959" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="2963" class="Symbol">(</a><a id="2964" href="Data.Product.html#2211" class="Function Operator">-,_</a> <a id="2968" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="2972" href="SMT.Theory.html#1593" class="Function">parseValue</a> <a id="2983" href="SMT.Script.html#2955" class="Bound">σ</a><a id="2984" class="Symbol">))))))</a>

    <a id="2996" href="SMT.Script.html#2996" class="Function">checkDefn</a> <a id="3006" class="Symbol">:</a> <a id="3008" href="SMT.Script.Base.html#8242" class="Function">Var</a> <a id="3012" href="SMT.Script.html#2738" class="Bound">Γ</a> <a id="3014" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3016" href="SMT.Script.Base.html#8283" class="Function">Val</a> <a id="3020" class="Symbol">→</a> <a id="3022" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3028" class="Symbol">(</a><a id="3029" href="SMT.Script.Base.html#8317" class="Function">Defn</a> <a id="3034" href="SMT.Script.html#2738" class="Bound">Γ</a><a id="3035" class="Symbol">)</a>
    <a id="3041" href="SMT.Script.html#2996" class="Function">checkDefn</a> <a id="3051" class="Symbol">((</a><a id="3053" href="SMT.Script.html#3053" class="Bound">σ</a> <a id="3055" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3057" href="SMT.Script.html#3057" class="Bound">i</a><a id="3058" class="Symbol">)</a> <a id="3060" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3062" class="Symbol">(</a><a id="3063" href="SMT.Script.html#3063" class="Bound">σ′</a> <a id="3066" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3068" href="SMT.Script.html#3068" class="Bound">v</a><a id="3069" class="Symbol">))</a> <a id="3072" class="Keyword">with</a> <a id="3077" href="SMT.Script.html#3053" class="Bound">σ</a> <a id="3079" href="SMT.Theory.html#951" class="Function Operator">≟-Sort</a> <a id="3086" href="SMT.Script.html#3063" class="Bound">σ′</a>
    <a id="3093" class="Symbol">...</a> <a id="3097" class="Symbol">|</a> <a id="3099" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3103" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3108" class="Symbol">=</a> <a id="3110" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3115" class="Symbol">(</a><a id="3116" class="Bound">σ</a> <a id="3118" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3120" class="Bound">i</a> <a id="3122" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3124" class="Bound">v</a><a id="3125" class="Symbol">)</a>
    <a id="3131" class="Symbol">...</a> <a id="3135" class="Symbol">|</a> <a id="3137" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a>  <a id="3141" class="Symbol">_</a>    <a id="3146" class="Symbol">=</a> <a id="3148" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


<a id="3158" class="Comment">-- |Construct a definition-list parser from a variable parser.</a>
<a id="mkDefnsParser"></a><a id="3221" href="SMT.Script.html#3221" class="Function">mkDefnsParser</a> <a id="3235" class="Symbol">:</a> <a id="3237" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3240" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="3247" class="Symbol">(</a><a id="3248" href="SMT.Script.Base.html#8242" class="Function">Var</a> <a id="3252" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="3253" class="Symbol">)</a> <a id="3255" href="Relation.Unary.html#3359" class="Function">]</a> <a id="3257" class="Symbol">→</a> <a id="3259" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3262" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="3269" class="Symbol">(</a><a id="3270" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="3276" class="Symbol">(</a><a id="3277" href="SMT.Script.Base.html#8317" class="Function">Defn</a> <a id="3282" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="3283" class="Symbol">))</a> <a id="3286" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="3288" href="SMT.Script.html#3221" class="Function">mkDefnsParser</a> <a id="3302" class="Symbol">{</a><a id="3303" href="SMT.Script.html#3303" class="Bound">Γ</a><a id="3304" class="Symbol">}</a> <a id="3306" href="SMT.Script.html#3306" class="Bound">pVar</a> <a id="3311" class="Symbol">=</a>
  <a id="3315" href="Text.Parser.String.html#6027" class="Function">withSpaces</a> <a id="3326" class="Symbol">(</a><a id="3327" href="Text.Parser.String.html#6422" class="Function">parens</a> <a id="3334" class="Symbol">(</a><a id="3335" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="3339" class="Symbol">(</a><a id="3340" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="3347" class="String">&quot;model&quot;</a> <a id="3355" href="Text.Parser.String.html#4069" class="Function Operator">&amp;&gt;</a> <a id="3358" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="3362" class="Symbol">(</a><a id="3363" href="Text.Parser.String.html#5425" class="Function">list⁺</a> <a id="3369" class="Symbol">(</a><a id="3370" href="SMT.Script.html#2666" class="Function">mkDefnParser</a> <a id="3383" class="Symbol">{</a><a id="3384" href="SMT.Script.html#3303" class="Bound">Γ</a><a id="3385" class="Symbol">}</a> <a id="3387" href="SMT.Script.html#3306" class="Bound">pVar</a><a id="3391" class="Symbol">)))))</a>


<a id="3399" class="Keyword">private</a>
  <a id="MaybeModel"></a><a id="3409" href="SMT.Script.html#3409" class="Function">MaybeModel</a> <a id="3420" class="Symbol">:</a> <a id="3422" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a> <a id="3427" class="Symbol">→</a> <a id="3429" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="3435" href="SMT.Script.html#3409" class="Function">MaybeModel</a> <a id="3446" href="SMT.Script.html#3446" class="Bound">Γ</a> <a id="3448" class="Symbol">=</a> <a id="3450" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="3454" class="Symbol">(λ</a> <a id="3457" href="SMT.Script.html#3457" class="Bound">σ</a> <a id="3459" href="SMT.Script.html#3459" class="Bound Operator">_Γ</a> <a id="3462" class="Symbol">→</a> <a id="3464" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3469" class="Symbol">(</a><a id="3470" href="SMT.Theory.html#1023" class="Function">Value</a> <a id="3476" href="SMT.Script.html#3457" class="Bound">σ</a><a id="3477" class="Symbol">))</a> <a id="3480" href="SMT.Script.html#3446" class="Bound">Γ</a>

  <a id="insertMM"></a><a id="3485" href="SMT.Script.html#3485" class="Function">insertMM</a> <a id="3494" class="Symbol">:</a> <a id="3496" href="Data.Product.html#1788" class="Function">∃[</a> <a id="3499" href="SMT.Script.html#3499" class="Bound">σ</a> <a id="3501" href="Data.Product.html#1788" class="Function">]</a> <a id="3503" class="Symbol">(</a><a id="3504" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="3506" href="SMT.Script.Base.html#1249" class="Function Operator">∋</a> <a id="3508" href="SMT.Script.html#3499" class="Bound">σ</a> <a id="3510" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3512" href="SMT.Theory.html#1023" class="Function">Value</a> <a id="3518" href="SMT.Script.html#3499" class="Bound">σ</a><a id="3519" class="Symbol">)</a> <a id="3521" class="Symbol">→</a> <a id="3523" href="SMT.Script.html#3409" class="Function">MaybeModel</a> <a id="3534" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="3536" class="Symbol">→</a> <a id="3538" href="SMT.Script.html#3409" class="Function">MaybeModel</a> <a id="3549" href="SMT.Script.html#1432" class="Generalizable">Γ</a>
  <a id="3553" href="SMT.Script.html#3485" class="Function">insertMM</a> <a id="3562" class="Symbol">{</a><a id="3563" class="DottedPattern Symbol">.</a><a id="3564" class="DottedPattern">σ</a> <a id="3566" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3568" href="SMT.Script.html#3568" class="Bound">Γ</a><a id="3569" class="Symbol">}</a> <a id="3571" class="Symbol">(</a><a id="3572" href="SMT.Script.html#3572" class="Bound">σ</a> <a id="3574" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3576" class="Symbol">(</a><a id="3577" href="Data.Fin.Base.html#1160" class="InductiveConstructor">Fin.zero</a>  <a id="3587" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3589" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="3593" class="Symbol">)</a> <a id="3595" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3597" href="SMT.Script.html#3597" class="Bound">v</a><a id="3598" class="Symbol">)</a> <a id="3600" class="Symbol">(</a><a id="3601" href="SMT.Script.html#3601" class="Bound">vs</a> <a id="3604" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3606" href="SMT.Script.html#3606" class="Bound">env</a><a id="3609" class="Symbol">)</a> <a id="3611" class="Symbol">=</a> <a id="3613" class="Symbol">(</a><a id="3614" href="SMT.Script.html#3597" class="Bound">v</a> <a id="3616" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3618" href="SMT.Script.html#3601" class="Bound">vs</a><a id="3620" class="Symbol">)</a> <a id="3622" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3624" href="SMT.Script.html#3606" class="Bound">env</a>
  <a id="3630" href="SMT.Script.html#3485" class="Function">insertMM</a> <a id="3639" class="Symbol">{</a><a id="3640" href="SMT.Script.html#3640" class="Bound">σ′</a> <a id="3643" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3645" href="SMT.Script.html#3645" class="Bound">Γ</a><a id="3646" class="Symbol">}</a> <a id="3648" class="Symbol">(</a><a id="3649" href="SMT.Script.html#3649" class="Bound">σ</a> <a id="3651" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3653" class="Symbol">(</a><a id="3654" href="Data.Fin.Base.html#1191" class="InductiveConstructor">Fin.suc</a> <a id="3662" href="SMT.Script.html#3662" class="Bound">i</a> <a id="3664" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3666" href="SMT.Script.html#3666" class="Bound">p</a><a id="3667" class="Symbol">)</a>    <a id="3672" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3674" href="SMT.Script.html#3674" class="Bound">v</a><a id="3675" class="Symbol">)</a> <a id="3677" class="Symbol">(</a><a id="3678" href="SMT.Script.html#3678" class="Bound">vs</a> <a id="3681" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3683" href="SMT.Script.html#3683" class="Bound">env</a><a id="3686" class="Symbol">)</a> <a id="3688" class="Symbol">=</a> <a id="3690" href="SMT.Script.html#3678" class="Bound">vs</a> <a id="3693" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3695" href="SMT.Script.html#3485" class="Function">insertMM</a> <a id="3704" class="Symbol">(</a><a id="3705" href="SMT.Script.html#3649" class="Bound">σ</a> <a id="3707" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3709" class="Symbol">(</a><a id="3710" href="SMT.Script.html#3662" class="Bound">i</a> <a id="3712" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3714" href="SMT.Script.html#3666" class="Bound">p</a><a id="3715" class="Symbol">)</a> <a id="3717" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3719" href="SMT.Script.html#3674" class="Bound">v</a><a id="3720" class="Symbol">)</a> <a id="3722" href="SMT.Script.html#3683" class="Bound">env</a>

  <a id="mkMM"></a><a id="3729" href="SMT.Script.html#3729" class="Function">mkMM</a> <a id="3734" class="Symbol">:</a> <a id="3736" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3741" class="Symbol">(</a><a id="3742" href="SMT.Script.Base.html#8317" class="Function">Defn</a> <a id="3747" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="3748" class="Symbol">)</a> <a id="3750" class="Symbol">→</a> <a id="3752" href="SMT.Script.html#3409" class="Function">MaybeModel</a> <a id="3763" href="SMT.Script.html#1432" class="Generalizable">Γ</a>
  <a id="3767" href="SMT.Script.html#3729" class="Function">mkMM</a> <a id="3772" class="Symbol">{</a><a id="3773" href="SMT.Script.html#3773" class="Bound">Γ</a><a id="3774" class="Symbol">}</a> <a id="3776" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="3785" class="Symbol">=</a> <a id="3787" href="Data.Environment.html#1028" class="Function">Env.repeat</a> <a id="3798" class="Symbol">(λ</a> <a id="3801" href="SMT.Script.html#3801" class="Bound Operator">_σ</a> <a id="3804" href="SMT.Script.html#3804" class="Bound Operator">_Γ</a> <a id="3807" class="Symbol">→</a> <a id="3809" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3811" class="Symbol">)</a> <a id="3813" href="SMT.Script.html#3773" class="Bound">Γ</a>
  <a id="3817" href="SMT.Script.html#3729" class="Function">mkMM</a> <a id="3822" class="Symbol">{</a><a id="3823" href="SMT.Script.html#3823" class="Bound">Γ</a><a id="3824" class="Symbol">}</a> <a id="3826" class="Symbol">(</a><a id="3827" href="SMT.Script.html#3827" class="Bound">v</a> <a id="3829" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3831" href="SMT.Script.html#3831" class="Bound">vs</a><a id="3833" class="Symbol">)</a> <a id="3835" class="Symbol">=</a> <a id="3837" href="SMT.Script.html#3485" class="Function">insertMM</a> <a id="3846" href="SMT.Script.html#3827" class="Bound">v</a> <a id="3848" class="Symbol">(</a><a id="3849" href="SMT.Script.html#3729" class="Function">mkMM</a> <a id="3854" href="SMT.Script.html#3831" class="Bound">vs</a><a id="3856" class="Symbol">)</a>

  <a id="fromSingleton"></a><a id="3861" href="SMT.Script.html#3861" class="Function">fromSingleton</a> <a id="3875" class="Symbol">:</a> <a id="3877" class="Symbol">{</a><a id="3878" href="SMT.Script.html#3878" class="Bound">A</a> <a id="3880" class="Symbol">:</a> <a id="3882" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="3885" class="Symbol">}</a> <a id="3887" class="Symbol">→</a> <a id="3889" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3894" href="SMT.Script.html#3878" class="Bound">A</a> <a id="3896" class="Symbol">→</a> <a id="3898" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3904" href="SMT.Script.html#3878" class="Bound">A</a>
  <a id="3908" href="SMT.Script.html#3861" class="Function">fromSingleton</a> <a id="3922" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="3925" class="Symbol">=</a> <a id="3927" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
  <a id="3937" href="SMT.Script.html#3861" class="Function">fromSingleton</a> <a id="3951" class="Symbol">(</a><a id="3952" href="SMT.Script.html#3952" class="Bound">v</a> <a id="3954" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3956" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3958" class="Symbol">)</a> <a id="3960" class="Symbol">=</a> <a id="3962" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3967" href="SMT.Script.html#3952" class="Bound">v</a>
  <a id="3971" href="SMT.Script.html#3861" class="Function">fromSingleton</a> <a id="3985" class="Symbol">(_</a> <a id="3988" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3990" class="Symbol">_</a> <a id="3992" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3994" class="Symbol">_)</a> <a id="3997" class="Symbol">=</a> <a id="3999" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

  <a id="checkMM"></a><a id="4010" href="SMT.Script.html#4010" class="Function">checkMM</a> <a id="4018" class="Symbol">:</a> <a id="4020" href="SMT.Script.html#3409" class="Function">MaybeModel</a> <a id="4031" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="4033" class="Symbol">→</a> <a id="4035" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4041" class="Symbol">(</a><a id="4042" href="SMT.Script.Base.html#5567" class="Datatype">Model</a> <a id="4048" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="4049" class="Symbol">)</a>
  <a id="4053" href="SMT.Script.html#4010" class="Function">checkMM</a> <a id="4061" href="Data.Environment.html#410" class="InductiveConstructor">[]</a> <a id="4064" class="Symbol">=</a> <a id="4066" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4071" href="SMT.Script.Base.html#5600" class="InductiveConstructor">[]</a>
  <a id="4076" href="SMT.Script.html#4010" class="Function">checkMM</a> <a id="4084" class="Symbol">(</a><a id="4085" href="SMT.Script.html#4085" class="Bound">vs</a> <a id="4088" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4090" href="SMT.Script.html#4090" class="Bound">env</a><a id="4093" class="Symbol">)</a> <a id="4095" class="Symbol">=</a> <a id="4097" href="Data.Maybe.Base.html#2766" class="Function">Maybe.zipWith</a> <a id="4111" href="SMT.Script.Base.html#5617" class="InductiveConstructor Operator">_∷_</a> <a id="4115" class="Symbol">(</a><a id="4116" href="SMT.Script.html#3861" class="Function">fromSingleton</a> <a id="4130" href="SMT.Script.html#4085" class="Bound">vs</a><a id="4132" class="Symbol">)</a> <a id="4134" class="Symbol">(</a><a id="4135" href="SMT.Script.html#4010" class="Function">checkMM</a> <a id="4143" href="SMT.Script.html#4090" class="Bound">env</a><a id="4146" class="Symbol">)</a>


<a id="4150" class="Comment">-- |Construct a model parser from a variable parser.</a>
<a id="mkModelParser"></a><a id="4203" href="SMT.Script.html#4203" class="Function">mkModelParser</a> <a id="4217" class="Symbol">:</a> <a id="4219" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4222" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4229" class="Symbol">(</a><a id="4230" href="SMT.Script.Base.html#8242" class="Function">Var</a> <a id="4234" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="4235" class="Symbol">)</a> <a id="4237" href="Relation.Unary.html#3359" class="Function">]</a> <a id="4239" class="Symbol">→</a> <a id="4241" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4244" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4251" class="Symbol">(</a><a id="4252" href="SMT.Script.Base.html#5567" class="Datatype">Model</a> <a id="4258" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="4259" class="Symbol">)</a> <a id="4261" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="4263" href="SMT.Script.html#4203" class="Function">mkModelParser</a> <a id="4277" class="Symbol">{</a><a id="4278" href="SMT.Script.html#4278" class="Bound">Γ</a><a id="4279" class="Symbol">}</a> <a id="4281" href="SMT.Script.html#4281" class="Bound">pVar</a> <a id="4286" class="Symbol">=</a> <a id="4288" href="SMT.Script.html#2288" class="Function">pSat</a> <a id="4293" href="Text.Parser.String.html#3776" class="Function Operator">P.&gt;&gt;=</a> <a id="4299" class="Symbol">λ</a> <a id="4301" class="Symbol">{</a> <a id="4303" href="SMT.Script.Base.html#4886" class="InductiveConstructor">sat</a> <a id="4307" class="Symbol">→</a> <a id="4309" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="4313" href="SMT.Script.html#4422" class="Function">pModel</a> <a id="4320" class="Symbol">;</a> <a id="4322" class="CatchallClause Symbol">_</a> <a id="4324" class="Symbol">→</a> <a id="4326" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="4330" href="Text.Parser.String.html#4819" class="Function">fail</a> <a id="4335" class="Symbol">}</a>
  <a id="4339" class="Keyword">where</a>
    <a id="4349" class="Comment">-- Insert each definition into a model, and check if it is complete.</a>
    <a id="4422" href="SMT.Script.html#4422" class="Function">pModel</a> <a id="4429" class="Symbol">:</a> <a id="4431" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4434" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4441" class="Symbol">(</a><a id="4442" href="SMT.Script.Base.html#5567" class="Datatype">Model</a> <a id="4448" href="SMT.Script.html#4278" class="Bound">Γ</a><a id="4449" class="Symbol">)</a> <a id="4451" href="Relation.Unary.html#3359" class="Function">]</a>
    <a id="4457" href="SMT.Script.html#4422" class="Function">pModel</a> <a id="4464" class="Symbol">=</a> <a id="4466" href="Text.Parser.String.html#3686" class="Function">guardM</a> <a id="4473" href="SMT.Script.html#4010" class="Function">checkMM</a> <a id="4481" class="Symbol">(</a><a id="4482" href="SMT.Script.html#3729" class="Function">mkMM</a> <a id="4487" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4489" href="Data.List.NonEmpty.html#1760" class="Function">List⁺.toList</a> <a id="4502" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="4506" href="SMT.Script.html#3221" class="Function">mkDefnsParser</a> <a id="4520" class="Symbol">{</a><a id="4521" href="SMT.Script.html#4278" class="Bound">Γ</a><a id="4522" class="Symbol">}</a> <a id="4524" href="SMT.Script.html#4281" class="Bound">pVar</a><a id="4528" class="Symbol">)</a>

<a id="mkOutputParsers⁺"></a><a id="4531" href="SMT.Script.html#4531" class="Function">mkOutputParsers⁺</a> <a id="4548" class="Symbol">:</a> <a id="4550" href="SMT.Script.html#2169" class="Function">OutputParsers</a> <a id="4564" class="Symbol">(</a><a id="4565" href="SMT.Script.html#1523" class="Generalizable">ξ</a> <a id="4567" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4569" href="SMT.Script.html#1548" class="Generalizable">Ξ</a><a id="4570" class="Symbol">)</a> <a id="4572" class="Symbol">→</a> <a id="4574" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4577" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4584" class="Symbol">(</a><a id="4585" href="SMT.Script.Base.html#6075" class="Datatype">Outputs</a> <a id="4593" class="Symbol">(</a><a id="4594" href="SMT.Script.html#1523" class="Generalizable">ξ</a> <a id="4596" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4598" href="SMT.Script.html#1548" class="Generalizable">Ξ</a><a id="4599" class="Symbol">))</a> <a id="4602" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="4604" href="SMT.Script.html#4531" class="Function">mkOutputParsers⁺</a> <a id="4621" class="Symbol">(</a><a id="4622" href="SMT.Script.html#4622" class="Bound">op</a> <a id="4625" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4627" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="4629" class="Symbol">)</a>          <a id="4640" class="Symbol">=</a> <a id="4642" class="Symbol">(</a><a id="4643" href="SMT.Script.Base.html#6135" class="InductiveConstructor Operator">_∷</a> <a id="4646" href="SMT.Script.Base.html#6116" class="InductiveConstructor">[]</a><a id="4648" class="Symbol">)</a> <a id="4650" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="4654" href="SMT.Script.html#4622" class="Bound">op</a>
<a id="4657" href="SMT.Script.html#4531" class="Function">mkOutputParsers⁺</a> <a id="4674" class="Symbol">(</a><a id="4675" href="SMT.Script.html#4675" class="Bound">op</a> <a id="4678" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4680" href="SMT.Script.html#4680" class="Bound">ops</a><a id="4683" class="Symbol">@(_</a> <a id="4687" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4689" class="Symbol">_))</a> <a id="4693" class="Symbol">=</a> <a id="4695" href="Function.Base.html#1554" class="Function">flip</a> <a id="4700" href="SMT.Script.Base.html#6135" class="InductiveConstructor Operator">_∷_</a> <a id="4704" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="4708" href="SMT.Script.html#4531" class="Function">mkOutputParsers⁺</a> <a id="4725" href="SMT.Script.html#4680" class="Bound">ops</a> <a id="4729" href="Text.Parser.String.html#5174" class="Function Operator">&lt;*&gt;</a> <a id="4733" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="4737" href="SMT.Script.html#4675" class="Bound">op</a>


<a id="4742" class="Comment">-- * Name state monad</a>

<a id="NameState"></a><a id="4765" href="SMT.Script.html#4765" class="Function">NameState</a> <a id="4775" class="Symbol">:</a> <a id="4777" class="Symbol">(</a><a id="4778" href="SMT.Script.html#4778" class="Bound">Γ</a> <a id="4780" href="SMT.Script.html#4780" class="Bound">Γ′</a> <a id="4783" class="Symbol">:</a> <a id="4785" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a><a id="4789" class="Symbol">)</a> <a id="4791" class="Symbol">→</a> <a id="4793" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4797" class="Symbol">→</a> <a id="4799" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="4803" href="SMT.Script.html#4765" class="Function">NameState</a> <a id="4813" href="SMT.Script.html#4813" class="Bound">Γ</a> <a id="4815" href="SMT.Script.html#4815" class="Bound">Γ′</a> <a id="4818" href="SMT.Script.html#4818" class="Bound">A</a> <a id="4820" class="Symbol">=</a> <a id="4822" href="Category.Monad.State.html#666" class="Function">IStateT</a> <a id="4830" class="Symbol">(λ</a> <a id="4833" href="SMT.Script.html#4833" class="Bound">Γ</a> <a id="4835" class="Symbol">→</a> <a id="4837" href="SMT.Script.Names.html#2015" class="Record">Names</a> <a id="4843" href="SMT.Script.html#4833" class="Bound">Γ</a> <a id="4845" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4847" href="SMT.Script.html#1631" class="Function">VarParsers</a> <a id="4858" href="SMT.Script.html#4833" class="Bound">Γ</a><a id="4859" class="Symbol">)</a> <a id="4861" href="Function.Base.html#615" class="Function">id</a> <a id="4864" href="SMT.Script.html#4813" class="Bound">Γ</a> <a id="4866" href="SMT.Script.html#4815" class="Bound">Γ′</a> <a id="4869" href="SMT.Script.html#4818" class="Bound">A</a>

<a id="4872" class="Comment">-- When showing terms, we need to pass around a name state,</a>
<a id="4932" class="Comment">-- for which we&#39;ll use an indexed monad, indexed by the context,</a>
<a id="4997" class="Comment">-- so we bring the functions from the indexed monad in scope.</a>
<a id="5059" class="Keyword">private</a>
  <a id="monadStateNameState"></a><a id="5069" href="SMT.Script.html#5069" class="Function">monadStateNameState</a> <a id="5089" class="Symbol">=</a>
    <a id="5095" href="Category.Monad.State.html#2986" class="Function">StateCat.StateTIMonadState</a> <a id="5122" class="Symbol">(λ</a> <a id="5125" href="SMT.Script.html#5125" class="Bound">Γ</a> <a id="5127" class="Symbol">→</a> <a id="5129" href="SMT.Script.Names.html#2015" class="Record">Names</a> <a id="5135" href="SMT.Script.html#5125" class="Bound">Γ</a> <a id="5137" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5139" href="SMT.Script.html#1631" class="Function">VarParsers</a> <a id="5150" href="SMT.Script.html#5125" class="Bound">Γ</a><a id="5151" class="Symbol">)</a> <a id="5153" href="Function.Identity.Categorical.html#651" class="Function">Identity.monad</a>

<a id="5169" class="Keyword">open</a> <a id="5174" href="Category.Monad.State.html#2659" class="Module">RawIMonadState</a> <a id="5189" href="SMT.Script.html#5069" class="Function">monadStateNameState</a>
  <a id="5211" class="Keyword">using</a> <a id="5217" class="Symbol">(</a><a id="5218" href="Category.Monad.Indexed.html#644" class="Function">return</a><a id="5224" class="Symbol">;</a> <a id="5226" href="Category.Monad.Indexed.html#677" class="Function Operator">_&gt;&gt;=_</a><a id="5231" class="Symbol">;</a> <a id="5233" href="Category.Monad.Indexed.html#735" class="Function Operator">_&gt;&gt;_</a><a id="5237" class="Symbol">;</a> <a id="5239" href="Category.Monad.State.html#2831" class="Field">put</a><a id="5242" class="Symbol">;</a> <a id="5244" href="Category.Monad.State.html#2799" class="Field">get</a><a id="5247" class="Symbol">;</a> <a id="5249" href="Category.Monad.State.html#2906" class="Function">modify</a><a id="5255" class="Symbol">)</a>

<a id="freshNameS"></a><a id="5258" href="SMT.Script.html#5258" class="Function">freshNameS</a> <a id="5269" class="Symbol">:</a> <a id="5271" class="Symbol">(</a><a id="5272" href="SMT.Script.html#5272" class="Bound">σ</a> <a id="5274" class="Symbol">:</a> <a id="5276" href="SMT.Theory.html#928" class="Function">Sort</a><a id="5280" class="Symbol">)</a> <a id="5282" class="Symbol">→</a> <a id="5284" href="SMT.Script.html#4765" class="Function">NameState</a> <a id="5294" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5296" class="Symbol">(</a><a id="5297" href="SMT.Script.html#5272" class="Bound">σ</a> <a id="5299" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5301" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="5302" class="Symbol">)</a> <a id="5304" href="SMT.Script.Names.html#1427" class="Function">Name</a>
<a id="5309" href="SMT.Script.html#5258" class="Function">freshNameS</a> <a id="5320" href="SMT.Script.html#5320" class="Bound">σ</a> <a id="5322" class="Symbol">=</a> <a id="5324" class="Keyword">do</a>
  <a id="5329" class="Symbol">(</a><a id="5330" href="SMT.Script.html#5330" class="Bound">ns</a> <a id="5333" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5335" href="SMT.Script.html#5335" class="Bound">vps</a><a id="5338" class="Symbol">)</a> <a id="5340" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="5342" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="5348" class="Keyword">let</a> <a id="5352" class="Symbol">(</a><a id="5353" href="SMT.Script.html#5353" class="Bound">n</a> <a id="5355" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5357" href="SMT.Script.html#5357" class="Bound">ns</a><a id="5359" class="Symbol">)</a> <a id="5361" class="Symbol">=</a> <a id="5363" href="SMT.Script.Names.html#2225" class="Function">freshName</a> <a id="5373" href="SMT.Script.html#5320" class="Bound">σ</a> <a id="5375" href="SMT.Script.html#5330" class="Bound">ns</a>
  <a id="5380" class="Keyword">let</a> <a id="5384" href="SMT.Script.html#5384" class="Bound">vps</a> <a id="5388" class="Symbol">=</a> <a id="5390" class="Symbol">((</a><a id="5392" href="Data.Fin.Base.html#1160" class="InductiveConstructor">Fin.zero</a> <a id="5401" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5403" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="5407" class="Symbol">)</a> <a id="5409" href="Text.Parser.String.html#5086" class="Function Operator">&lt;$</a> <a id="5412" href="Text.Parser.String.html#6027" class="Function">withSpaces</a> <a id="5423" class="Symbol">(</a><a id="5424" href="Text.Parser.String.html#6327" class="Function">exacts</a> <a id="5431" href="SMT.Script.html#5353" class="Bound">n</a><a id="5432" class="Symbol">))</a> <a id="5435" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5437" href="SMT.Script.html#5335" class="Bound">vps</a>
  <a id="5443" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="5447" class="Symbol">(</a><a id="5448" href="SMT.Script.html#5357" class="Bound">ns</a> <a id="5451" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5453" href="SMT.Script.html#5384" class="Bound">vps</a><a id="5456" class="Symbol">)</a>
  <a id="5460" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="5467" href="SMT.Script.html#5353" class="Bound">n</a>

<a id="dropNameS"></a><a id="5470" href="SMT.Script.html#5470" class="Function">dropNameS</a> <a id="5480" class="Symbol">:</a> <a id="5482" href="SMT.Script.html#4765" class="Function">NameState</a> <a id="5492" class="Symbol">(</a><a id="5493" href="SMT.Script.html#1413" class="Generalizable">σ</a> <a id="5495" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5497" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="5498" class="Symbol">)</a> <a id="5500" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5502" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="5504" href="SMT.Script.html#5470" class="Function">dropNameS</a> <a id="5514" class="Symbol">=</a> <a id="5516" class="Keyword">do</a>
  <a id="5521" class="Symbol">(</a><a id="5522" href="SMT.Script.html#5522" class="Bound">ns</a> <a id="5525" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5527" class="Symbol">_</a> <a id="5529" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5531" href="SMT.Script.html#5531" class="Bound">vps</a><a id="5534" class="Symbol">)</a> <a id="5536" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="5538" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="5544" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="5548" class="Symbol">(</a><a id="5549" href="SMT.Script.Names.html#2513" class="Function">dropName</a> <a id="5558" href="SMT.Script.html#5522" class="Bound">ns</a> <a id="5561" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5563" href="SMT.Script.html#5531" class="Bound">vps</a><a id="5566" class="Symbol">)</a>
  <a id="5570" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="5577" class="Symbol">_</a>

<a id="lookupNameS"></a><a id="5580" href="SMT.Script.html#5580" class="Function">lookupNameS</a> <a id="5592" class="Symbol">:</a> <a id="5594" class="Symbol">(</a><a id="5595" href="SMT.Script.html#5595" class="Bound">i</a> <a id="5597" class="Symbol">:</a> <a id="5599" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5601" href="SMT.Script.Base.html#1249" class="Function Operator">∋</a> <a id="5603" href="SMT.Script.html#1413" class="Generalizable">σ</a><a id="5604" class="Symbol">)</a> <a id="5606" class="Symbol">→</a> <a id="5608" href="SMT.Script.html#4765" class="Function">NameState</a> <a id="5618" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5620" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5622" href="SMT.Script.Names.html#1427" class="Function">Name</a>
<a id="5627" href="SMT.Script.html#5580" class="Function">lookupNameS</a> <a id="5639" class="Symbol">(</a><a id="5640" href="SMT.Script.html#5640" class="Bound">i</a> <a id="5642" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5644" href="SMT.Script.html#5644" class="Bound Operator">_p</a><a id="5646" class="Symbol">)</a> <a id="5648" class="Symbol">=</a> <a id="5650" class="Keyword">do</a>
  <a id="5655" class="Symbol">(</a><a id="5656" href="SMT.Script.html#5656" class="Bound">ns</a> <a id="5659" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5661" href="SMT.Script.html#5661" class="Bound Operator">_vps</a><a id="5665" class="Symbol">)</a> <a id="5667" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="5669" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="5675" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="5682" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5684" href="Data.Environment.html#849" class="Function">Env.lookup</a> <a id="5695" class="Symbol">(</a><a id="5696" href="SMT.Script.Names.html#2056" class="Field">Names.nameEnv</a> <a id="5710" href="SMT.Script.html#5656" class="Bound">ns</a><a id="5712" class="Symbol">)</a> <a id="5714" href="SMT.Script.html#5640" class="Bound">i</a>


<a id="5718" class="Comment">-- * Printing functions</a>

<a id="5743" class="Keyword">mutual</a>

  <a id="5753" class="Comment">-- |Show a term as an S-expression.</a>
  <a id="showTermS"></a><a id="5791" href="SMT.Script.html#5791" class="Function">showTermS</a> <a id="5801" class="Symbol">:</a> <a id="5803" href="SMT.Script.Base.html#1472" class="Datatype">Term</a> <a id="5808" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5810" href="SMT.Script.html#1413" class="Generalizable">σ</a> <a id="5812" class="Symbol">→</a> <a id="5814" href="SMT.Script.html#4765" class="Function">NameState</a> <a id="5824" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5826" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5828" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
  <a id="5837" href="SMT.Script.html#5791" class="Function">showTermS</a> <a id="5847" class="Symbol">(</a><a id="5848" href="SMT.Script.Base.html#1517" class="InductiveConstructor">var</a> <a id="5852" href="SMT.Script.html#5852" class="Bound">i</a><a id="5853" class="Symbol">)</a> <a id="5855" class="Symbol">=</a> <a id="5857" class="Keyword">do</a>
    <a id="5864" href="SMT.Script.html#5864" class="Bound">n</a> <a id="5866" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="5868" href="SMT.Script.html#5580" class="Function">lookupNameS</a> <a id="5880" href="SMT.Script.html#5852" class="Bound">i</a>
    <a id="5886" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="5893" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5895" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="5904" href="SMT.Script.html#5864" class="Bound">n</a>
  <a id="5908" href="SMT.Script.html#5791" class="Function">showTermS</a> <a id="5918" class="Symbol">(</a><a id="5919" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="5923" href="SMT.Script.html#5923" class="Bound">l</a><a id="5924" class="Symbol">)</a> <a id="5926" class="Symbol">=</a> <a id="5928" class="Keyword">do</a>
    <a id="5935" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="5942" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5944" href="SMT.Theory.html#1339" class="Function">showLiteral</a> <a id="5956" href="SMT.Script.html#5923" class="Bound">l</a>
  <a id="5960" href="SMT.Script.html#5791" class="Function">showTermS</a> <a id="5970" class="Symbol">(</a><a id="5971" href="SMT.Script.Base.html#1605" class="InductiveConstructor">app</a> <a id="5975" href="SMT.Script.html#5975" class="Bound">x</a> <a id="5977" href="SMT.Script.html#5977" class="Bound">xs</a><a id="5979" class="Symbol">)</a> <a id="5981" class="Symbol">=</a> <a id="5983" class="Keyword">do</a>
    <a id="5990" class="Keyword">let</a> <a id="5994" href="SMT.Script.html#5994" class="Bound">x</a> <a id="5996" class="Symbol">=</a> <a id="5998" href="SMT.Theory.html#1392" class="Function">showIdentifier</a> <a id="6013" href="SMT.Script.html#5975" class="Bound">x</a>
    <a id="6019" href="SMT.Script.html#6019" class="Bound">xs</a> <a id="6022" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6024" href="SMT.Script.html#6434" class="Function">showArgsS</a> <a id="6034" href="SMT.Script.html#5977" class="Bound">xs</a>
    <a id="6041" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6048" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6050" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="6058" class="Symbol">(</a><a id="6059" href="SMT.Script.html#5994" class="Bound">x</a> <a id="6061" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6063" href="SMT.Script.html#6019" class="Bound">xs</a><a id="6065" class="Symbol">)</a>
  <a id="6069" href="SMT.Script.html#5791" class="Function">showTermS</a> <a id="6079" class="Symbol">(</a><a id="6080" href="SMT.Script.Base.html#1699" class="InductiveConstructor">forAll</a> <a id="6087" href="SMT.Script.html#6087" class="Bound">σ</a> <a id="6089" href="SMT.Script.html#6089" class="Bound">x</a><a id="6090" class="Symbol">)</a> <a id="6092" class="Symbol">=</a> <a id="6094" class="Keyword">do</a>
    <a id="6101" href="SMT.Script.html#6101" class="Bound">n</a> <a id="6103" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6105" href="SMT.Script.html#5258" class="Function">freshNameS</a> <a id="6116" href="SMT.Script.html#6087" class="Bound">σ</a>
    <a id="6122" href="SMT.Script.html#6122" class="Bound">x</a> <a id="6124" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6126" href="SMT.Script.html#5791" class="Function">showTermS</a> <a id="6136" href="SMT.Script.html#6089" class="Bound">x</a>
    <a id="6142" href="SMT.Script.html#5470" class="Function">dropNameS</a>
    <a id="6156" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6163" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6165" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="6173" class="Symbol">(</a><a id="6174" class="String">&quot;forall&quot;</a> <a id="6183" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6185" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="6193" class="Symbol">(</a><a id="6194" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="6202" class="Symbol">(</a><a id="6203" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="6212" href="SMT.Script.html#6101" class="Bound">n</a> <a id="6214" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6216" href="SMT.Theory.html#1304" class="Function">showSort</a> <a id="6225" href="SMT.Script.html#6087" class="Bound">σ</a> <a id="6227" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6229" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6231" class="Symbol">)</a> <a id="6233" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6235" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6237" class="Symbol">)</a> <a id="6239" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6241" href="SMT.Script.html#6122" class="Bound">x</a> <a id="6243" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6245" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6247" class="Symbol">)</a>
  <a id="6251" href="SMT.Script.html#5791" class="Function">showTermS</a> <a id="6261" class="Symbol">(</a><a id="6262" href="SMT.Script.Base.html#1763" class="InductiveConstructor">exists</a> <a id="6269" href="SMT.Script.html#6269" class="Bound">σ</a> <a id="6271" href="SMT.Script.html#6271" class="Bound">x</a><a id="6272" class="Symbol">)</a> <a id="6274" class="Symbol">=</a> <a id="6276" class="Keyword">do</a>
    <a id="6283" href="SMT.Script.html#6283" class="Bound">n</a> <a id="6285" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6287" href="SMT.Script.html#5258" class="Function">freshNameS</a> <a id="6298" href="SMT.Script.html#6269" class="Bound">σ</a>
    <a id="6304" href="SMT.Script.html#6304" class="Bound">x</a> <a id="6306" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6308" href="SMT.Script.html#5791" class="Function">showTermS</a> <a id="6318" href="SMT.Script.html#6271" class="Bound">x</a>
    <a id="6324" href="SMT.Script.html#5470" class="Function">dropNameS</a>
    <a id="6338" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6345" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6347" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="6355" class="Symbol">(</a><a id="6356" class="String">&quot;exists&quot;</a> <a id="6365" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6367" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="6375" class="Symbol">(</a><a id="6376" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="6384" class="Symbol">(</a><a id="6385" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="6394" href="SMT.Script.html#6283" class="Bound">n</a> <a id="6396" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6398" href="SMT.Theory.html#1304" class="Function">showSort</a> <a id="6407" href="SMT.Script.html#6269" class="Bound">σ</a> <a id="6409" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6411" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6413" class="Symbol">)</a> <a id="6415" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6417" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6419" class="Symbol">)</a> <a id="6421" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6423" href="SMT.Script.html#6304" class="Bound">x</a> <a id="6425" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6427" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6429" class="Symbol">)</a>

  <a id="showArgsS"></a><a id="6434" href="SMT.Script.html#6434" class="Function">showArgsS</a> <a id="6444" class="Symbol">:</a> <a id="6446" href="SMT.Script.Base.html#1826" class="Function">Args</a> <a id="6451" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6453" href="SMT.Script.html#1451" class="Generalizable">Δ</a> <a id="6455" class="Symbol">→</a> <a id="6457" href="SMT.Script.html#4765" class="Function">NameState</a> <a id="6467" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6469" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6471" class="Symbol">(</a><a id="6472" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6477" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="6483" class="Symbol">)</a>
  <a id="6487" href="SMT.Script.html#6434" class="Function">showArgsS</a> <a id="6497" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>       <a id="6506" class="Symbol">=</a> <a id="6508" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6515" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="6520" href="SMT.Script.html#6434" class="Function">showArgsS</a> <a id="6530" class="Symbol">(</a><a id="6531" href="SMT.Script.html#6531" class="Bound">x</a> <a id="6533" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6535" href="SMT.Script.html#6535" class="Bound">xs</a><a id="6537" class="Symbol">)</a> <a id="6539" class="Symbol">=</a> <a id="6541" class="Keyword">do</a> <a id="6544" href="SMT.Script.html#6544" class="Bound">x</a> <a id="6546" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6548" href="SMT.Script.html#5791" class="Function">showTermS</a> <a id="6558" href="SMT.Script.html#6531" class="Bound">x</a><a id="6559" class="Symbol">;</a> <a id="6561" href="SMT.Script.html#6561" class="Bound">xs</a> <a id="6564" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6566" href="SMT.Script.html#6434" class="Function">showArgsS</a> <a id="6576" href="SMT.Script.html#6535" class="Bound">xs</a><a id="6578" class="Symbol">;</a> <a id="6580" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6587" class="Symbol">(</a><a id="6588" href="SMT.Script.html#6544" class="Bound">x</a> <a id="6590" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6592" href="SMT.Script.html#6561" class="Bound">xs</a><a id="6594" class="Symbol">)</a>


<a id="6598" class="Comment">-- |Show a command as an S-expression, and build up an environment of output parsers.</a>
<a id="showCommandS"></a><a id="6684" href="SMT.Script.html#6684" class="Function">showCommandS</a> <a id="6697" class="Symbol">:</a> <a id="6699" href="SMT.Script.Base.html#7626" class="Datatype">Command</a> <a id="6707" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6709" href="SMT.Script.html#1437" class="Generalizable">δΓ</a> <a id="6712" href="SMT.Script.html#1553" class="Generalizable">δΞ</a> <a id="6715" class="Symbol">→</a> <a id="6717" href="SMT.Script.html#4765" class="Function">NameState</a> <a id="6727" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6729" class="Symbol">(</a><a id="6730" href="SMT.Script.html#1437" class="Generalizable">δΓ</a> <a id="6733" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="6736" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="6737" class="Symbol">)</a> <a id="6739" class="Symbol">(</a><a id="6740" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="6747" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6749" href="SMT.Script.html#2169" class="Function">OutputParsers</a> <a id="6763" href="SMT.Script.html#1553" class="Generalizable">δΞ</a><a id="6765" class="Symbol">)</a>
<a id="6767" href="SMT.Script.html#6684" class="Function">showCommandS</a> <a id="6780" class="Symbol">(</a><a id="6781" href="SMT.Script.Base.html#7691" class="InductiveConstructor">set-logic</a> <a id="6791" href="SMT.Script.html#6791" class="Bound">l</a><a id="6792" class="Symbol">)</a> <a id="6794" class="Symbol">=</a> <a id="6796" class="Keyword">do</a>
  <a id="6801" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6808" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6810" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="6818" class="Symbol">(</a><a id="6819" class="String">&quot;set-logic&quot;</a> <a id="6831" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6833" href="SMT.Logics.html#6232" class="Function">showLogic</a> <a id="6843" href="SMT.Script.html#6791" class="Bound">l</a> <a id="6845" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6847" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6849" class="Symbol">)</a> <a id="6851" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6853" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="6856" href="SMT.Script.html#6684" class="Function">showCommandS</a> <a id="6869" class="Symbol">(</a><a id="6870" href="SMT.Script.Base.html#7739" class="InductiveConstructor">declare-const</a> <a id="6884" href="SMT.Script.html#6884" class="Bound">σ</a><a id="6885" class="Symbol">)</a> <a id="6887" class="Symbol">=</a> <a id="6889" class="Keyword">do</a>
  <a id="6894" href="SMT.Script.html#6894" class="Bound">n</a> <a id="6896" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6898" href="SMT.Script.html#5258" class="Function">freshNameS</a> <a id="6909" href="SMT.Script.html#6884" class="Bound">σ</a>
  <a id="6913" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6920" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6922" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="6930" class="Symbol">(</a><a id="6931" class="String">&quot;declare-const&quot;</a> <a id="6947" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6949" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="6958" href="SMT.Script.html#6894" class="Bound">n</a> <a id="6960" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6962" href="SMT.Theory.html#1304" class="Function">showSort</a> <a id="6971" href="SMT.Script.html#6884" class="Bound">σ</a> <a id="6973" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6975" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6977" class="Symbol">)</a> <a id="6979" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6981" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="6984" href="SMT.Script.html#6684" class="Function">showCommandS</a> <a id="6997" class="Symbol">(</a><a id="6998" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a> <a id="7005" href="SMT.Script.html#7005" class="Bound">x</a><a id="7006" class="Symbol">)</a> <a id="7008" class="Symbol">=</a> <a id="7010" class="Keyword">do</a>
  <a id="7015" href="SMT.Script.html#7015" class="Bound">x</a> <a id="7017" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7019" href="SMT.Script.html#5791" class="Function">showTermS</a> <a id="7029" href="SMT.Script.html#7005" class="Bound">x</a>
  <a id="7033" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7040" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7042" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="7050" class="Symbol">(</a><a id="7051" class="String">&quot;assert&quot;</a> <a id="7060" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7062" href="SMT.Script.html#7015" class="Bound">x</a> <a id="7064" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7066" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7068" class="Symbol">)</a> <a id="7070" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7072" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7075" href="SMT.Script.html#6684" class="Function">showCommandS</a> <a id="7088" href="SMT.Script.Base.html#7840" class="InductiveConstructor">check-sat</a> <a id="7098" class="Symbol">=</a> <a id="7100" class="Keyword">do</a>
  <a id="7105" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7112" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7114" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="7122" class="Symbol">(</a><a id="7123" class="String">&quot;check-sat&quot;</a> <a id="7135" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7137" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7139" class="Symbol">)</a> <a id="7141" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7143" href="SMT.Script.html#2288" class="Function">pSat</a> <a id="7148" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7150" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7153" href="SMT.Script.html#6684" class="Function">showCommandS</a> <a id="7166" href="SMT.Script.Base.html#7882" class="InductiveConstructor">get-model</a> <a id="7176" class="Symbol">=</a> <a id="7178" class="Keyword">do</a>
  <a id="7183" class="Symbol">(</a><a id="7184" href="SMT.Script.html#7184" class="Bound Operator">_ns</a> <a id="7188" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7190" href="SMT.Script.html#7190" class="Bound">vps</a><a id="7193" class="Symbol">)</a> <a id="7195" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7197" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="7203" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7210" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7212" href="Data.String.Base.html#2550" class="Function">String.unlines</a> <a id="7227" class="Symbol">(</a> <a id="7229" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="7237" class="Symbol">(</a><a id="7238" class="String">&quot;check-sat&quot;</a> <a id="7250" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7252" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7254" class="Symbol">)</a>
                          <a id="7282" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7284" href="SMT.Theory.html#2066" class="Function">mkSTerm</a> <a id="7292" class="Symbol">(</a><a id="7293" class="String">&quot;get-model&quot;</a> <a id="7305" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7307" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7309" class="Symbol">)</a> <a id="7311" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7313" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="7316" class="Symbol">)</a>
         <a id="7327" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7329" href="SMT.Script.html#4203" class="Function">mkModelParser</a> <a id="7343" class="Symbol">(</a><a id="7344" href="SMT.Script.html#1789" class="Function">mkVarParser</a> <a id="7356" href="SMT.Script.html#7190" class="Bound">vps</a><a id="7359" class="Symbol">)</a> <a id="7361" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7363" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>

<a id="7367" class="Comment">-- |Show a script as an S-expression, and build up an environment of output parsers.</a>
<a id="showScriptS"></a><a id="7452" href="SMT.Script.html#7452" class="Function">showScriptS</a> <a id="7464" class="Symbol">:</a> <a id="7466" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="7473" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="7475" href="SMT.Script.html#1434" class="Generalizable">Γ′</a> <a id="7478" href="SMT.Script.html#1548" class="Generalizable">Ξ</a> <a id="7480" class="Symbol">→</a> <a id="7482" href="SMT.Script.html#4765" class="Function">NameState</a> <a id="7492" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="7494" href="SMT.Script.html#1434" class="Generalizable">Γ′</a> <a id="7497" class="Symbol">(</a><a id="7498" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7503" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="7510" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7512" href="SMT.Script.html#2169" class="Function">OutputParsers</a> <a id="7526" href="SMT.Script.html#1548" class="Generalizable">Ξ</a><a id="7527" class="Symbol">)</a>
<a id="7529" href="SMT.Script.html#7452" class="Function">showScriptS</a> <a id="7541" href="SMT.Script.Base.html#8084" class="InductiveConstructor">[]</a> <a id="7544" class="Symbol">=</a> <a id="7546" class="Keyword">do</a>
  <a id="7551" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7558" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7560" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="7563" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7565" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7568" href="SMT.Script.html#7452" class="Function">showScriptS</a> <a id="7580" class="Symbol">(</a><a id="7581" href="SMT.Script.html#7581" class="Bound">cmd</a> <a id="7585" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="7587" href="SMT.Script.html#7587" class="Bound">scr</a><a id="7590" class="Symbol">)</a> <a id="7592" class="Symbol">=</a> <a id="7594" class="Keyword">do</a>
  <a id="7599" class="Symbol">(</a><a id="7600" href="SMT.Script.html#7600" class="Bound">cmd</a> <a id="7604" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7606" href="SMT.Script.html#7606" class="Bound">ops₁</a><a id="7610" class="Symbol">)</a> <a id="7612" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7614" href="SMT.Script.html#6684" class="Function">showCommandS</a> <a id="7627" href="SMT.Script.html#7581" class="Bound">cmd</a>
  <a id="7633" class="Symbol">(</a><a id="7634" href="SMT.Script.html#7634" class="Bound">scr</a> <a id="7638" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7640" href="SMT.Script.html#7640" class="Bound">ops₂</a><a id="7644" class="Symbol">)</a> <a id="7646" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7648" href="SMT.Script.html#7452" class="Function">showScriptS</a> <a id="7660" href="SMT.Script.html#7587" class="Bound">scr</a>
  <a id="7666" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7673" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7675" href="SMT.Script.html#7600" class="Bound">cmd</a> <a id="7679" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7681" href="SMT.Script.html#7634" class="Bound">scr</a> <a id="7685" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7687" href="Data.Environment.html#1225" class="Function">Env.append</a> <a id="7698" href="Function.Base.html#615" class="Function">id</a> <a id="7701" href="SMT.Script.html#7606" class="Bound">ops₁</a> <a id="7706" href="SMT.Script.html#7640" class="Bound">ops₂</a>

<a id="7712" class="Comment">-- |Show a script as an S-expression, and return an environment of output parsers.</a>
<a id="showScript"></a><a id="7795" href="SMT.Script.html#7795" class="Function">showScript</a> <a id="7806" class="Symbol">:</a> <a id="7808" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="7815" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="7818" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="7820" class="Symbol">(</a><a id="7821" href="SMT.Script.html#1523" class="Generalizable">ξ</a> <a id="7823" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7825" href="SMT.Script.html#1548" class="Generalizable">Ξ</a><a id="7826" class="Symbol">)</a> <a id="7828" class="Symbol">→</a> <a id="7830" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="7837" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7839" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="7842" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="7849" class="Symbol">(</a><a id="7850" href="SMT.Script.Base.html#6075" class="Datatype">Outputs</a> <a id="7858" class="Symbol">(</a><a id="7859" href="SMT.Script.html#1523" class="Generalizable">ξ</a> <a id="7861" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7863" href="SMT.Script.html#1548" class="Generalizable">Ξ</a><a id="7864" class="Symbol">))</a> <a id="7867" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="7869" href="SMT.Script.html#7795" class="Function">showScript</a> <a id="7880" href="SMT.Script.html#7880" class="Bound">scr</a> <a id="7884" class="Symbol">=</a> <a id="7886" href="Data.Product.html#2450" class="Function">Prod.map</a> <a id="7895" href="Data.String.Base.html#2550" class="Function">String.unlines</a> <a id="7910" href="SMT.Script.html#4531" class="Function">mkOutputParsers⁺</a> <a id="7927" class="Symbol">(</a><a id="7928" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="7934" class="Symbol">(</a><a id="7935" href="SMT.Script.html#7452" class="Function">showScriptS</a> <a id="7947" href="SMT.Script.html#7880" class="Bound">scr</a> <a id="7951" class="Symbol">(</a><a id="7952" href="SMT.Script.Names.html#2732" class="Function">x′es</a> <a id="7957" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7959" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="7961" class="Symbol">)))</a>

<a id="7966" class="Comment">-- |Get the variable parser for a script (for debugging purposes).</a>
<a id="getVarParser"></a><a id="8033" href="SMT.Script.html#8033" class="Function">getVarParser</a> <a id="8046" class="Symbol">:</a> <a id="8048" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="8055" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="8058" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="8060" href="SMT.Script.html#1548" class="Generalizable">Ξ</a> <a id="8062" class="Symbol">→</a> <a id="8064" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="8067" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="8074" class="Symbol">(</a><a id="8075" href="Data.Product.html#1788" class="Function">∃[</a> <a id="8078" href="SMT.Script.html#8078" class="Bound">σ</a> <a id="8080" href="Data.Product.html#1788" class="Function">]</a> <a id="8082" class="Symbol">(</a><a id="8083" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="8085" href="SMT.Script.Base.html#1249" class="Function Operator">∋</a> <a id="8087" href="SMT.Script.html#8078" class="Bound">σ</a><a id="8088" class="Symbol">))</a> <a id="8091" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="8093" href="SMT.Script.html#8033" class="Function">getVarParser</a> <a id="8106" href="SMT.Script.html#8106" class="Bound">scr</a> <a id="8110" class="Symbol">=</a> <a id="8112" href="SMT.Script.html#1789" class="Function">mkVarParser</a> <a id="8124" class="Symbol">(</a><a id="8125" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8131" class="Symbol">(</a><a id="8132" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8138" class="Symbol">(</a><a id="8139" href="SMT.Script.html#7452" class="Function">showScriptS</a> <a id="8151" href="SMT.Script.html#8106" class="Bound">scr</a> <a id="8155" class="Symbol">(</a><a id="8156" href="SMT.Script.Names.html#2732" class="Function">x′es</a> <a id="8161" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8163" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="8165" class="Symbol">))))</a>

<a id="8171" class="Comment">-- -}</a>
<a id="8177" class="Comment">-- -}</a>
<a id="8183" class="Comment">-- -}</a>
</pre></body></html>