<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.LinearAlgebra.As.Float</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst: Neural Network Verification in Agda</a>
<a id="131" class="Comment">--</a>
<a id="134" class="Comment">-- This module exports the basic operations for linear algebra over Floats.</a>
<a id="210" class="Comment">--</a>
<a id="213" class="Comment">-- Exports:</a>
<a id="225" class="Comment">--</a>
<a id="228" class="Comment">--   - sum</a>
<a id="239" class="Comment">--   - _⊕_</a>
<a id="250" class="Comment">--   - _⊛_</a>
<a id="261" class="Comment">--   - _·_</a>
<a id="272" class="Comment">--   - scale</a>
<a id="285" class="Comment">--   - normalise</a>
<a id="302" class="Comment">--   - _v⊡m_</a>
<a id="315" class="Comment">--   - _⊡_</a>
<a id="326" class="Comment">--   - _m⊡v_</a>
<a id="339" class="Comment">--</a>
<a id="342" class="Comment">--------------------------------------------------------------------------------</a>
<a id="423" class="Keyword">module</a> <a id="430" href="Amethyst.LinearAlgebra.As.Float.html" class="Module">Amethyst.LinearAlgebra.As.Float</a> <a id="462" class="Keyword">where</a>

<a id="469" class="Keyword">open</a> <a id="474" class="Keyword">import</a> <a id="481" href="Amethyst.LinearAlgebra.Base.html" class="Module">Amethyst.LinearAlgebra.Base</a>
<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="531" class="Symbol">as</a> <a id="534" class="Module">Bool</a> <a id="539" class="Keyword">using</a> <a id="545" class="Symbol">(</a><a id="546" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a><a id="559" class="Symbol">)</a>
<a id="561" class="Keyword">open</a> <a id="566" class="Keyword">import</a> <a id="573" href="Data.Float.html" class="Module">Data.Float</a> <a id="584" class="Symbol">as</a> <a id="587" class="Module">Float</a> <a id="593" class="Keyword">using</a> <a id="599" class="Symbol">(</a><a id="600" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="605" class="Symbol">;</a> <a id="607" href="Agda.Builtin.Float.html#422" class="Primitive">_≤ᵇ_</a><a id="611" class="Symbol">;</a> <a id="613" href="Agda.Builtin.Float.html#1336" class="Primitive">_+_</a><a id="616" class="Symbol">;</a> <a id="618" href="Agda.Builtin.Float.html#1389" class="Primitive">_-_</a><a id="621" class="Symbol">;</a> <a id="623" href="Agda.Builtin.Float.html#1442" class="Primitive">_*_</a><a id="626" class="Symbol">;</a> <a id="628" href="Agda.Builtin.Float.html#1495" class="Primitive">_÷_</a><a id="631" class="Symbol">)</a>
<a id="633" class="Keyword">open</a> <a id="638" class="Keyword">import</a> <a id="645" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="654" class="Symbol">as</a> <a id="657" class="Module">Nat</a> <a id="661" class="Keyword">using</a> <a id="667" class="Symbol">(</a><a id="668" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="669" class="Symbol">)</a>
<a id="671" class="Keyword">open</a> <a id="676" class="Keyword">import</a> <a id="683" href="Data.Product.html" class="Module">Data.Product</a> <a id="696" class="Keyword">using</a> <a id="702" class="Symbol">(</a><a id="703" href="Data.Product.html#3386" class="Function">uncurry</a><a id="710" class="Symbol">)</a>
<a id="712" class="Keyword">open</a> <a id="717" class="Keyword">import</a> <a id="724" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="733" class="Symbol">as</a> <a id="736" class="Module">Vec</a> <a id="740" class="Keyword">using</a> <a id="746" class="Symbol">(</a><a id="747" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="750" class="Symbol">)</a>
<a id="752" class="Keyword">open</a> <a id="757" class="Keyword">import</a> <a id="764" href="Function.html" class="Module">Function</a> <a id="773" class="Keyword">using</a> <a id="779" class="Symbol">(</a><a id="780" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="783" class="Symbol">;</a> <a id="785" href="Function.Base.html#636" class="Function">const</a><a id="790" class="Symbol">;</a> <a id="792" href="Function.Base.html#615" class="Function">id</a><a id="794" class="Symbol">)</a>

<a id="797" class="Comment">-- * Linear algebra</a>

<a id="818" class="Comment">-- ** Vectors</a>

<a id="833" class="Keyword">private</a>
  <a id="843" class="Keyword">variable</a>
    <a id="856" href="Amethyst.LinearAlgebra.As.Float.html#856" class="Generalizable">n</a> <a id="858" class="Symbol">:</a> <a id="860" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="863" class="Comment">-- |Sum.</a>
<a id="sum"></a><a id="872" href="Amethyst.LinearAlgebra.As.Float.html#872" class="Function">sum</a> <a id="876" class="Symbol">:</a> <a id="878" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="882" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="888" href="Amethyst.LinearAlgebra.As.Float.html#856" class="Generalizable">n</a> <a id="890" class="Symbol">→</a> <a id="892" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a>
<a id="898" href="Amethyst.LinearAlgebra.As.Float.html#872" class="Function">sum</a> <a id="902" class="Symbol">=</a> <a id="904" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="914" class="Symbol">_</a> <a id="916" href="Agda.Builtin.Float.html#1336" class="Primitive Operator">_+_</a> <a id="920" class="Number">0.0</a>

<a id="925" class="Comment">-- |Pointwise addition.</a>
<a id="_⊕_"></a><a id="949" href="Amethyst.LinearAlgebra.As.Float.html#949" class="Function Operator">_⊕_</a> <a id="953" class="Symbol">:</a> <a id="955" class="Symbol">(</a><a id="956" href="Amethyst.LinearAlgebra.As.Float.html#956" class="Bound">xs</a> <a id="959" href="Amethyst.LinearAlgebra.As.Float.html#959" class="Bound">ys</a> <a id="962" class="Symbol">:</a> <a id="964" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="968" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="974" href="Amethyst.LinearAlgebra.As.Float.html#856" class="Generalizable">n</a><a id="975" class="Symbol">)</a> <a id="977" class="Symbol">→</a> <a id="979" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="983" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="989" href="Amethyst.LinearAlgebra.As.Float.html#856" class="Generalizable">n</a>
<a id="991" href="Amethyst.LinearAlgebra.As.Float.html#949" class="Function Operator">_⊕_</a> <a id="995" class="Symbol">=</a> <a id="997" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="1009" href="Agda.Builtin.Float.html#1336" class="Primitive Operator">_+_</a>

<a id="1014" class="Comment">-- |Pointwise multiplication.</a>
<a id="_⊛_"></a><a id="1044" href="Amethyst.LinearAlgebra.As.Float.html#1044" class="Function Operator">_⊛_</a> <a id="1048" class="Symbol">:</a> <a id="1050" class="Symbol">(</a><a id="1051" href="Amethyst.LinearAlgebra.As.Float.html#1051" class="Bound">xs</a> <a id="1054" href="Amethyst.LinearAlgebra.As.Float.html#1054" class="Bound">ys</a> <a id="1057" class="Symbol">:</a> <a id="1059" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1063" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1069" href="Amethyst.LinearAlgebra.As.Float.html#856" class="Generalizable">n</a><a id="1070" class="Symbol">)</a> <a id="1072" class="Symbol">→</a> <a id="1074" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1078" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1084" href="Amethyst.LinearAlgebra.As.Float.html#856" class="Generalizable">n</a>
<a id="1086" href="Amethyst.LinearAlgebra.As.Float.html#1044" class="Function Operator">_⊛_</a> <a id="1090" class="Symbol">=</a> <a id="1092" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="1104" href="Agda.Builtin.Float.html#1442" class="Primitive Operator">_*_</a>

<a id="1109" class="Comment">-- |Dot product.</a>
<a id="_·_"></a><a id="1126" href="Amethyst.LinearAlgebra.As.Float.html#1126" class="Function Operator">_·_</a> <a id="1130" class="Symbol">:</a> <a id="1132" class="Symbol">(</a><a id="1133" href="Amethyst.LinearAlgebra.As.Float.html#1133" class="Bound">xs</a> <a id="1136" href="Amethyst.LinearAlgebra.As.Float.html#1136" class="Bound">ys</a> <a id="1139" class="Symbol">:</a> <a id="1141" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1145" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1151" href="Amethyst.LinearAlgebra.As.Float.html#856" class="Generalizable">n</a><a id="1152" class="Symbol">)</a> <a id="1154" class="Symbol">→</a> <a id="1156" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a>
<a id="1162" href="Amethyst.LinearAlgebra.As.Float.html#1126" class="Function Operator">_·_</a> <a id="1166" href="Amethyst.LinearAlgebra.As.Float.html#1166" class="Bound">xs</a> <a id="1169" href="Amethyst.LinearAlgebra.As.Float.html#1169" class="Bound">ys</a> <a id="1172" class="Symbol">=</a> <a id="1174" href="Amethyst.LinearAlgebra.As.Float.html#872" class="Function">sum</a> <a id="1178" class="Symbol">(</a><a id="1179" href="Amethyst.LinearAlgebra.As.Float.html#1166" class="Bound">xs</a> <a id="1182" href="Amethyst.LinearAlgebra.As.Float.html#949" class="Function Operator">⊕</a> <a id="1184" href="Amethyst.LinearAlgebra.As.Float.html#1169" class="Bound">ys</a><a id="1186" class="Symbol">)</a>

<a id="1189" class="Comment">-- |Vector scaling.</a>
<a id="scale"></a><a id="1209" href="Amethyst.LinearAlgebra.As.Float.html#1209" class="Function">scale</a> <a id="1215" class="Symbol">:</a> <a id="1217" class="Symbol">(</a><a id="1218" href="Amethyst.LinearAlgebra.As.Float.html#1218" class="Bound">x</a> <a id="1220" class="Symbol">:</a> <a id="1222" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="1227" class="Symbol">)</a> <a id="1229" class="Symbol">(</a><a id="1230" href="Amethyst.LinearAlgebra.As.Float.html#1230" class="Bound">ys</a> <a id="1233" class="Symbol">:</a> <a id="1235" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1239" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1245" href="Amethyst.LinearAlgebra.As.Float.html#856" class="Generalizable">n</a><a id="1246" class="Symbol">)</a> <a id="1248" class="Symbol">→</a> <a id="1250" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1254" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1260" href="Amethyst.LinearAlgebra.As.Float.html#856" class="Generalizable">n</a>
<a id="1262" href="Amethyst.LinearAlgebra.As.Float.html#1209" class="Function">scale</a> <a id="1268" href="Amethyst.LinearAlgebra.As.Float.html#1268" class="Bound">x</a> <a id="1270" class="Symbol">=</a> <a id="1272" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1280" class="Symbol">(</a><a id="1281" href="Amethyst.LinearAlgebra.As.Float.html#1268" class="Bound">x</a> <a id="1283" href="Agda.Builtin.Float.html#1442" class="Primitive Operator">*_</a><a id="1285" class="Symbol">)</a>

<a id="1288" class="Comment">-- |Vector normalisation.</a>
<a id="normalise"></a><a id="1314" href="Amethyst.LinearAlgebra.As.Float.html#1314" class="Function">normalise</a> <a id="1324" class="Symbol">:</a> <a id="1326" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1330" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1336" href="Amethyst.LinearAlgebra.As.Float.html#856" class="Generalizable">n</a> <a id="1338" class="Symbol">→</a> <a id="1340" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1344" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1350" href="Amethyst.LinearAlgebra.As.Float.html#856" class="Generalizable">n</a>
<a id="1352" href="Amethyst.LinearAlgebra.As.Float.html#1314" class="Function">normalise</a> <a id="1362" href="Amethyst.LinearAlgebra.As.Float.html#1362" class="Bound">xs</a> <a id="1365" class="Symbol">=</a> <a id="1367" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1375" class="Symbol">(</a><a id="1376" href="Agda.Builtin.Float.html#1495" class="Primitive Operator">_÷</a> <a id="1379" href="Amethyst.LinearAlgebra.As.Float.html#872" class="Function">sum</a> <a id="1383" href="Amethyst.LinearAlgebra.As.Float.html#1362" class="Bound">xs</a><a id="1385" class="Symbol">)</a> <a id="1387" href="Amethyst.LinearAlgebra.As.Float.html#1362" class="Bound">xs</a>

<a id="1391" class="Keyword">private</a>
  <a id="1401" class="Keyword">variable</a>
    <a id="1414" href="Amethyst.LinearAlgebra.As.Float.html#1414" class="Generalizable">i</a> <a id="1416" class="Symbol">:</a> <a id="1418" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1424" href="Amethyst.LinearAlgebra.As.Float.html#1424" class="Generalizable">j</a> <a id="1426" class="Symbol">:</a> <a id="1428" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1434" href="Amethyst.LinearAlgebra.As.Float.html#1434" class="Generalizable">k</a> <a id="1436" class="Symbol">:</a> <a id="1438" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1444" href="Amethyst.LinearAlgebra.As.Float.html#1444" class="Generalizable">rows</a> <a id="1449" class="Symbol">:</a> <a id="1451" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1457" href="Amethyst.LinearAlgebra.As.Float.html#1457" class="Generalizable">cols</a> <a id="1462" class="Symbol">:</a> <a id="1464" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1467" class="Comment">-- |Vector-matrix multiplication.</a>
<a id="_v⊡m_"></a><a id="1501" href="Amethyst.LinearAlgebra.As.Float.html#1501" class="Function Operator">_v⊡m_</a> <a id="1507" class="Symbol">:</a> <a id="1509" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1513" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1519" href="Amethyst.LinearAlgebra.As.Float.html#1424" class="Generalizable">j</a> <a id="1521" class="Symbol">→</a> <a id="1523" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="1527" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1533" href="Amethyst.LinearAlgebra.As.Float.html#1424" class="Generalizable">j</a> <a id="1535" href="Amethyst.LinearAlgebra.As.Float.html#1434" class="Generalizable">k</a> <a id="1537" class="Symbol">→</a> <a id="1539" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1543" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1549" href="Amethyst.LinearAlgebra.As.Float.html#1434" class="Generalizable">k</a>
<a id="1551" href="Amethyst.LinearAlgebra.As.Float.html#1551" class="Bound">xs</a> <a id="1554" href="Amethyst.LinearAlgebra.As.Float.html#1501" class="Function Operator">v⊡m</a> <a id="1558" href="Amethyst.LinearAlgebra.As.Float.html#1558" class="Bound">yss</a> <a id="1562" class="Symbol">=</a> <a id="1564" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="1574" class="Symbol">_</a> <a id="1576" class="Symbol">(</a><a id="1577" href="Amethyst.LinearAlgebra.As.Float.html#949" class="Function Operator">_⊕_</a> <a id="1581" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1583" href="Data.Product.html#3386" class="Function">uncurry</a> <a id="1591" href="Amethyst.LinearAlgebra.As.Float.html#1209" class="Function">scale</a><a id="1596" class="Symbol">)</a> <a id="1598" class="Symbol">(</a><a id="1599" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="1613" class="Number">0.0</a><a id="1616" class="Symbol">)</a> <a id="1618" class="Symbol">(</a><a id="1619" href="Data.Vec.Base.html#3858" class="Function">Vec.zip</a> <a id="1627" href="Amethyst.LinearAlgebra.As.Float.html#1551" class="Bound">xs</a> <a id="1630" href="Amethyst.LinearAlgebra.As.Float.html#1558" class="Bound">yss</a><a id="1633" class="Symbol">)</a>

<a id="1636" class="Comment">-- |Matrix multiplcation.</a>
<a id="_⊡_"></a><a id="1662" href="Amethyst.LinearAlgebra.As.Float.html#1662" class="Function Operator">_⊡_</a> <a id="1666" class="Symbol">:</a> <a id="1668" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="1672" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1678" href="Amethyst.LinearAlgebra.As.Float.html#1414" class="Generalizable">i</a> <a id="1680" href="Amethyst.LinearAlgebra.As.Float.html#1424" class="Generalizable">j</a> <a id="1682" class="Symbol">→</a> <a id="1684" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="1688" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1694" href="Amethyst.LinearAlgebra.As.Float.html#1424" class="Generalizable">j</a> <a id="1696" href="Amethyst.LinearAlgebra.As.Float.html#1434" class="Generalizable">k</a> <a id="1698" class="Symbol">→</a> <a id="1700" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="1704" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1710" href="Amethyst.LinearAlgebra.As.Float.html#1414" class="Generalizable">i</a> <a id="1712" href="Amethyst.LinearAlgebra.As.Float.html#1434" class="Generalizable">k</a>
<a id="1714" href="Amethyst.LinearAlgebra.As.Float.html#1714" class="Bound">xss</a> <a id="1718" href="Amethyst.LinearAlgebra.As.Float.html#1662" class="Function Operator">⊡</a> <a id="1720" href="Amethyst.LinearAlgebra.As.Float.html#1720" class="Bound">yss</a> <a id="1724" class="Symbol">=</a> <a id="1726" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1734" class="Symbol">(</a><a id="1735" href="Amethyst.LinearAlgebra.As.Float.html#1501" class="Function Operator">_v⊡m</a> <a id="1740" href="Amethyst.LinearAlgebra.As.Float.html#1720" class="Bound">yss</a><a id="1743" class="Symbol">)</a> <a id="1745" href="Amethyst.LinearAlgebra.As.Float.html#1714" class="Bound">xss</a>

<a id="1750" class="Comment">-- |Matrix-vector multiplication.</a>
<a id="_m⊡v_"></a><a id="1784" href="Amethyst.LinearAlgebra.As.Float.html#1784" class="Function Operator">_m⊡v_</a> <a id="1790" class="Symbol">:</a> <a id="1792" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="1796" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1802" href="Amethyst.LinearAlgebra.As.Float.html#1414" class="Generalizable">i</a> <a id="1804" href="Amethyst.LinearAlgebra.As.Float.html#1424" class="Generalizable">j</a> <a id="1806" class="Symbol">→</a> <a id="1808" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1812" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1818" href="Amethyst.LinearAlgebra.As.Float.html#1424" class="Generalizable">j</a> <a id="1820" class="Symbol">→</a> <a id="1822" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1826" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1832" href="Amethyst.LinearAlgebra.As.Float.html#1414" class="Generalizable">i</a>
<a id="1834" href="Amethyst.LinearAlgebra.As.Float.html#1834" class="Bound">xss</a> <a id="1838" href="Amethyst.LinearAlgebra.As.Float.html#1784" class="Function Operator">m⊡v</a> <a id="1842" href="Amethyst.LinearAlgebra.As.Float.html#1842" class="Bound">ys</a> <a id="1845" class="Symbol">=</a> <a id="1847" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1855" href="Data.Vec.Base.html#1455" class="Function">Vec.head</a> <a id="1864" class="Symbol">(</a><a id="1865" href="Amethyst.LinearAlgebra.As.Float.html#1834" class="Bound">xss</a> <a id="1869" href="Amethyst.LinearAlgebra.As.Float.html#1662" class="Function Operator">⊡</a> <a id="1871" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1879" href="Data.Vec.Base.html#5711" class="Function Operator">Vec.[_]</a> <a id="1887" href="Amethyst.LinearAlgebra.As.Float.html#1842" class="Bound">ys</a><a id="1889" class="Symbol">)</a>
</pre></body></html>