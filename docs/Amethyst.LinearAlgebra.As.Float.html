<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.LinearAlgebra.As.Float</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Amethyst.LinearAlgebra.As.Float.html" class="Module">Amethyst.LinearAlgebra.As.Float</a> <a id="40" class="Keyword">where</a>

<a id="47" class="Keyword">open</a> <a id="52" class="Keyword">import</a> <a id="59" href="Amethyst.LinearAlgebra.Base.html" class="Module">Amethyst.LinearAlgebra.Base</a>
<a id="87" class="Keyword">open</a> <a id="92" class="Keyword">import</a> <a id="99" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="109" class="Symbol">as</a> <a id="112" class="Module">Bool</a> <a id="117" class="Keyword">using</a> <a id="123" class="Symbol">(</a><a id="124" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a><a id="137" class="Symbol">)</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Data.Float.html" class="Module">Data.Float</a> <a id="162" class="Symbol">as</a> <a id="165" class="Module">Float</a> <a id="171" class="Keyword">using</a> <a id="177" class="Symbol">(</a><a id="178" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="183" class="Symbol">;</a> <a id="185" href="Agda.Builtin.Float.html#422" class="Primitive">_≤ᵇ_</a><a id="189" class="Symbol">;</a> <a id="191" href="Agda.Builtin.Float.html#1336" class="Primitive">_+_</a><a id="194" class="Symbol">;</a> <a id="196" href="Agda.Builtin.Float.html#1389" class="Primitive">_-_</a><a id="199" class="Symbol">;</a> <a id="201" href="Agda.Builtin.Float.html#1442" class="Primitive">_*_</a><a id="204" class="Symbol">;</a> <a id="206" href="Agda.Builtin.Float.html#1495" class="Primitive">_÷_</a><a id="209" class="Symbol">)</a>
<a id="211" class="Keyword">open</a> <a id="216" class="Keyword">import</a> <a id="223" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="232" class="Symbol">as</a> <a id="235" class="Module">Nat</a> <a id="239" class="Keyword">using</a> <a id="245" class="Symbol">(</a><a id="246" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="247" class="Symbol">)</a>
<a id="249" class="Keyword">open</a> <a id="254" class="Keyword">import</a> <a id="261" href="Data.Product.html" class="Module">Data.Product</a> <a id="274" class="Keyword">using</a> <a id="280" class="Symbol">(</a><a id="281" href="Data.Product.html#3399" class="Function">uncurry</a><a id="288" class="Symbol">)</a>
<a id="290" class="Keyword">open</a> <a id="295" class="Keyword">import</a> <a id="302" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="311" class="Symbol">as</a> <a id="314" class="Module">Vec</a> <a id="318" class="Keyword">using</a> <a id="324" class="Symbol">(</a><a id="325" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="328" class="Symbol">)</a>
<a id="330" class="Keyword">open</a> <a id="335" class="Keyword">import</a> <a id="342" href="Function.html" class="Module">Function</a> <a id="351" class="Keyword">using</a> <a id="357" class="Symbol">(</a><a id="358" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="361" class="Symbol">;</a> <a id="363" href="Function.Base.html#636" class="Function">const</a><a id="368" class="Symbol">;</a> <a id="370" href="Function.Base.html#615" class="Function">id</a><a id="372" class="Symbol">)</a>

<a id="375" class="Comment">-- * Linear algebra</a>

<a id="396" class="Comment">-- ** Vectors</a>

<a id="411" class="Keyword">private</a>
  <a id="421" class="Keyword">variable</a>
    <a id="434" href="Amethyst.LinearAlgebra.As.Float.html#434" class="Generalizable">n</a> <a id="436" class="Symbol">:</a> <a id="438" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="441" class="Comment">-- |Sum.</a>
<a id="sum"></a><a id="450" href="Amethyst.LinearAlgebra.As.Float.html#450" class="Function">sum</a> <a id="454" class="Symbol">:</a> <a id="456" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="460" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="466" href="Amethyst.LinearAlgebra.As.Float.html#434" class="Generalizable">n</a> <a id="468" class="Symbol">→</a> <a id="470" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a>
<a id="476" href="Amethyst.LinearAlgebra.As.Float.html#450" class="Function">sum</a> <a id="480" class="Symbol">=</a> <a id="482" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="492" class="Symbol">_</a> <a id="494" href="Agda.Builtin.Float.html#1336" class="Primitive Operator">_+_</a> <a id="498" class="Number">0.0</a>

<a id="503" class="Comment">-- |Pointwise addition.</a>
<a id="_⊕_"></a><a id="527" href="Amethyst.LinearAlgebra.As.Float.html#527" class="Function Operator">_⊕_</a> <a id="531" class="Symbol">:</a> <a id="533" class="Symbol">(</a><a id="534" href="Amethyst.LinearAlgebra.As.Float.html#534" class="Bound">xs</a> <a id="537" href="Amethyst.LinearAlgebra.As.Float.html#537" class="Bound">ys</a> <a id="540" class="Symbol">:</a> <a id="542" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="546" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="552" href="Amethyst.LinearAlgebra.As.Float.html#434" class="Generalizable">n</a><a id="553" class="Symbol">)</a> <a id="555" class="Symbol">→</a> <a id="557" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="561" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="567" href="Amethyst.LinearAlgebra.As.Float.html#434" class="Generalizable">n</a>
<a id="569" href="Amethyst.LinearAlgebra.As.Float.html#527" class="Function Operator">_⊕_</a> <a id="573" class="Symbol">=</a> <a id="575" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="587" href="Agda.Builtin.Float.html#1336" class="Primitive Operator">_+_</a>

<a id="592" class="Comment">-- |Pointwise multiplication.</a>
<a id="_⊛_"></a><a id="622" href="Amethyst.LinearAlgebra.As.Float.html#622" class="Function Operator">_⊛_</a> <a id="626" class="Symbol">:</a> <a id="628" class="Symbol">(</a><a id="629" href="Amethyst.LinearAlgebra.As.Float.html#629" class="Bound">xs</a> <a id="632" href="Amethyst.LinearAlgebra.As.Float.html#632" class="Bound">ys</a> <a id="635" class="Symbol">:</a> <a id="637" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="641" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="647" href="Amethyst.LinearAlgebra.As.Float.html#434" class="Generalizable">n</a><a id="648" class="Symbol">)</a> <a id="650" class="Symbol">→</a> <a id="652" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="656" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="662" href="Amethyst.LinearAlgebra.As.Float.html#434" class="Generalizable">n</a>
<a id="664" href="Amethyst.LinearAlgebra.As.Float.html#622" class="Function Operator">_⊛_</a> <a id="668" class="Symbol">=</a> <a id="670" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="682" href="Agda.Builtin.Float.html#1442" class="Primitive Operator">_*_</a>

<a id="687" class="Comment">-- |Dot product.</a>
<a id="_·_"></a><a id="704" href="Amethyst.LinearAlgebra.As.Float.html#704" class="Function Operator">_·_</a> <a id="708" class="Symbol">:</a> <a id="710" class="Symbol">(</a><a id="711" href="Amethyst.LinearAlgebra.As.Float.html#711" class="Bound">xs</a> <a id="714" href="Amethyst.LinearAlgebra.As.Float.html#714" class="Bound">ys</a> <a id="717" class="Symbol">:</a> <a id="719" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="723" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="729" href="Amethyst.LinearAlgebra.As.Float.html#434" class="Generalizable">n</a><a id="730" class="Symbol">)</a> <a id="732" class="Symbol">→</a> <a id="734" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a>
<a id="740" href="Amethyst.LinearAlgebra.As.Float.html#704" class="Function Operator">_·_</a> <a id="744" href="Amethyst.LinearAlgebra.As.Float.html#744" class="Bound">xs</a> <a id="747" href="Amethyst.LinearAlgebra.As.Float.html#747" class="Bound">ys</a> <a id="750" class="Symbol">=</a> <a id="752" href="Amethyst.LinearAlgebra.As.Float.html#450" class="Function">sum</a> <a id="756" class="Symbol">(</a><a id="757" href="Amethyst.LinearAlgebra.As.Float.html#744" class="Bound">xs</a> <a id="760" href="Amethyst.LinearAlgebra.As.Float.html#527" class="Function Operator">⊕</a> <a id="762" href="Amethyst.LinearAlgebra.As.Float.html#747" class="Bound">ys</a><a id="764" class="Symbol">)</a>

<a id="767" class="Comment">-- |Vector scaling.</a>
<a id="scale"></a><a id="787" href="Amethyst.LinearAlgebra.As.Float.html#787" class="Function">scale</a> <a id="793" class="Symbol">:</a> <a id="795" class="Symbol">(</a><a id="796" href="Amethyst.LinearAlgebra.As.Float.html#796" class="Bound">x</a> <a id="798" class="Symbol">:</a> <a id="800" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="805" class="Symbol">)</a> <a id="807" class="Symbol">(</a><a id="808" href="Amethyst.LinearAlgebra.As.Float.html#808" class="Bound">ys</a> <a id="811" class="Symbol">:</a> <a id="813" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="817" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="823" href="Amethyst.LinearAlgebra.As.Float.html#434" class="Generalizable">n</a><a id="824" class="Symbol">)</a> <a id="826" class="Symbol">→</a> <a id="828" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="832" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="838" href="Amethyst.LinearAlgebra.As.Float.html#434" class="Generalizable">n</a>
<a id="840" href="Amethyst.LinearAlgebra.As.Float.html#787" class="Function">scale</a> <a id="846" href="Amethyst.LinearAlgebra.As.Float.html#846" class="Bound">x</a> <a id="848" class="Symbol">=</a> <a id="850" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="858" class="Symbol">(</a><a id="859" href="Amethyst.LinearAlgebra.As.Float.html#846" class="Bound">x</a> <a id="861" href="Agda.Builtin.Float.html#1442" class="Primitive Operator">*_</a><a id="863" class="Symbol">)</a>

<a id="866" class="Comment">-- |Vector normalisation.</a>
<a id="normalise"></a><a id="892" href="Amethyst.LinearAlgebra.As.Float.html#892" class="Function">normalise</a> <a id="902" class="Symbol">:</a> <a id="904" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="908" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="914" href="Amethyst.LinearAlgebra.As.Float.html#434" class="Generalizable">n</a> <a id="916" class="Symbol">→</a> <a id="918" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="922" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="928" href="Amethyst.LinearAlgebra.As.Float.html#434" class="Generalizable">n</a>
<a id="930" href="Amethyst.LinearAlgebra.As.Float.html#892" class="Function">normalise</a> <a id="940" href="Amethyst.LinearAlgebra.As.Float.html#940" class="Bound">xs</a> <a id="943" class="Symbol">=</a> <a id="945" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="953" class="Symbol">(</a><a id="954" href="Agda.Builtin.Float.html#1495" class="Primitive Operator">_÷</a> <a id="957" href="Amethyst.LinearAlgebra.As.Float.html#450" class="Function">sum</a> <a id="961" href="Amethyst.LinearAlgebra.As.Float.html#940" class="Bound">xs</a><a id="963" class="Symbol">)</a> <a id="965" href="Amethyst.LinearAlgebra.As.Float.html#940" class="Bound">xs</a>

<a id="969" class="Keyword">private</a>
  <a id="979" class="Keyword">variable</a>
    <a id="992" href="Amethyst.LinearAlgebra.As.Float.html#992" class="Generalizable">i</a> <a id="994" class="Symbol">:</a> <a id="996" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1002" href="Amethyst.LinearAlgebra.As.Float.html#1002" class="Generalizable">j</a> <a id="1004" class="Symbol">:</a> <a id="1006" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1012" href="Amethyst.LinearAlgebra.As.Float.html#1012" class="Generalizable">k</a> <a id="1014" class="Symbol">:</a> <a id="1016" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1022" href="Amethyst.LinearAlgebra.As.Float.html#1022" class="Generalizable">rows</a> <a id="1027" class="Symbol">:</a> <a id="1029" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1035" href="Amethyst.LinearAlgebra.As.Float.html#1035" class="Generalizable">cols</a> <a id="1040" class="Symbol">:</a> <a id="1042" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1045" class="Comment">-- |Vector-matrix multiplication.</a>
<a id="_v⊡m_"></a><a id="1079" href="Amethyst.LinearAlgebra.As.Float.html#1079" class="Function Operator">_v⊡m_</a> <a id="1085" class="Symbol">:</a> <a id="1087" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1091" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1097" href="Amethyst.LinearAlgebra.As.Float.html#1002" class="Generalizable">j</a> <a id="1099" class="Symbol">→</a> <a id="1101" href="Amethyst.LinearAlgebra.Base.html#122" class="Function">Mat</a> <a id="1105" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1111" href="Amethyst.LinearAlgebra.As.Float.html#1002" class="Generalizable">j</a> <a id="1113" href="Amethyst.LinearAlgebra.As.Float.html#1012" class="Generalizable">k</a> <a id="1115" class="Symbol">→</a> <a id="1117" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1121" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1127" href="Amethyst.LinearAlgebra.As.Float.html#1012" class="Generalizable">k</a>
<a id="1129" href="Amethyst.LinearAlgebra.As.Float.html#1129" class="Bound">xs</a> <a id="1132" href="Amethyst.LinearAlgebra.As.Float.html#1079" class="Function Operator">v⊡m</a> <a id="1136" href="Amethyst.LinearAlgebra.As.Float.html#1136" class="Bound">yss</a> <a id="1140" class="Symbol">=</a> <a id="1142" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="1152" class="Symbol">_</a> <a id="1154" class="Symbol">(</a><a id="1155" href="Amethyst.LinearAlgebra.As.Float.html#527" class="Function Operator">_⊕_</a> <a id="1159" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1161" href="Data.Product.html#3399" class="Function">uncurry</a> <a id="1169" href="Amethyst.LinearAlgebra.As.Float.html#787" class="Function">scale</a><a id="1174" class="Symbol">)</a> <a id="1176" class="Symbol">(</a><a id="1177" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="1191" class="Number">0.0</a><a id="1194" class="Symbol">)</a> <a id="1196" class="Symbol">(</a><a id="1197" href="Data.Vec.Base.html#3858" class="Function">Vec.zip</a> <a id="1205" href="Amethyst.LinearAlgebra.As.Float.html#1129" class="Bound">xs</a> <a id="1208" href="Amethyst.LinearAlgebra.As.Float.html#1136" class="Bound">yss</a><a id="1211" class="Symbol">)</a>

<a id="1214" class="Comment">-- |Matrix multiplcation.</a>
<a id="_⊡_"></a><a id="1240" href="Amethyst.LinearAlgebra.As.Float.html#1240" class="Function Operator">_⊡_</a> <a id="1244" class="Symbol">:</a> <a id="1246" href="Amethyst.LinearAlgebra.Base.html#122" class="Function">Mat</a> <a id="1250" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1256" href="Amethyst.LinearAlgebra.As.Float.html#992" class="Generalizable">i</a> <a id="1258" href="Amethyst.LinearAlgebra.As.Float.html#1002" class="Generalizable">j</a> <a id="1260" class="Symbol">→</a> <a id="1262" href="Amethyst.LinearAlgebra.Base.html#122" class="Function">Mat</a> <a id="1266" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1272" href="Amethyst.LinearAlgebra.As.Float.html#1002" class="Generalizable">j</a> <a id="1274" href="Amethyst.LinearAlgebra.As.Float.html#1012" class="Generalizable">k</a> <a id="1276" class="Symbol">→</a> <a id="1278" href="Amethyst.LinearAlgebra.Base.html#122" class="Function">Mat</a> <a id="1282" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1288" href="Amethyst.LinearAlgebra.As.Float.html#992" class="Generalizable">i</a> <a id="1290" href="Amethyst.LinearAlgebra.As.Float.html#1012" class="Generalizable">k</a>
<a id="1292" href="Amethyst.LinearAlgebra.As.Float.html#1292" class="Bound">xss</a> <a id="1296" href="Amethyst.LinearAlgebra.As.Float.html#1240" class="Function Operator">⊡</a> <a id="1298" href="Amethyst.LinearAlgebra.As.Float.html#1298" class="Bound">yss</a> <a id="1302" class="Symbol">=</a> <a id="1304" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1312" class="Symbol">(</a><a id="1313" href="Amethyst.LinearAlgebra.As.Float.html#1079" class="Function Operator">_v⊡m</a> <a id="1318" href="Amethyst.LinearAlgebra.As.Float.html#1298" class="Bound">yss</a><a id="1321" class="Symbol">)</a> <a id="1323" href="Amethyst.LinearAlgebra.As.Float.html#1292" class="Bound">xss</a>

<a id="1328" class="Comment">-- |Matrix-vector multiplication.</a>
<a id="_m⊡v_"></a><a id="1362" href="Amethyst.LinearAlgebra.As.Float.html#1362" class="Function Operator">_m⊡v_</a> <a id="1368" class="Symbol">:</a> <a id="1370" href="Amethyst.LinearAlgebra.Base.html#122" class="Function">Mat</a> <a id="1374" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1380" href="Amethyst.LinearAlgebra.As.Float.html#992" class="Generalizable">i</a> <a id="1382" href="Amethyst.LinearAlgebra.As.Float.html#1002" class="Generalizable">j</a> <a id="1384" class="Symbol">→</a> <a id="1386" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1390" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1396" href="Amethyst.LinearAlgebra.As.Float.html#1002" class="Generalizable">j</a> <a id="1398" class="Symbol">→</a> <a id="1400" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1404" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1410" href="Amethyst.LinearAlgebra.As.Float.html#992" class="Generalizable">i</a>
<a id="1412" href="Amethyst.LinearAlgebra.As.Float.html#1412" class="Bound">xss</a> <a id="1416" href="Amethyst.LinearAlgebra.As.Float.html#1362" class="Function Operator">m⊡v</a> <a id="1420" href="Amethyst.LinearAlgebra.As.Float.html#1420" class="Bound">ys</a> <a id="1423" class="Symbol">=</a> <a id="1425" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1433" href="Data.Vec.Base.html#1455" class="Function">Vec.head</a> <a id="1442" class="Symbol">(</a><a id="1443" href="Amethyst.LinearAlgebra.As.Float.html#1412" class="Bound">xss</a> <a id="1447" href="Amethyst.LinearAlgebra.As.Float.html#1240" class="Function Operator">⊡</a> <a id="1449" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1457" href="Data.Vec.Base.html#5711" class="Function Operator">Vec.[_]</a> <a id="1465" href="Amethyst.LinearAlgebra.As.Float.html#1420" class="Bound">ys</a><a id="1467" class="Symbol">)</a>
</pre></body></html>