<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>AND-Gate-2-Sigmoid-1</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst Models: Examples of Neural Network Verification in Agda</a>
<a id="150" class="Comment">--</a>
<a id="153" class="Comment">-- This module contains an example use of Amethyst, to verify the correctness of</a>
<a id="234" class="Comment">-- a simple AND-gate network.</a>
<a id="264" class="Comment">--------------------------------------------------------------------------------</a>

<a id="346" class="Symbol">{-#</a> <a id="350" class="Keyword">OPTIONS</a> <a id="358" class="Pragma">--allow-exec</a> <a id="371" class="Symbol">#-}</a>

<a id="376" class="Keyword">module</a> <a id="383" href="AND-Gate-2-Sigmoid-1.html" class="Module">AND-Gate-2-Sigmoid-1</a> <a id="404" class="Keyword">where</a>

<a id="411" class="Keyword">open</a> <a id="416" class="Keyword">import</a> <a id="423" href="Amethyst.Prelude.html" class="Module">Amethyst.Prelude</a>
<a id="440" class="Keyword">open</a> <a id="445" class="Keyword">import</a> <a id="452" href="Data.Float.html" class="Module">Data.Float</a>
<a id="463" class="Keyword">open</a> <a id="468" class="Keyword">import</a> <a id="475" href="Function.html" class="Module">Function</a> <a id="484" class="Keyword">using</a> <a id="490" class="Symbol">(</a><a id="491" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="494" class="Symbol">)</a>
<a id="496" class="Keyword">open</a> <a id="501" class="Keyword">import</a> <a id="508" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="546" class="Keyword">using</a> <a id="552" class="Symbol">(</a><a id="553" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="556" class="Symbol">;</a> <a id="558" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="562" class="Symbol">)</a>

<a id="layer"></a><a id="565" href="AND-Gate-2-Sigmoid-1.html#565" class="Function">layer</a> <a id="571" class="Symbol">:</a> <a id="573" href="Amethyst.Network.Base.html#943" class="Record">Layer</a> <a id="579" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="585" class="Number">2</a> <a id="587" class="Number">1</a>
<a id="589" href="AND-Gate-2-Sigmoid-1.html#565" class="Function">layer</a> <a id="595" class="Symbol">=</a> <a id="597" class="Keyword">record</a>
  <a id="606" class="Symbol">{</a> <a id="608" href="Amethyst.Network.Base.html#1032" class="Field">weights</a>    <a id="619" class="Symbol">=</a> <a id="621" href="Data.Vec.Base.html#5711" class="Function Operator">[</a> <a id="623" class="Number">5.0e8</a> <a id="629" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
               <a id="646" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="648" href="Data.Vec.Base.html#5711" class="Function Operator">[</a> <a id="650" class="Number">5.0e8</a> <a id="656" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
               <a id="673" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="675" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a>
  <a id="680" class="Symbol">;</a> <a id="682" href="Amethyst.Network.Base.html#1076" class="Field">biases</a>     <a id="693" class="Symbol">=</a> <a id="695" href="Data.Vec.Base.html#5711" class="Function Operator">[</a> <a id="697" class="Number">-7.5e8</a> <a id="704" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
  <a id="708" class="Symbol">;</a> <a id="710" href="Amethyst.Network.Base.html#1004" class="Field">activation</a> <a id="721" class="Symbol">=</a> <a id="723" href="Amethyst.Network.Base.html#868" class="InductiveConstructor">sigmoid</a>
  <a id="733" class="Symbol">}</a>

<a id="model"></a><a id="736" href="AND-Gate-2-Sigmoid-1.html#736" class="Function">model</a> <a id="742" class="Symbol">:</a> <a id="744" href="Amethyst.Network.Base.html#1123" class="Datatype">Network</a> <a id="752" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="758" class="Number">2</a> <a id="760" class="Number">1</a> <a id="762" class="Number">1</a>
<a id="764" href="AND-Gate-2-Sigmoid-1.html#736" class="Function">model</a> <a id="770" class="Symbol">=</a> <a id="772" href="AND-Gate-2-Sigmoid-1.html#565" class="Function">layer</a> <a id="778" href="Amethyst.Network.Base.html#1225" class="InductiveConstructor Operator">∷</a> <a id="780" href="Amethyst.Network.Base.html#1191" class="InductiveConstructor">[]</a>

<a id="script"></a><a id="784" href="AND-Gate-2-Sigmoid-1.html#784" class="Function">script</a> <a id="791" class="Symbol">:</a> <a id="793" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="800" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="803" class="Symbol">(</a><a id="804" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="810" class="Number">2</a> <a id="812" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="815" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="821" class="Number">1</a><a id="822" class="Symbol">)</a> <a id="824" class="Symbol">(</a><a id="825" href="SMT.Script.Base.html#4648" class="InductiveConstructor">SAT</a> <a id="829" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="831" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="833" class="Symbol">)</a>
<a id="835" href="AND-Gate-2-Sigmoid-1.html#784" class="Function">script</a> <a id="842" class="Symbol">=</a> <a id="844" href="Amethyst.Network.As.Schmitty.html#4955" class="Function">withReflectedNetworkAsScript</a> <a id="873" href="AND-Gate-2-Sigmoid-1.html#736" class="Function">model</a> <a id="879" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="881" class="Symbol">λ</a> <a id="883" class="Keyword">where</a>
  <a id="891" class="Comment">-- give names to input and output nodes</a>
  <a id="933" href="AND-Gate-2-Sigmoid-1.html#933" class="Bound">iv</a><a id="935" class="Symbol">@(</a><a id="937" href="AND-Gate-2-Sigmoid-1.html#937" class="Bound">i₀</a> <a id="940" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="942" href="AND-Gate-2-Sigmoid-1.html#942" class="Bound">i₁</a> <a id="945" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="947" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="949" class="Symbol">)</a> <a id="951" href="AND-Gate-2-Sigmoid-1.html#951" class="Bound">ov</a><a id="953" class="Symbol">@(</a><a id="955" href="AND-Gate-2-Sigmoid-1.html#955" class="Bound">o₀</a> <a id="958" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="960" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="962" class="Symbol">)</a>
  <a id="966" class="Comment">-- give remainder of the smt-lib script</a>
    <a id="1010" class="Symbol">→</a> <a id="1012" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a> <a id="1019" class="Symbol">(((</a><a id="1022" href="AND-Gate-2-Sigmoid-1.html#937" class="Bound">i₀</a> <a id="1025" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1028" href="Amethyst.Prelude.html#983" class="Function">0·0f</a><a id="1032" class="Symbol">)</a> <a id="1034" href="Amethyst.Prelude.html#856" class="Function Operator">∧</a> <a id="1036" class="Symbol">(</a><a id="1037" href="AND-Gate-2-Sigmoid-1.html#942" class="Bound">i₁</a> <a id="1040" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1043" href="Amethyst.Prelude.html#983" class="Function">0·0f</a><a id="1047" class="Symbol">))</a> <a id="1050" href="Amethyst.Prelude.html#852" class="Function Operator">⇒</a> <a id="1052" class="Symbol">(</a><a id="1053" href="AND-Gate-2-Sigmoid-1.html#955" class="Bound">o₀</a> <a id="1056" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1059" href="Amethyst.Prelude.html#983" class="Function">0·0f</a><a id="1063" class="Symbol">))</a>
    <a id="1070" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="1072" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a> <a id="1079" class="Symbol">(((</a><a id="1082" href="AND-Gate-2-Sigmoid-1.html#937" class="Bound">i₀</a> <a id="1085" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1088" href="Amethyst.Prelude.html#983" class="Function">0·0f</a><a id="1092" class="Symbol">)</a> <a id="1094" href="Amethyst.Prelude.html#856" class="Function Operator">∧</a> <a id="1096" class="Symbol">(</a><a id="1097" href="AND-Gate-2-Sigmoid-1.html#942" class="Bound">i₁</a> <a id="1100" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1103" href="Amethyst.Prelude.html#988" class="Function">1·0f</a><a id="1107" class="Symbol">))</a> <a id="1110" href="Amethyst.Prelude.html#852" class="Function Operator">⇒</a> <a id="1112" class="Symbol">(</a><a id="1113" href="AND-Gate-2-Sigmoid-1.html#955" class="Bound">o₀</a> <a id="1116" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1119" href="Amethyst.Prelude.html#983" class="Function">0·0f</a><a id="1123" class="Symbol">))</a>
    <a id="1130" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="1132" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a> <a id="1139" class="Symbol">(((</a><a id="1142" href="AND-Gate-2-Sigmoid-1.html#937" class="Bound">i₀</a> <a id="1145" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1148" href="Amethyst.Prelude.html#988" class="Function">1·0f</a><a id="1152" class="Symbol">)</a> <a id="1154" href="Amethyst.Prelude.html#856" class="Function Operator">∧</a> <a id="1156" class="Symbol">(</a><a id="1157" href="AND-Gate-2-Sigmoid-1.html#942" class="Bound">i₁</a> <a id="1160" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1163" href="Amethyst.Prelude.html#983" class="Function">0·0f</a><a id="1167" class="Symbol">))</a> <a id="1170" href="Amethyst.Prelude.html#852" class="Function Operator">⇒</a> <a id="1172" class="Symbol">(</a><a id="1173" href="AND-Gate-2-Sigmoid-1.html#955" class="Bound">o₀</a> <a id="1176" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1179" href="Amethyst.Prelude.html#983" class="Function">0·0f</a><a id="1183" class="Symbol">))</a>
    <a id="1190" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="1192" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a> <a id="1199" class="Symbol">(((</a><a id="1202" href="AND-Gate-2-Sigmoid-1.html#937" class="Bound">i₀</a> <a id="1205" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1208" href="Amethyst.Prelude.html#988" class="Function">1·0f</a><a id="1212" class="Symbol">)</a> <a id="1214" href="Amethyst.Prelude.html#856" class="Function Operator">∧</a> <a id="1216" class="Symbol">(</a><a id="1217" href="AND-Gate-2-Sigmoid-1.html#942" class="Bound">i₁</a> <a id="1220" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1223" href="Amethyst.Prelude.html#988" class="Function">1·0f</a><a id="1227" class="Symbol">))</a> <a id="1230" href="Amethyst.Prelude.html#852" class="Function Operator">⇒</a> <a id="1232" class="Symbol">(</a><a id="1233" href="AND-Gate-2-Sigmoid-1.html#955" class="Bound">o₀</a> <a id="1236" href="Amethyst.Prelude.html#931" class="Function Operator">==</a> <a id="1239" href="Amethyst.Prelude.html#988" class="Function">1·0f</a><a id="1243" class="Symbol">))</a>
    <a id="1250" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="1252" href="SMT.Script.Base.html#7840" class="InductiveConstructor">check-sat</a>
    <a id="1266" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="1268" href="SMT.Script.Base.html#8084" class="InductiveConstructor">[]</a>

<a id="1272" href="AND-Gate-2-Sigmoid-1.html#1272" class="Function">_</a> <a id="1274" class="Symbol">:</a> <a id="1276" href="SMT.Backend.Z3.html#1335" class="Macro">z3</a> <a id="1279" href="AND-Gate-2-Sigmoid-1.html#784" class="Function">script</a> <a id="1286" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1288" href="SMT.Script.Base.html#4886" class="InductiveConstructor">sat</a> <a id="1292" href="SMT.Script.Base.html#6135" class="InductiveConstructor Operator">∷</a> <a id="1294" href="SMT.Script.Base.html#6116" class="InductiveConstructor">[]</a>
<a id="1297" class="Symbol">_</a> <a id="1299" class="Symbol">=</a> <a id="1301" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="1307" href="AND-Gate-2-Sigmoid-1.html#1307" class="Function">_</a> <a id="1309" class="Symbol">:</a> <a id="1311" href="Amethyst.Network.As.Float.html#1927" class="Function">evalNetwork</a> <a id="1323" href="AND-Gate-2-Sigmoid-1.html#736" class="Function">model</a> <a id="1329" class="Symbol">(</a><a id="1330" class="Number">0.0</a> <a id="1334" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1336" class="Number">0.0</a> <a id="1340" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1342" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1344" class="Symbol">)</a> <a id="1346" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1348" class="Symbol">(</a><a id="1349" class="Number">0.0</a> <a id="1353" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1355" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1357" class="Symbol">)</a>
<a id="1359" class="Symbol">_</a> <a id="1361" class="Symbol">=</a> <a id="1363" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1368" href="AND-Gate-2-Sigmoid-1.html#1368" class="Function">_</a> <a id="1370" class="Symbol">:</a> <a id="1372" href="Amethyst.Network.As.Float.html#1927" class="Function">evalNetwork</a> <a id="1384" href="AND-Gate-2-Sigmoid-1.html#736" class="Function">model</a> <a id="1390" class="Symbol">(</a><a id="1391" class="Number">0.0</a> <a id="1395" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1397" class="Number">1.0</a> <a id="1401" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1403" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1405" class="Symbol">)</a> <a id="1407" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1409" class="Symbol">(</a><a id="1410" class="Number">0.0</a> <a id="1414" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1416" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1418" class="Symbol">)</a>
<a id="1420" class="Symbol">_</a> <a id="1422" class="Symbol">=</a> <a id="1424" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1429" href="AND-Gate-2-Sigmoid-1.html#1429" class="Function">_</a> <a id="1431" class="Symbol">:</a> <a id="1433" href="Amethyst.Network.As.Float.html#1927" class="Function">evalNetwork</a> <a id="1445" href="AND-Gate-2-Sigmoid-1.html#736" class="Function">model</a> <a id="1451" class="Symbol">(</a><a id="1452" class="Number">1.0</a> <a id="1456" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1458" class="Number">0.0</a> <a id="1462" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1464" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1466" class="Symbol">)</a> <a id="1468" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1470" class="Symbol">(</a><a id="1471" class="Number">0.0</a> <a id="1475" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1477" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1479" class="Symbol">)</a>
<a id="1481" class="Symbol">_</a> <a id="1483" class="Symbol">=</a> <a id="1485" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1490" href="AND-Gate-2-Sigmoid-1.html#1490" class="Function">_</a> <a id="1492" class="Symbol">:</a> <a id="1494" href="Amethyst.Network.As.Float.html#1927" class="Function">evalNetwork</a> <a id="1506" href="AND-Gate-2-Sigmoid-1.html#736" class="Function">model</a> <a id="1512" class="Symbol">(</a><a id="1513" class="Number">1.0</a> <a id="1517" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1519" class="Number">1.0</a> <a id="1523" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1525" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1527" class="Symbol">)</a> <a id="1529" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1531" class="Symbol">(</a><a id="1532" class="Number">1.0</a> <a id="1536" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1538" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1540" class="Symbol">)</a>
<a id="1542" class="Symbol">_</a> <a id="1544" class="Symbol">=</a> <a id="1546" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre></body></html>