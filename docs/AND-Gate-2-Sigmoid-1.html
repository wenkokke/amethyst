<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>AND-Gate-2-Sigmoid-1</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst Models: Examples of Neural Network Verification in Agda</a>
<a id="150" class="Comment">--</a>
<a id="153" class="Comment">-- This module contains an example use of Amethyst, to verify the correctness of</a>
<a id="234" class="Comment">-- a simple AND-gate network.</a>
<a id="264" class="Comment">--------------------------------------------------------------------------------</a>

<a id="346" class="Symbol">{-#</a> <a id="350" class="Keyword">OPTIONS</a> <a id="358" class="Pragma">--allow-exec</a> <a id="371" class="Symbol">#-}</a>

<a id="376" class="Keyword">module</a> <a id="383" href="AND-Gate-2-Sigmoid-1.html" class="Module">AND-Gate-2-Sigmoid-1</a> <a id="404" class="Keyword">where</a>

<a id="411" class="Keyword">open</a> <a id="416" class="Keyword">import</a> <a id="423" href="Amethyst.Prelude.html" class="Module">Amethyst.Prelude</a>
<a id="440" class="Keyword">open</a> <a id="445" class="Keyword">import</a> <a id="452" href="Data.Float.html" class="Module">Data.Float</a>
<a id="463" class="Keyword">open</a> <a id="468" class="Keyword">import</a> <a id="475" href="Function.html" class="Module">Function</a> <a id="484" class="Keyword">using</a> <a id="490" class="Symbol">(</a><a id="491" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="494" class="Symbol">)</a>
<a id="496" class="Keyword">open</a> <a id="501" class="Keyword">import</a> <a id="508" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="546" class="Keyword">using</a> <a id="552" class="Symbol">(</a><a id="553" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="556" class="Symbol">;</a> <a id="558" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="562" class="Symbol">)</a>

<a id="layer"></a><a id="565" href="AND-Gate-2-Sigmoid-1.html#565" class="Function">layer</a> <a id="571" class="Symbol">:</a> <a id="573" href="Amethyst.Network.Base.html#943" class="Record">Layer</a> <a id="579" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="585" class="Number">2</a> <a id="587" class="Number">1</a>
<a id="589" href="AND-Gate-2-Sigmoid-1.html#565" class="Function">layer</a> <a id="595" class="Symbol">=</a> <a id="597" class="Keyword">record</a>
  <a id="606" class="Symbol">{</a> <a id="608" href="Amethyst.Network.Base.html#1032" class="Field">weights</a>    <a id="619" class="Symbol">=</a> <a id="621" href="Data.Vec.Base.html#5711" class="Function Operator">[</a> <a id="623" class="Number">5.0e8</a> <a id="629" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
               <a id="646" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="648" href="Data.Vec.Base.html#5711" class="Function Operator">[</a> <a id="650" class="Number">5.0e8</a> <a id="656" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
               <a id="673" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="675" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a>
  <a id="680" class="Symbol">;</a> <a id="682" href="Amethyst.Network.Base.html#1076" class="Field">biases</a>     <a id="693" class="Symbol">=</a> <a id="695" href="Data.Vec.Base.html#5711" class="Function Operator">[</a> <a id="697" class="Number">-7.5e8</a> <a id="704" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
  <a id="708" class="Symbol">;</a> <a id="710" href="Amethyst.Network.Base.html#1004" class="Field">activation</a> <a id="721" class="Symbol">=</a> <a id="723" href="Amethyst.Network.Base.html#868" class="InductiveConstructor">sigmoid</a>
  <a id="733" class="Symbol">}</a>

<a id="model"></a><a id="736" href="AND-Gate-2-Sigmoid-1.html#736" class="Function">model</a> <a id="742" class="Symbol">:</a> <a id="744" href="Amethyst.Network.Base.html#1123" class="Datatype">Network</a> <a id="752" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="758" class="Number">2</a> <a id="760" class="Number">1</a> <a id="762" class="Number">1</a>
<a id="764" href="AND-Gate-2-Sigmoid-1.html#736" class="Function">model</a> <a id="770" class="Symbol">=</a> <a id="772" href="AND-Gate-2-Sigmoid-1.html#565" class="Function">layer</a> <a id="778" href="Amethyst.Network.Base.html#1225" class="InductiveConstructor Operator">∷</a> <a id="780" href="Amethyst.Network.Base.html#1191" class="InductiveConstructor">[]</a>

<a id="script"></a><a id="784" href="AND-Gate-2-Sigmoid-1.html#784" class="Function">script</a> <a id="791" class="Symbol">:</a> <a id="793" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="800" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="803" class="Symbol">(</a><a id="804" href="SMT.Theories.Reals.html#1045" class="InductiveConstructor">REAL</a> <a id="809" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="811" href="SMT.Theories.Reals.html#1045" class="InductiveConstructor">REAL</a> <a id="816" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="818" href="SMT.Theories.Reals.html#1045" class="InductiveConstructor">REAL</a> <a id="823" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="825" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="827" class="Symbol">)</a> <a id="829" class="Symbol">(</a><a id="830" href="SMT.Script.Base.html#4648" class="InductiveConstructor">SAT</a> <a id="834" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="836" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="838" class="Symbol">)</a>
<a id="840" href="AND-Gate-2-Sigmoid-1.html#784" class="Function">script</a> <a id="847" class="Symbol">=</a> <a id="849" href="Amethyst.Network.As.Schmitty.html#4955" class="Function">withReflectedNetworkAsScript</a> <a id="878" href="AND-Gate-2-Sigmoid-1.html#736" class="Function">model</a> <a id="884" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="886" class="Symbol">λ</a> <a id="888" class="Keyword">where</a>
  <a id="896" class="Symbol">(</a><a id="897" href="AND-Gate-2-Sigmoid-1.html#897" class="Bound">i₀</a> <a id="900" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="902" href="AND-Gate-2-Sigmoid-1.html#902" class="Bound">i₁</a> <a id="905" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="907" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="909" class="Symbol">)</a> <a id="911" class="Symbol">(</a><a id="912" href="AND-Gate-2-Sigmoid-1.html#912" class="Bound">o₀</a> <a id="915" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="917" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="919" class="Symbol">)</a>
    <a id="925" class="Symbol">→</a> <a id="927" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a> <a id="934" class="Symbol">(((</a><a id="937" href="AND-Gate-2-Sigmoid-1.html#897" class="Bound">i₀</a> <a id="940" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="943" href="Amethyst.Prelude.html#977" class="Function">0·0f</a><a id="947" class="Symbol">)</a> <a id="949" href="Amethyst.Prelude.html#850" class="Function Operator">∧</a> <a id="951" class="Symbol">(</a><a id="952" href="AND-Gate-2-Sigmoid-1.html#902" class="Bound">i₁</a> <a id="955" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="958" href="Amethyst.Prelude.html#977" class="Function">0·0f</a><a id="962" class="Symbol">))</a> <a id="965" href="Amethyst.Prelude.html#846" class="Function Operator">⇒</a> <a id="967" class="Symbol">(</a><a id="968" href="AND-Gate-2-Sigmoid-1.html#912" class="Bound">o₀</a> <a id="971" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="974" href="Amethyst.Prelude.html#977" class="Function">0·0f</a><a id="978" class="Symbol">))</a>
    <a id="985" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="987" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a> <a id="994" class="Symbol">(((</a><a id="997" href="AND-Gate-2-Sigmoid-1.html#897" class="Bound">i₀</a> <a id="1000" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="1003" href="Amethyst.Prelude.html#977" class="Function">0·0f</a><a id="1007" class="Symbol">)</a> <a id="1009" href="Amethyst.Prelude.html#850" class="Function Operator">∧</a> <a id="1011" class="Symbol">(</a><a id="1012" href="AND-Gate-2-Sigmoid-1.html#902" class="Bound">i₁</a> <a id="1015" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="1018" href="Amethyst.Prelude.html#982" class="Function">1·0f</a><a id="1022" class="Symbol">))</a> <a id="1025" href="Amethyst.Prelude.html#846" class="Function Operator">⇒</a> <a id="1027" class="Symbol">(</a><a id="1028" href="AND-Gate-2-Sigmoid-1.html#912" class="Bound">o₀</a> <a id="1031" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="1034" href="Amethyst.Prelude.html#977" class="Function">0·0f</a><a id="1038" class="Symbol">))</a>
    <a id="1045" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="1047" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a> <a id="1054" class="Symbol">(((</a><a id="1057" href="AND-Gate-2-Sigmoid-1.html#897" class="Bound">i₀</a> <a id="1060" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="1063" href="Amethyst.Prelude.html#982" class="Function">1·0f</a><a id="1067" class="Symbol">)</a> <a id="1069" href="Amethyst.Prelude.html#850" class="Function Operator">∧</a> <a id="1071" class="Symbol">(</a><a id="1072" href="AND-Gate-2-Sigmoid-1.html#902" class="Bound">i₁</a> <a id="1075" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="1078" href="Amethyst.Prelude.html#977" class="Function">0·0f</a><a id="1082" class="Symbol">))</a> <a id="1085" href="Amethyst.Prelude.html#846" class="Function Operator">⇒</a> <a id="1087" class="Symbol">(</a><a id="1088" href="AND-Gate-2-Sigmoid-1.html#912" class="Bound">o₀</a> <a id="1091" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="1094" href="Amethyst.Prelude.html#977" class="Function">0·0f</a><a id="1098" class="Symbol">))</a>
    <a id="1105" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="1107" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a> <a id="1114" class="Symbol">(((</a><a id="1117" href="AND-Gate-2-Sigmoid-1.html#897" class="Bound">i₀</a> <a id="1120" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="1123" href="Amethyst.Prelude.html#982" class="Function">1·0f</a><a id="1127" class="Symbol">)</a> <a id="1129" href="Amethyst.Prelude.html#850" class="Function Operator">∧</a> <a id="1131" class="Symbol">(</a><a id="1132" href="AND-Gate-2-Sigmoid-1.html#902" class="Bound">i₁</a> <a id="1135" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="1138" href="Amethyst.Prelude.html#982" class="Function">1·0f</a><a id="1142" class="Symbol">))</a> <a id="1145" href="Amethyst.Prelude.html#846" class="Function Operator">⇒</a> <a id="1147" class="Symbol">(</a><a id="1148" href="AND-Gate-2-Sigmoid-1.html#912" class="Bound">o₀</a> <a id="1151" href="Amethyst.Prelude.html#925" class="Function Operator">==</a> <a id="1154" href="Amethyst.Prelude.html#982" class="Function">1·0f</a><a id="1158" class="Symbol">))</a>
    <a id="1165" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="1167" href="SMT.Script.Base.html#7840" class="InductiveConstructor">check-sat</a>
    <a id="1181" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="1183" href="SMT.Script.Base.html#8084" class="InductiveConstructor">[]</a>

<a id="1187" href="AND-Gate-2-Sigmoid-1.html#1187" class="Function">_</a> <a id="1189" class="Symbol">:</a> <a id="1191" href="SMT.Backend.Z3.html#1335" class="Macro">z3</a> <a id="1194" href="AND-Gate-2-Sigmoid-1.html#784" class="Function">script</a> <a id="1201" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1203" href="SMT.Script.Base.html#4886" class="InductiveConstructor">sat</a> <a id="1207" href="SMT.Script.Base.html#6135" class="InductiveConstructor Operator">∷</a> <a id="1209" href="SMT.Script.Base.html#6116" class="InductiveConstructor">[]</a>
<a id="1212" class="Symbol">_</a> <a id="1214" class="Symbol">=</a> <a id="1216" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre></body></html>