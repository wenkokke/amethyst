<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.Network.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst: Neural Network Verification in Agda</a>
<a id="131" class="Comment">--</a>
<a id="134" class="Comment">-- This module exports the basic types for representing neural networks.</a>
<a id="207" class="Comment">--</a>
<a id="210" class="Comment">-- Exports:</a>
<a id="222" class="Comment">--</a>
<a id="225" class="Comment">--   - Activation (linear; relu; sigmoid; softmax; tanh)</a>
<a id="282" class="Comment">--   - Layer      (activation; weights; biases)</a>
<a id="330" class="Comment">--   - Network    ([]; _∷_)</a>
<a id="358" class="Comment">--</a>
<a id="361" class="Comment">--------------------------------------------------------------------------------</a>

<a id="443" class="Keyword">module</a> <a id="450" href="Amethyst.Network.Base.html" class="Module">Amethyst.Network.Base</a> <a id="472" class="Keyword">where</a>

<a id="479" class="Keyword">import</a> <a id="486" href="Amethyst.Data.Vec.html" class="Module">Amethyst.Data.Vec</a> <a id="504" class="Symbol">as</a> <a id="507" class="Module">Vec</a>

<a id="512" class="Keyword">open</a> <a id="517" class="Keyword">import</a> <a id="524" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="538" class="Symbol">as</a> <a id="541" class="Module">Fin</a> <a id="545" class="Keyword">using</a> <a id="551" class="Symbol">(</a><a id="552" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="555" class="Symbol">)</a>
<a id="557" class="Keyword">open</a> <a id="562" class="Keyword">import</a> <a id="569" href="Data.Float.html" class="Module">Data.Float</a> <a id="580" class="Symbol">as</a> <a id="583" class="Module">Float</a> <a id="589" class="Keyword">using</a> <a id="595" class="Symbol">(</a><a id="596" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="601" class="Symbol">)</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="629" class="Symbol">as</a> <a id="632" class="Module">Nat</a> <a id="636" class="Keyword">using</a> <a id="642" class="Symbol">(</a><a id="643" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="644" class="Symbol">;</a> <a id="646" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="649" class="Symbol">;</a> <a id="651" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="655" class="Symbol">)</a>
<a id="657" class="Keyword">open</a> <a id="662" class="Keyword">import</a> <a id="669" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="683" class="Symbol">as</a> <a id="686" class="Module">Vec</a> <a id="690" class="Keyword">using</a> <a id="696" class="Symbol">(</a><a id="697" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="700" class="Symbol">;</a> <a id="702" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="704" class="Symbol">;</a> <a id="706" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="709" class="Symbol">)</a>
<a id="711" class="Keyword">open</a> <a id="716" class="Keyword">import</a> <a id="723" href="Function.html" class="Module">Function</a> <a id="732" class="Keyword">using</a> <a id="738" class="Symbol">(</a><a id="739" href="Function.Base.html#615" class="Function">id</a><a id="741" class="Symbol">)</a>

<a id="744" class="Keyword">private</a>
  <a id="754" class="Keyword">variable</a>
    <a id="767" href="Amethyst.Network.Base.html#767" class="Generalizable">A</a> <a id="769" class="Symbol">:</a> <a id="771" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="779" href="Amethyst.Network.Base.html#779" class="Generalizable">n</a> <a id="781" class="Symbol">:</a> <a id="783" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="789" href="Amethyst.Network.Base.html#789" class="Generalizable">hidden</a>  <a id="797" class="Symbol">:</a> <a id="799" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="805" href="Amethyst.Network.Base.html#805" class="Generalizable">layers</a>  <a id="813" class="Symbol">:</a> <a id="815" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="818" class="Keyword">data</a> <a id="Activation"></a><a id="823" href="Amethyst.Network.Base.html#823" class="Datatype">Activation</a> <a id="834" class="Symbol">:</a> <a id="836" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="840" class="Keyword">where</a>
  <a id="Activation.linear"></a><a id="848" href="Amethyst.Network.Base.html#848" class="InductiveConstructor">linear</a>  <a id="856" class="Symbol">:</a> <a id="858" href="Amethyst.Network.Base.html#823" class="Datatype">Activation</a>
  <a id="Activation.relu"></a><a id="871" href="Amethyst.Network.Base.html#871" class="InductiveConstructor">relu</a>    <a id="879" class="Symbol">:</a> <a id="881" href="Amethyst.Network.Base.html#823" class="Datatype">Activation</a>
  <a id="Activation.sigmoid"></a><a id="894" href="Amethyst.Network.Base.html#894" class="InductiveConstructor">sigmoid</a> <a id="902" class="Symbol">:</a> <a id="904" href="Amethyst.Network.Base.html#823" class="Datatype">Activation</a>
  <a id="Activation.softmax"></a><a id="917" href="Amethyst.Network.Base.html#917" class="InductiveConstructor">softmax</a> <a id="925" class="Symbol">:</a> <a id="927" href="Amethyst.Network.Base.html#823" class="Datatype">Activation</a>
  <a id="Activation.tanh"></a><a id="940" href="Amethyst.Network.Base.html#940" class="InductiveConstructor">tanh</a>    <a id="948" class="Symbol">:</a> <a id="950" href="Amethyst.Network.Base.html#823" class="Datatype">Activation</a>

<a id="962" class="Keyword">record</a> <a id="Layer"></a><a id="969" href="Amethyst.Network.Base.html#969" class="Record">Layer</a> <a id="975" class="Symbol">(</a><a id="976" href="Amethyst.Network.Base.html#976" class="Bound">A</a> <a id="978" class="Symbol">:</a> <a id="980" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="983" class="Symbol">)</a> <a id="985" class="Symbol">(</a><a id="986" href="Amethyst.Network.Base.html#986" class="Bound">inputs</a> <a id="993" href="Amethyst.Network.Base.html#993" class="Bound">outputs</a> <a id="1001" class="Symbol">:</a> <a id="1003" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1004" class="Symbol">)</a> <a id="1006" class="Symbol">:</a> <a id="1008" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1012" class="Keyword">where</a>
  <a id="1020" class="Keyword">field</a>
    <a id="Layer.activation"></a><a id="1030" href="Amethyst.Network.Base.html#1030" class="Field">activation</a> <a id="1041" class="Symbol">:</a> <a id="1043" href="Amethyst.Network.Base.html#823" class="Datatype">Activation</a>
    <a id="Layer.weights"></a><a id="1058" href="Amethyst.Network.Base.html#1058" class="Field">weights</a>    <a id="1069" class="Symbol">:</a> <a id="1071" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1075" class="Symbol">(</a><a id="1076" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1080" href="Amethyst.Network.Base.html#976" class="Bound">A</a> <a id="1082" href="Amethyst.Network.Base.html#993" class="Bound">outputs</a><a id="1089" class="Symbol">)</a> <a id="1091" href="Amethyst.Network.Base.html#986" class="Bound">inputs</a>
    <a id="Layer.biases"></a><a id="1102" href="Amethyst.Network.Base.html#1102" class="Field">biases</a>     <a id="1113" class="Symbol">:</a> <a id="1115" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1119" href="Amethyst.Network.Base.html#976" class="Bound">A</a> <a id="1121" href="Amethyst.Network.Base.html#993" class="Bound">outputs</a>

<a id="LayerSpec"></a><a id="1130" href="Amethyst.Network.Base.html#1130" class="Function">LayerSpec</a> <a id="1140" class="Symbol">:</a> <a id="1142" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1144" class="Symbol">→</a> <a id="1146" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1150" href="Amethyst.Network.Base.html#1130" class="Function">LayerSpec</a> <a id="1160" class="Symbol">=</a> <a id="1162" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1166" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="∣_₀∣"></a><a id="1169" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣_₀∣</a> <a id="1174" class="Symbol">:</a> <a id="1176" href="Amethyst.Network.Base.html#1130" class="Function">LayerSpec</a> <a id="1186" href="Amethyst.Network.Base.html#779" class="Generalizable">n</a> <a id="1188" class="Symbol">→</a> <a id="1190" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1192" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="1194" href="Amethyst.Network.Base.html#1194" class="Bound">xs</a> <a id="1197" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a> <a id="1200" class="Symbol">=</a> <a id="1202" href="Amethyst.Data.Vec.html#228" class="Function">Vec.first′</a> <a id="1213" href="Amethyst.Network.Base.html#1194" class="Bound">xs</a> <a id="1216" class="Number">0</a>

<a id="∣_ₙ∣"></a><a id="1219" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣_ₙ∣</a> <a id="1224" class="Symbol">:</a> <a id="1226" href="Amethyst.Network.Base.html#1130" class="Function">LayerSpec</a> <a id="1236" href="Amethyst.Network.Base.html#779" class="Generalizable">n</a> <a id="1238" class="Symbol">→</a> <a id="1240" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1242" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="1244" href="Amethyst.Network.Base.html#1244" class="Bound">xs</a> <a id="1247" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a> <a id="1250" class="Symbol">=</a> <a id="1252" href="Amethyst.Data.Vec.html#326" class="Function">Vec.last′</a> <a id="1262" href="Amethyst.Network.Base.html#1244" class="Bound">xs</a> <a id="1265" class="Number">0</a>

<a id="1268" class="Keyword">infixr</a> <a id="1275" class="Number">5</a> <a id="1277" href="Amethyst.Network.Base.html#1388" class="InductiveConstructor Operator">_∷_</a>

<a id="1282" class="Keyword">data</a> <a id="Network"></a><a id="1287" href="Amethyst.Network.Base.html#1287" class="Datatype">Network</a> <a id="1295" class="Symbol">(</a><a id="1296" href="Amethyst.Network.Base.html#1296" class="Bound">A</a> <a id="1298" class="Symbol">:</a> <a id="1300" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1303" class="Symbol">)</a> <a id="1305" class="Symbol">:</a> <a id="1307" class="Symbol">∀</a> <a id="1309" class="Symbol">{</a><a id="1310" href="Amethyst.Network.Base.html#1310" class="Bound">#layers</a> <a id="1318" class="Symbol">:</a> <a id="1320" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1321" class="Symbol">}</a> <a id="1323" class="Symbol">→</a> <a id="1325" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1329" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1331" href="Amethyst.Network.Base.html#1310" class="Bound">#layers</a> <a id="1339" class="Symbol">→</a> <a id="1341" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1345" class="Keyword">where</a>
  <a id="Network.[]"></a><a id="1353" href="Amethyst.Network.Base.html#1353" class="InductiveConstructor">[]</a>  <a id="1357" class="Symbol">:</a> <a id="1359" class="Symbol">∀</a> <a id="1361" class="Symbol">{</a><a id="1362" href="Amethyst.Network.Base.html#1362" class="Bound">n</a><a id="1363" class="Symbol">}</a> <a id="1365" class="Symbol">→</a> <a id="1367" href="Amethyst.Network.Base.html#1287" class="Datatype">Network</a> <a id="1375" href="Amethyst.Network.Base.html#1296" class="Bound">A</a> <a id="1377" class="Symbol">(</a><a id="1378" href="Amethyst.Network.Base.html#1362" class="Bound">n</a> <a id="1380" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1382" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1384" class="Symbol">)</a>
  <a id="Network._∷_"></a><a id="1388" href="Amethyst.Network.Base.html#1388" class="InductiveConstructor Operator">_∷_</a> <a id="1392" class="Symbol">:</a> <a id="1394" class="Symbol">∀</a> <a id="1396" class="Symbol">{</a><a id="1397" href="Amethyst.Network.Base.html#1397" class="Bound">n</a> <a id="1399" href="Amethyst.Network.Base.html#1399" class="Bound">|lᵢ|</a> <a id="1404" href="Amethyst.Network.Base.html#1404" class="Bound">|lᵢ₊₁|</a><a id="1410" class="Symbol">}</a> <a id="1412" class="Symbol">{</a><a id="1413" href="Amethyst.Network.Base.html#1413" class="Bound">xs</a> <a id="1416" class="Symbol">:</a> <a id="1418" href="Amethyst.Network.Base.html#1130" class="Function">LayerSpec</a> <a id="1428" href="Amethyst.Network.Base.html#1397" class="Bound">n</a><a id="1429" class="Symbol">}</a> <a id="1431" class="Symbol">→</a>
        <a id="1441" href="Amethyst.Network.Base.html#969" class="Record">Layer</a> <a id="1447" href="Amethyst.Network.Base.html#1296" class="Bound">A</a> <a id="1449" href="Amethyst.Network.Base.html#1399" class="Bound">|lᵢ|</a> <a id="1454" href="Amethyst.Network.Base.html#1404" class="Bound">|lᵢ₊₁|</a> <a id="1461" class="Symbol">→</a> <a id="1463" href="Amethyst.Network.Base.html#1287" class="Datatype">Network</a> <a id="1471" href="Amethyst.Network.Base.html#1296" class="Bound">A</a> <a id="1473" class="Symbol">(</a><a id="1474" href="Amethyst.Network.Base.html#1404" class="Bound">|lᵢ₊₁|</a> <a id="1481" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1483" href="Amethyst.Network.Base.html#1413" class="Bound">xs</a><a id="1485" class="Symbol">)</a> <a id="1487" class="Symbol">→</a> <a id="1489" href="Amethyst.Network.Base.html#1287" class="Datatype">Network</a> <a id="1497" href="Amethyst.Network.Base.html#1296" class="Bound">A</a> <a id="1499" class="Symbol">(</a><a id="1500" href="Amethyst.Network.Base.html#1399" class="Bound">|lᵢ|</a> <a id="1505" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1507" href="Amethyst.Network.Base.html#1404" class="Bound">|lᵢ₊₁|</a> <a id="1514" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1516" href="Amethyst.Network.Base.html#1413" class="Bound">xs</a><a id="1518" class="Symbol">)</a>
</pre></body></html>