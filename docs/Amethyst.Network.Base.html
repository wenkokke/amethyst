<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.Network.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst: Neural Network Verification in Agda</a>
<a id="131" class="Comment">--</a>
<a id="134" class="Comment">-- This module exports the basic types for representing neural networks.</a>
<a id="207" class="Comment">--</a>
<a id="210" class="Comment">-- Exports:</a>
<a id="222" class="Comment">--</a>
<a id="225" class="Comment">--   - Activation (linear; relu; sigmoid; softmax; tanh)</a>
<a id="282" class="Comment">--   - Layer      (activation; weights; biases)</a>
<a id="330" class="Comment">--   - Network    ([]; _∷_)</a>
<a id="358" class="Comment">--</a>
<a id="361" class="Comment">--------------------------------------------------------------------------------</a>
<a id="442" class="Keyword">module</a> <a id="449" href="Amethyst.Network.Base.html" class="Module">Amethyst.Network.Base</a> <a id="471" class="Keyword">where</a>

<a id="478" class="Keyword">open</a> <a id="483" class="Keyword">import</a> <a id="490" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="499" class="Symbol">as</a> <a id="502" class="Module">Fin</a> <a id="506" class="Keyword">using</a> <a id="512" class="Symbol">(</a><a id="513" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="516" class="Symbol">)</a>
<a id="518" class="Keyword">open</a> <a id="523" class="Keyword">import</a> <a id="530" href="Data.Float.html" class="Module">Data.Float</a> <a id="541" class="Symbol">as</a> <a id="544" class="Module">Float</a> <a id="550" class="Keyword">using</a> <a id="556" class="Symbol">(</a><a id="557" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="562" class="Symbol">)</a>
<a id="564" class="Keyword">open</a> <a id="569" class="Keyword">import</a> <a id="576" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="585" class="Symbol">as</a> <a id="588" class="Module">Nat</a> <a id="592" class="Keyword">using</a> <a id="598" class="Symbol">(</a><a id="599" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="600" class="Symbol">;</a> <a id="602" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="605" class="Symbol">;</a> <a id="607" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="611" class="Symbol">)</a>
<a id="613" class="Keyword">open</a> <a id="618" class="Keyword">import</a> <a id="625" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="634" class="Symbol">as</a> <a id="637" class="Module">Vec</a> <a id="641" class="Keyword">using</a> <a id="647" class="Symbol">(</a><a id="648" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="651" class="Symbol">)</a>
<a id="653" class="Keyword">open</a> <a id="658" class="Keyword">import</a> <a id="665" href="Function.html" class="Module">Function</a> <a id="674" class="Keyword">using</a> <a id="680" class="Symbol">(</a><a id="681" href="Function.Base.html#615" class="Function">id</a><a id="683" class="Symbol">)</a>

<a id="686" class="Keyword">private</a>
  <a id="696" class="Keyword">variable</a>
    <a id="709" href="Amethyst.Network.Base.html#709" class="Generalizable">A</a> <a id="711" class="Symbol">:</a> <a id="713" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="721" href="Amethyst.Network.Base.html#721" class="Generalizable">n</a> <a id="723" class="Symbol">:</a> <a id="725" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="731" href="Amethyst.Network.Base.html#731" class="Generalizable">inputs</a>  <a id="739" class="Symbol">:</a> <a id="741" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="747" href="Amethyst.Network.Base.html#747" class="Generalizable">hidden</a>  <a id="755" class="Symbol">:</a> <a id="757" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="763" href="Amethyst.Network.Base.html#763" class="Generalizable">outputs</a> <a id="771" class="Symbol">:</a> <a id="773" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="779" href="Amethyst.Network.Base.html#779" class="Generalizable">layers</a>  <a id="787" class="Symbol">:</a> <a id="789" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="792" class="Keyword">data</a> <a id="Activation"></a><a id="797" href="Amethyst.Network.Base.html#797" class="Datatype">Activation</a> <a id="808" class="Symbol">:</a> <a id="810" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="814" class="Keyword">where</a>
  <a id="Activation.linear"></a><a id="822" href="Amethyst.Network.Base.html#822" class="InductiveConstructor">linear</a>  <a id="830" class="Symbol">:</a> <a id="832" href="Amethyst.Network.Base.html#797" class="Datatype">Activation</a>
  <a id="Activation.relu"></a><a id="845" href="Amethyst.Network.Base.html#845" class="InductiveConstructor">relu</a>    <a id="853" class="Symbol">:</a> <a id="855" href="Amethyst.Network.Base.html#797" class="Datatype">Activation</a>
  <a id="Activation.sigmoid"></a><a id="868" href="Amethyst.Network.Base.html#868" class="InductiveConstructor">sigmoid</a> <a id="876" class="Symbol">:</a> <a id="878" href="Amethyst.Network.Base.html#797" class="Datatype">Activation</a>
  <a id="Activation.softmax"></a><a id="891" href="Amethyst.Network.Base.html#891" class="InductiveConstructor">softmax</a> <a id="899" class="Symbol">:</a> <a id="901" href="Amethyst.Network.Base.html#797" class="Datatype">Activation</a>
  <a id="Activation.tanh"></a><a id="914" href="Amethyst.Network.Base.html#914" class="InductiveConstructor">tanh</a>    <a id="922" class="Symbol">:</a> <a id="924" href="Amethyst.Network.Base.html#797" class="Datatype">Activation</a>

<a id="936" class="Keyword">record</a> <a id="Layer"></a><a id="943" href="Amethyst.Network.Base.html#943" class="Record">Layer</a> <a id="949" class="Symbol">(</a><a id="950" href="Amethyst.Network.Base.html#950" class="Bound">A</a> <a id="952" class="Symbol">:</a> <a id="954" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="957" class="Symbol">)</a> <a id="959" class="Symbol">(</a><a id="960" href="Amethyst.Network.Base.html#960" class="Bound">inputs</a> <a id="967" href="Amethyst.Network.Base.html#967" class="Bound">outputs</a> <a id="975" class="Symbol">:</a> <a id="977" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="978" class="Symbol">)</a> <a id="980" class="Symbol">:</a> <a id="982" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="986" class="Keyword">where</a>
  <a id="994" class="Keyword">field</a>
    <a id="Layer.activation"></a><a id="1004" href="Amethyst.Network.Base.html#1004" class="Field">activation</a> <a id="1015" class="Symbol">:</a> <a id="1017" href="Amethyst.Network.Base.html#797" class="Datatype">Activation</a>
    <a id="Layer.weights"></a><a id="1032" href="Amethyst.Network.Base.html#1032" class="Field">weights</a>    <a id="1043" class="Symbol">:</a> <a id="1045" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1049" class="Symbol">(</a><a id="1050" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1054" href="Amethyst.Network.Base.html#950" class="Bound">A</a> <a id="1056" href="Amethyst.Network.Base.html#967" class="Bound">outputs</a><a id="1063" class="Symbol">)</a> <a id="1065" href="Amethyst.Network.Base.html#960" class="Bound">inputs</a>
    <a id="Layer.biases"></a><a id="1076" href="Amethyst.Network.Base.html#1076" class="Field">biases</a>     <a id="1087" class="Symbol">:</a> <a id="1089" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1093" href="Amethyst.Network.Base.html#950" class="Bound">A</a> <a id="1095" href="Amethyst.Network.Base.html#967" class="Bound">outputs</a>

<a id="1104" class="Keyword">infixr</a> <a id="1111" class="Number">5</a> <a id="1113" href="Amethyst.Network.Base.html#1225" class="InductiveConstructor Operator">_∷_</a>

<a id="1118" class="Keyword">data</a> <a id="Network"></a><a id="1123" href="Amethyst.Network.Base.html#1123" class="Datatype">Network</a> <a id="1131" class="Symbol">(</a><a id="1132" href="Amethyst.Network.Base.html#1132" class="Bound">A</a> <a id="1134" class="Symbol">:</a> <a id="1136" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1139" class="Symbol">)</a> <a id="1141" class="Symbol">(</a><a id="1142" href="Amethyst.Network.Base.html#1142" class="Bound">inputs</a> <a id="1149" class="Symbol">:</a> <a id="1151" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1152" class="Symbol">)</a> <a id="1154" class="Symbol">:</a> <a id="1156" class="Symbol">(</a><a id="1157" href="Amethyst.Network.Base.html#1157" class="Bound">outputs</a> <a id="1165" href="Amethyst.Network.Base.html#1165" class="Bound">layers</a> <a id="1172" class="Symbol">:</a> <a id="1174" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1175" class="Symbol">)</a> <a id="1177" class="Symbol">→</a> <a id="1179" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1183" class="Keyword">where</a>
  <a id="Network.[]"></a><a id="1191" href="Amethyst.Network.Base.html#1191" class="InductiveConstructor">[]</a>  <a id="1195" class="Symbol">:</a> <a id="1197" href="Amethyst.Network.Base.html#1123" class="Datatype">Network</a> <a id="1205" href="Amethyst.Network.Base.html#1132" class="Bound">A</a> <a id="1207" href="Amethyst.Network.Base.html#1142" class="Bound">inputs</a> <a id="1214" href="Amethyst.Network.Base.html#1142" class="Bound">inputs</a> <a id="1221" class="Number">0</a>
  <a id="Network._∷_"></a><a id="1225" href="Amethyst.Network.Base.html#1225" class="InductiveConstructor Operator">_∷_</a> <a id="1229" class="Symbol">:</a> <a id="1231" href="Amethyst.Network.Base.html#943" class="Record">Layer</a> <a id="1237" href="Amethyst.Network.Base.html#1132" class="Bound">A</a> <a id="1239" href="Amethyst.Network.Base.html#1142" class="Bound">inputs</a> <a id="1246" href="Amethyst.Network.Base.html#747" class="Generalizable">hidden</a> <a id="1253" class="Symbol">→</a> <a id="1255" href="Amethyst.Network.Base.html#1123" class="Datatype">Network</a> <a id="1263" href="Amethyst.Network.Base.html#1132" class="Bound">A</a> <a id="1265" href="Amethyst.Network.Base.html#747" class="Generalizable">hidden</a> <a id="1272" href="Amethyst.Network.Base.html#763" class="Generalizable">outputs</a> <a id="1280" href="Amethyst.Network.Base.html#779" class="Generalizable">layers</a> <a id="1287" class="Symbol">→</a> <a id="1289" href="Amethyst.Network.Base.html#1123" class="Datatype">Network</a> <a id="1297" href="Amethyst.Network.Base.html#1132" class="Bound">A</a> <a id="1299" href="Amethyst.Network.Base.html#1142" class="Bound">inputs</a> <a id="1306" href="Amethyst.Network.Base.html#763" class="Generalizable">outputs</a> <a id="1314" class="Symbol">(</a><a id="1315" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1319" href="Amethyst.Network.Base.html#779" class="Generalizable">layers</a><a id="1325" class="Symbol">)</a>
</pre></body></html>