<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.Network.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- This module defines the basic datatypes for representing neural networks.</a>
<a id="78" class="Comment">--</a>
<a id="81" class="Comment">-- Exports:</a>
<a id="93" class="Comment">--</a>
<a id="96" class="Comment">--   - Activation (linear; relu; sigmoid; softmax; tanh)</a>
<a id="153" class="Comment">--   - Layer      (activation; weights; biases)</a>
<a id="201" class="Comment">--   - Network    ([]; _∷_)</a>
<a id="229" class="Comment">--</a>
<a id="232" class="Keyword">module</a> <a id="239" href="Amethyst.Network.Base.html" class="Module">Amethyst.Network.Base</a> <a id="261" class="Keyword">where</a>

<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="289" class="Symbol">as</a> <a id="292" class="Module">Fin</a> <a id="296" class="Keyword">using</a> <a id="302" class="Symbol">(</a><a id="303" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="306" class="Symbol">)</a>
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Data.Float.html" class="Module">Data.Float</a> <a id="331" class="Symbol">as</a> <a id="334" class="Module">Float</a> <a id="340" class="Keyword">using</a> <a id="346" class="Symbol">(</a><a id="347" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="352" class="Symbol">)</a>
<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="375" class="Symbol">as</a> <a id="378" class="Module">Nat</a> <a id="382" class="Keyword">using</a> <a id="388" class="Symbol">(</a><a id="389" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="390" class="Symbol">;</a> <a id="392" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="395" class="Symbol">;</a> <a id="397" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="401" class="Symbol">)</a>
<a id="403" class="Keyword">open</a> <a id="408" class="Keyword">import</a> <a id="415" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="424" class="Symbol">as</a> <a id="427" class="Module">Vec</a> <a id="431" class="Keyword">using</a> <a id="437" class="Symbol">(</a><a id="438" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="441" class="Symbol">)</a>
<a id="443" class="Keyword">open</a> <a id="448" class="Keyword">import</a> <a id="455" href="Function.html" class="Module">Function</a> <a id="464" class="Keyword">using</a> <a id="470" class="Symbol">(</a><a id="471" href="Function.Base.html#615" class="Function">id</a><a id="473" class="Symbol">)</a>

<a id="476" class="Keyword">private</a>
  <a id="486" class="Keyword">variable</a>
    <a id="499" href="Amethyst.Network.Base.html#499" class="Generalizable">A</a> <a id="501" class="Symbol">:</a> <a id="503" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="511" href="Amethyst.Network.Base.html#511" class="Generalizable">n</a> <a id="513" class="Symbol">:</a> <a id="515" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="521" href="Amethyst.Network.Base.html#521" class="Generalizable">inputs</a>  <a id="529" class="Symbol">:</a> <a id="531" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="537" href="Amethyst.Network.Base.html#537" class="Generalizable">hidden</a>  <a id="545" class="Symbol">:</a> <a id="547" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="553" href="Amethyst.Network.Base.html#553" class="Generalizable">outputs</a> <a id="561" class="Symbol">:</a> <a id="563" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="569" href="Amethyst.Network.Base.html#569" class="Generalizable">layers</a>  <a id="577" class="Symbol">:</a> <a id="579" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="582" class="Keyword">data</a> <a id="Activation"></a><a id="587" href="Amethyst.Network.Base.html#587" class="Datatype">Activation</a> <a id="598" class="Symbol">:</a> <a id="600" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="604" class="Keyword">where</a>
  <a id="Activation.linear"></a><a id="612" href="Amethyst.Network.Base.html#612" class="InductiveConstructor">linear</a>  <a id="620" class="Symbol">:</a> <a id="622" href="Amethyst.Network.Base.html#587" class="Datatype">Activation</a>
  <a id="Activation.relu"></a><a id="635" href="Amethyst.Network.Base.html#635" class="InductiveConstructor">relu</a>    <a id="643" class="Symbol">:</a> <a id="645" href="Amethyst.Network.Base.html#587" class="Datatype">Activation</a>
  <a id="Activation.sigmoid"></a><a id="658" href="Amethyst.Network.Base.html#658" class="InductiveConstructor">sigmoid</a> <a id="666" class="Symbol">:</a> <a id="668" href="Amethyst.Network.Base.html#587" class="Datatype">Activation</a>
  <a id="Activation.softmax"></a><a id="681" href="Amethyst.Network.Base.html#681" class="InductiveConstructor">softmax</a> <a id="689" class="Symbol">:</a> <a id="691" href="Amethyst.Network.Base.html#587" class="Datatype">Activation</a>
  <a id="Activation.tanh"></a><a id="704" href="Amethyst.Network.Base.html#704" class="InductiveConstructor">tanh</a>    <a id="712" class="Symbol">:</a> <a id="714" href="Amethyst.Network.Base.html#587" class="Datatype">Activation</a>

<a id="726" class="Keyword">record</a> <a id="Layer"></a><a id="733" href="Amethyst.Network.Base.html#733" class="Record">Layer</a> <a id="739" class="Symbol">(</a><a id="740" href="Amethyst.Network.Base.html#740" class="Bound">A</a> <a id="742" class="Symbol">:</a> <a id="744" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="747" class="Symbol">)</a> <a id="749" class="Symbol">(</a><a id="750" href="Amethyst.Network.Base.html#750" class="Bound">inputs</a> <a id="757" href="Amethyst.Network.Base.html#757" class="Bound">outputs</a> <a id="765" class="Symbol">:</a> <a id="767" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="768" class="Symbol">)</a> <a id="770" class="Symbol">:</a> <a id="772" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="776" class="Keyword">where</a>
  <a id="784" class="Keyword">field</a>
    <a id="Layer.activation"></a><a id="794" href="Amethyst.Network.Base.html#794" class="Field">activation</a> <a id="805" class="Symbol">:</a> <a id="807" href="Amethyst.Network.Base.html#587" class="Datatype">Activation</a>
    <a id="Layer.weights"></a><a id="822" href="Amethyst.Network.Base.html#822" class="Field">weights</a>    <a id="833" class="Symbol">:</a> <a id="835" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="839" class="Symbol">(</a><a id="840" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="844" href="Amethyst.Network.Base.html#740" class="Bound">A</a> <a id="846" href="Amethyst.Network.Base.html#757" class="Bound">outputs</a><a id="853" class="Symbol">)</a> <a id="855" href="Amethyst.Network.Base.html#750" class="Bound">inputs</a>
    <a id="Layer.biases"></a><a id="866" href="Amethyst.Network.Base.html#866" class="Field">biases</a>     <a id="877" class="Symbol">:</a> <a id="879" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="883" href="Amethyst.Network.Base.html#740" class="Bound">A</a> <a id="885" href="Amethyst.Network.Base.html#757" class="Bound">outputs</a>

<a id="894" class="Keyword">infixr</a> <a id="901" class="Number">5</a> <a id="903" href="Amethyst.Network.Base.html#1015" class="InductiveConstructor Operator">_∷_</a>

<a id="908" class="Keyword">data</a> <a id="Network"></a><a id="913" href="Amethyst.Network.Base.html#913" class="Datatype">Network</a> <a id="921" class="Symbol">(</a><a id="922" href="Amethyst.Network.Base.html#922" class="Bound">A</a> <a id="924" class="Symbol">:</a> <a id="926" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="929" class="Symbol">)</a> <a id="931" class="Symbol">(</a><a id="932" href="Amethyst.Network.Base.html#932" class="Bound">inputs</a> <a id="939" class="Symbol">:</a> <a id="941" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="942" class="Symbol">)</a> <a id="944" class="Symbol">:</a> <a id="946" class="Symbol">(</a><a id="947" href="Amethyst.Network.Base.html#947" class="Bound">outputs</a> <a id="955" href="Amethyst.Network.Base.html#955" class="Bound">layers</a> <a id="962" class="Symbol">:</a> <a id="964" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="965" class="Symbol">)</a> <a id="967" class="Symbol">→</a> <a id="969" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="973" class="Keyword">where</a>
  <a id="Network.[]"></a><a id="981" href="Amethyst.Network.Base.html#981" class="InductiveConstructor">[]</a>  <a id="985" class="Symbol">:</a> <a id="987" href="Amethyst.Network.Base.html#913" class="Datatype">Network</a> <a id="995" href="Amethyst.Network.Base.html#922" class="Bound">A</a> <a id="997" href="Amethyst.Network.Base.html#932" class="Bound">inputs</a> <a id="1004" href="Amethyst.Network.Base.html#932" class="Bound">inputs</a> <a id="1011" class="Number">0</a>
  <a id="Network._∷_"></a><a id="1015" href="Amethyst.Network.Base.html#1015" class="InductiveConstructor Operator">_∷_</a> <a id="1019" class="Symbol">:</a> <a id="1021" href="Amethyst.Network.Base.html#733" class="Record">Layer</a> <a id="1027" href="Amethyst.Network.Base.html#922" class="Bound">A</a> <a id="1029" href="Amethyst.Network.Base.html#932" class="Bound">inputs</a> <a id="1036" href="Amethyst.Network.Base.html#537" class="Generalizable">hidden</a> <a id="1043" class="Symbol">→</a> <a id="1045" href="Amethyst.Network.Base.html#913" class="Datatype">Network</a> <a id="1053" href="Amethyst.Network.Base.html#922" class="Bound">A</a> <a id="1055" href="Amethyst.Network.Base.html#537" class="Generalizable">hidden</a> <a id="1062" href="Amethyst.Network.Base.html#553" class="Generalizable">outputs</a> <a id="1070" href="Amethyst.Network.Base.html#569" class="Generalizable">layers</a> <a id="1077" class="Symbol">→</a> <a id="1079" href="Amethyst.Network.Base.html#913" class="Datatype">Network</a> <a id="1087" href="Amethyst.Network.Base.html#922" class="Bound">A</a> <a id="1089" href="Amethyst.Network.Base.html#932" class="Bound">inputs</a> <a id="1096" href="Amethyst.Network.Base.html#553" class="Generalizable">outputs</a> <a id="1104" class="Symbol">(</a><a id="1105" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1109" href="Amethyst.Network.Base.html#569" class="Generalizable">layers</a><a id="1115" class="Symbol">)</a>
</pre></body></html>