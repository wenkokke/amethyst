<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.Network.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst: Neural Network Verification in Agda</a>
<a id="131" class="Comment">--</a>
<a id="134" class="Comment">-- This module exports the basic types for representing neural networks.</a>
<a id="207" class="Comment">--</a>
<a id="210" class="Comment">-- Exports:</a>
<a id="222" class="Comment">--</a>
<a id="225" class="Comment">--   - Activation (linear; relu; sigmoid; softmax; tanh)</a>
<a id="282" class="Comment">--   - Layer      (activation; weights; biases)</a>
<a id="330" class="Comment">--   - Network    ([]; _∷_)</a>
<a id="358" class="Comment">--</a>
<a id="361" class="Comment">--------------------------------------------------------------------------------</a>

<a id="443" class="Keyword">module</a> <a id="450" href="Amethyst.Network.Base.html" class="Module">Amethyst.Network.Base</a> <a id="472" class="Keyword">where</a>

<a id="479" class="Keyword">import</a> <a id="486" href="Data.Vec.Extra.html" class="Module">Data.Vec.Extra</a> <a id="501" class="Symbol">as</a> <a id="504" class="Module">Vec</a>

<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="535" class="Symbol">as</a> <a id="538" class="Module">Fin</a> <a id="542" class="Keyword">using</a> <a id="548" class="Symbol">(</a><a id="549" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="552" class="Symbol">)</a>
<a id="554" class="Keyword">open</a> <a id="559" class="Keyword">import</a> <a id="566" href="Data.Float.html" class="Module">Data.Float</a> <a id="577" class="Symbol">as</a> <a id="580" class="Module">Float</a> <a id="586" class="Keyword">using</a> <a id="592" class="Symbol">(</a><a id="593" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="598" class="Symbol">)</a>
<a id="600" class="Keyword">open</a> <a id="605" class="Keyword">import</a> <a id="612" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="626" class="Symbol">as</a> <a id="629" class="Module">Nat</a> <a id="633" class="Keyword">using</a> <a id="639" class="Symbol">(</a><a id="640" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="641" class="Symbol">;</a> <a id="643" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="646" class="Symbol">;</a> <a id="648" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="652" class="Symbol">)</a>
<a id="654" class="Keyword">open</a> <a id="659" class="Keyword">import</a> <a id="666" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="680" class="Symbol">as</a> <a id="683" class="Module">Vec</a> <a id="687" class="Keyword">using</a> <a id="693" class="Symbol">(</a><a id="694" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="697" class="Symbol">;</a> <a id="699" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="701" class="Symbol">;</a> <a id="703" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="706" class="Symbol">)</a>
<a id="708" class="Keyword">open</a> <a id="713" class="Keyword">import</a> <a id="720" href="Function.html" class="Module">Function</a> <a id="729" class="Keyword">using</a> <a id="735" class="Symbol">(</a><a id="736" href="Function.Base.html#615" class="Function">id</a><a id="738" class="Symbol">)</a>

<a id="741" class="Keyword">private</a>
  <a id="751" class="Keyword">variable</a>
    <a id="764" href="Amethyst.Network.Base.html#764" class="Generalizable">A</a> <a id="766" class="Symbol">:</a> <a id="768" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="776" href="Amethyst.Network.Base.html#776" class="Generalizable">n</a> <a id="778" class="Symbol">:</a> <a id="780" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="786" href="Amethyst.Network.Base.html#786" class="Generalizable">hidden</a>  <a id="794" class="Symbol">:</a> <a id="796" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="802" href="Amethyst.Network.Base.html#802" class="Generalizable">layers</a>  <a id="810" class="Symbol">:</a> <a id="812" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="815" class="Keyword">data</a> <a id="Activation"></a><a id="820" href="Amethyst.Network.Base.html#820" class="Datatype">Activation</a> <a id="831" class="Symbol">:</a> <a id="833" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="837" class="Keyword">where</a>
  <a id="Activation.linear"></a><a id="845" href="Amethyst.Network.Base.html#845" class="InductiveConstructor">linear</a>  <a id="853" class="Symbol">:</a> <a id="855" href="Amethyst.Network.Base.html#820" class="Datatype">Activation</a>
  <a id="Activation.relu"></a><a id="868" href="Amethyst.Network.Base.html#868" class="InductiveConstructor">relu</a>    <a id="876" class="Symbol">:</a> <a id="878" href="Amethyst.Network.Base.html#820" class="Datatype">Activation</a>
  <a id="Activation.sigmoid"></a><a id="891" href="Amethyst.Network.Base.html#891" class="InductiveConstructor">sigmoid</a> <a id="899" class="Symbol">:</a> <a id="901" href="Amethyst.Network.Base.html#820" class="Datatype">Activation</a>
  <a id="Activation.softmax"></a><a id="914" href="Amethyst.Network.Base.html#914" class="InductiveConstructor">softmax</a> <a id="922" class="Symbol">:</a> <a id="924" href="Amethyst.Network.Base.html#820" class="Datatype">Activation</a>
  <a id="Activation.tanh"></a><a id="937" href="Amethyst.Network.Base.html#937" class="InductiveConstructor">tanh</a>    <a id="945" class="Symbol">:</a> <a id="947" href="Amethyst.Network.Base.html#820" class="Datatype">Activation</a>

<a id="959" class="Keyword">record</a> <a id="Layer"></a><a id="966" href="Amethyst.Network.Base.html#966" class="Record">Layer</a> <a id="972" class="Symbol">(</a><a id="973" href="Amethyst.Network.Base.html#973" class="Bound">A</a> <a id="975" class="Symbol">:</a> <a id="977" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="980" class="Symbol">)</a> <a id="982" class="Symbol">(</a><a id="983" href="Amethyst.Network.Base.html#983" class="Bound">inputs</a> <a id="990" href="Amethyst.Network.Base.html#990" class="Bound">outputs</a> <a id="998" class="Symbol">:</a> <a id="1000" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1001" class="Symbol">)</a> <a id="1003" class="Symbol">:</a> <a id="1005" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1009" class="Keyword">where</a>
  <a id="1017" class="Keyword">field</a>
    <a id="Layer.activation"></a><a id="1027" href="Amethyst.Network.Base.html#1027" class="Field">activation</a> <a id="1038" class="Symbol">:</a> <a id="1040" href="Amethyst.Network.Base.html#820" class="Datatype">Activation</a>
    <a id="Layer.weights"></a><a id="1055" href="Amethyst.Network.Base.html#1055" class="Field">weights</a>    <a id="1066" class="Symbol">:</a> <a id="1068" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1072" class="Symbol">(</a><a id="1073" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1077" href="Amethyst.Network.Base.html#973" class="Bound">A</a> <a id="1079" href="Amethyst.Network.Base.html#990" class="Bound">outputs</a><a id="1086" class="Symbol">)</a> <a id="1088" href="Amethyst.Network.Base.html#983" class="Bound">inputs</a>
    <a id="Layer.biases"></a><a id="1099" href="Amethyst.Network.Base.html#1099" class="Field">biases</a>     <a id="1110" class="Symbol">:</a> <a id="1112" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1116" href="Amethyst.Network.Base.html#973" class="Bound">A</a> <a id="1118" href="Amethyst.Network.Base.html#990" class="Bound">outputs</a>

<a id="LayerSpec"></a><a id="1127" href="Amethyst.Network.Base.html#1127" class="Function">LayerSpec</a> <a id="1137" class="Symbol">:</a> <a id="1139" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1141" class="Symbol">→</a> <a id="1143" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1147" href="Amethyst.Network.Base.html#1127" class="Function">LayerSpec</a> <a id="1157" class="Symbol">=</a> <a id="1159" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1163" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="∣_₀∣"></a><a id="1166" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣_₀∣</a> <a id="1171" class="Symbol">:</a> <a id="1173" href="Amethyst.Network.Base.html#1127" class="Function">LayerSpec</a> <a id="1183" href="Amethyst.Network.Base.html#776" class="Generalizable">n</a> <a id="1185" class="Symbol">→</a> <a id="1187" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1189" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="1191" href="Amethyst.Network.Base.html#1191" class="Bound">xs</a> <a id="1194" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a> <a id="1197" class="Symbol">=</a> <a id="1199" href="Data.Vec.Extra.html#224" class="Function">Vec.headOr</a> <a id="1210" href="Amethyst.Network.Base.html#1191" class="Bound">xs</a> <a id="1213" class="Number">0</a>

<a id="∣_ₙ∣"></a><a id="1216" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣_ₙ∣</a> <a id="1221" class="Symbol">:</a> <a id="1223" href="Amethyst.Network.Base.html#1127" class="Function">LayerSpec</a> <a id="1233" href="Amethyst.Network.Base.html#776" class="Generalizable">n</a> <a id="1235" class="Symbol">→</a> <a id="1237" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1239" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="1241" href="Amethyst.Network.Base.html#1241" class="Bound">xs</a> <a id="1244" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a> <a id="1247" class="Symbol">=</a> <a id="1249" href="Data.Vec.Extra.html#318" class="Function">Vec.lastOr</a> <a id="1260" href="Amethyst.Network.Base.html#1241" class="Bound">xs</a> <a id="1263" class="Number">0</a>

<a id="1266" class="Keyword">infixr</a> <a id="1273" class="Number">5</a> <a id="1275" href="Amethyst.Network.Base.html#1386" class="InductiveConstructor Operator">_∷_</a>

<a id="1280" class="Keyword">data</a> <a id="Network"></a><a id="1285" href="Amethyst.Network.Base.html#1285" class="Datatype">Network</a> <a id="1293" class="Symbol">(</a><a id="1294" href="Amethyst.Network.Base.html#1294" class="Bound">A</a> <a id="1296" class="Symbol">:</a> <a id="1298" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1301" class="Symbol">)</a> <a id="1303" class="Symbol">:</a> <a id="1305" class="Symbol">∀</a> <a id="1307" class="Symbol">{</a><a id="1308" href="Amethyst.Network.Base.html#1308" class="Bound">#layers</a> <a id="1316" class="Symbol">:</a> <a id="1318" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1319" class="Symbol">}</a> <a id="1321" class="Symbol">→</a> <a id="1323" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1327" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1329" href="Amethyst.Network.Base.html#1308" class="Bound">#layers</a> <a id="1337" class="Symbol">→</a> <a id="1339" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1343" class="Keyword">where</a>
  <a id="Network.[]"></a><a id="1351" href="Amethyst.Network.Base.html#1351" class="InductiveConstructor">[]</a>  <a id="1355" class="Symbol">:</a> <a id="1357" class="Symbol">∀</a> <a id="1359" class="Symbol">{</a><a id="1360" href="Amethyst.Network.Base.html#1360" class="Bound">n</a><a id="1361" class="Symbol">}</a> <a id="1363" class="Symbol">→</a> <a id="1365" href="Amethyst.Network.Base.html#1285" class="Datatype">Network</a> <a id="1373" href="Amethyst.Network.Base.html#1294" class="Bound">A</a> <a id="1375" class="Symbol">(</a><a id="1376" href="Amethyst.Network.Base.html#1360" class="Bound">n</a> <a id="1378" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1380" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1382" class="Symbol">)</a>
  <a id="Network._∷_"></a><a id="1386" href="Amethyst.Network.Base.html#1386" class="InductiveConstructor Operator">_∷_</a> <a id="1390" class="Symbol">:</a> <a id="1392" class="Symbol">∀</a> <a id="1394" class="Symbol">{</a><a id="1395" href="Amethyst.Network.Base.html#1395" class="Bound">n</a> <a id="1397" href="Amethyst.Network.Base.html#1397" class="Bound">|lᵢ|</a> <a id="1402" href="Amethyst.Network.Base.html#1402" class="Bound">|lᵢ₊₁|</a><a id="1408" class="Symbol">}</a> <a id="1410" class="Symbol">{</a><a id="1411" href="Amethyst.Network.Base.html#1411" class="Bound">xs</a> <a id="1414" class="Symbol">:</a> <a id="1416" href="Amethyst.Network.Base.html#1127" class="Function">LayerSpec</a> <a id="1426" href="Amethyst.Network.Base.html#1395" class="Bound">n</a><a id="1427" class="Symbol">}</a> <a id="1429" class="Symbol">→</a>
        <a id="1439" href="Amethyst.Network.Base.html#966" class="Record">Layer</a> <a id="1445" href="Amethyst.Network.Base.html#1294" class="Bound">A</a> <a id="1447" href="Amethyst.Network.Base.html#1397" class="Bound">|lᵢ|</a> <a id="1452" href="Amethyst.Network.Base.html#1402" class="Bound">|lᵢ₊₁|</a> <a id="1459" class="Symbol">→</a> <a id="1461" href="Amethyst.Network.Base.html#1285" class="Datatype">Network</a> <a id="1469" href="Amethyst.Network.Base.html#1294" class="Bound">A</a> <a id="1471" class="Symbol">(</a><a id="1472" href="Amethyst.Network.Base.html#1402" class="Bound">|lᵢ₊₁|</a> <a id="1479" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1481" href="Amethyst.Network.Base.html#1411" class="Bound">xs</a><a id="1483" class="Symbol">)</a> <a id="1485" class="Symbol">→</a> <a id="1487" href="Amethyst.Network.Base.html#1285" class="Datatype">Network</a> <a id="1495" href="Amethyst.Network.Base.html#1294" class="Bound">A</a> <a id="1497" class="Symbol">(</a><a id="1498" href="Amethyst.Network.Base.html#1397" class="Bound">|lᵢ|</a> <a id="1503" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1505" href="Amethyst.Network.Base.html#1402" class="Bound">|lᵢ₊₁|</a> <a id="1512" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1514" href="Amethyst.Network.Base.html#1411" class="Bound">xs</a><a id="1516" class="Symbol">)</a>
</pre></body></html>