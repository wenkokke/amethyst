<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.PiecewiseLinear.As.Float</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst: Neural Network Verification in Agda</a>
<a id="131" class="Comment">--</a>
<a id="134" class="Comment">-- This module contains functions to evaluate piecewise-linear functions as</a>
<a id="210" class="Comment">-- functions on floating-point numbers.</a>
<a id="250" class="Comment">-- Piecewise-linear approximations are built over an interval `(lower, upper)`.</a>
<a id="330" class="Comment">-- How should a piecewise-linear approximation behave outside of this interval?</a>
<a id="410" class="Comment">-- We have three simple options:</a>
<a id="443" class="Comment">--</a>
<a id="446" class="Comment">--   1. We can extrapolate the first and last line segments beyond the interval</a>
<a id="526" class="Comment">--      boundaries. This is implemented as `evalExtrap`.</a>
<a id="583" class="Comment">--   2. We can return the minimum point, `f(lower)`, for inputs below the</a>
<a id="657" class="Comment">--      interval, and return the maximum point, `f(upper)`, for inputs above the</a>
<a id="738" class="Comment">--      interval. This is implemented as `evalBounded`.</a>
<a id="794" class="Comment">--   3. We can combine (1) and (2). We start by extrapolating, following (1),</a>
<a id="872" class="Comment">--      and allow the user to specify lower and upper bounds, where we switch to</a>
<a id="953" class="Comment">--      returning the constant minimum and maximum, following (2). This is not</a>
<a id="1032" class="Comment">--      currently implemented.</a>
<a id="1063" class="Comment">--</a>
<a id="1066" class="Comment">-- The first option is unsound, as it may result in cases where the codomain of</a>
<a id="1146" class="Comment">-- the piecewise-linear approximation is not a subset of the codomain of the</a>
<a id="1223" class="Comment">-- approximated function. For instance, the piecewise-linear approximation of</a>
<a id="1301" class="Comment">-- the exp-function may return values &lt;0 for a sufficiently small input.</a>
<a id="1374" class="Comment">-- However, we have found that it works well in practice. The second option is</a>
<a id="1453" class="Comment">-- sound, albeit a bit crude. The third option combines the best of (1) and (2),</a>
<a id="1534" class="Comment">-- but requires manual tweaking.</a>
<a id="1567" class="Comment">--</a>
<a id="1570" class="Comment">-- Exports:</a>
<a id="1582" class="Comment">--</a>
<a id="1585" class="Comment">--   - evalExtrap</a>
<a id="1603" class="Comment">--   - evalBounded</a>
<a id="1622" class="Comment">--</a>
<a id="1625" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1706" class="Keyword">module</a> <a id="1713" href="Amethyst.PiecewiseLinear.As.Float.html" class="Module">Amethyst.PiecewiseLinear.As.Float</a> <a id="1747" class="Keyword">where</a>

<a id="1754" class="Keyword">open</a> <a id="1759" class="Keyword">import</a> <a id="1766" href="Amethyst.PiecewiseLinear.Base.html" class="Module">Amethyst.PiecewiseLinear.Base</a> <a id="1796" class="Keyword">using</a> <a id="1802" class="Symbol">(</a><a id="1803" href="Amethyst.PiecewiseLinear.Base.html#2400" class="Datatype">PiecewiseLinear</a><a id="1818" class="Symbol">;</a> <a id="1820" href="Amethyst.PiecewiseLinear.Base.html#2466" class="InductiveConstructor">[]</a><a id="1822" class="Symbol">;</a> <a id="1824" href="Amethyst.PiecewiseLinear.Base.html#2503" class="InductiveConstructor Operator">_∷_</a><a id="1827" class="Symbol">;</a> <a id="1829" href="Amethyst.PiecewiseLinear.Base.html#2232" class="Record">LineSegment</a><a id="1840" class="Symbol">;</a> <a id="1842" href="Amethyst.PiecewiseLinear.Base.html#2722" class="Function">head</a><a id="1846" class="Symbol">;</a> <a id="1848" href="Amethyst.PiecewiseLinear.Base.html#3320" class="Function Operator">_+[_*_]</a><a id="1855" class="Symbol">;</a> <a id="1857" href="Amethyst.PiecewiseLinear.Base.html#3485" class="Function">last</a><a id="1861" class="Symbol">)</a>
<a id="1863" class="Keyword">open</a> <a id="1868" class="Keyword">import</a> <a id="1875" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="1885" class="Symbol">as</a> <a id="1888" class="Module">Bool</a> <a id="1893" class="Keyword">using</a> <a id="1899" class="Symbol">(</a><a id="1900" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1904" class="Symbol">;</a> <a id="1906" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="1910" class="Symbol">;</a> <a id="1912" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="1917" class="Symbol">;</a> <a id="1919" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a><a id="1932" class="Symbol">)</a>
<a id="1934" class="Keyword">open</a> <a id="1939" class="Keyword">import</a> <a id="1946" href="Data.Float.html" class="Module">Data.Float</a> <a id="1957" class="Symbol">as</a> <a id="1960" class="Module">Float</a> <a id="1966" class="Keyword">using</a> <a id="1972" class="Symbol">(</a><a id="1973" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="1978" class="Symbol">;</a> <a id="1980" href="Agda.Builtin.Float.html#1336" class="Primitive">_+_</a><a id="1983" class="Symbol">;</a> <a id="1985" href="Agda.Builtin.Float.html#1442" class="Primitive">_*_</a><a id="1988" class="Symbol">;</a> <a id="1990" href="Agda.Builtin.Float.html#422" class="Primitive">_≤ᵇ_</a><a id="1994" class="Symbol">)</a>
<a id="1996" class="Keyword">open</a> <a id="2001" class="Keyword">import</a> <a id="2008" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="2017" class="Symbol">as</a> <a id="2020" class="Module">Nat</a> <a id="2024" class="Keyword">using</a> <a id="2030" class="Symbol">(</a><a id="2031" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="2032" class="Symbol">;</a> <a id="2034" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="2037" class="Symbol">;</a> <a id="2039" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="2043" class="Symbol">)</a>
<a id="2045" class="Keyword">open</a> <a id="2050" class="Keyword">import</a> <a id="2057" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="2066" class="Symbol">as</a> <a id="2069" class="Module">Vec</a> <a id="2073" class="Keyword">using</a> <a id="2079" class="Symbol">(</a><a id="2080" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="2083" class="Symbol">)</a>

<a id="2086" class="Keyword">private</a>
  <a id="2096" class="Keyword">variable</a>
    <a id="2109" href="Amethyst.PiecewiseLinear.As.Float.html#2109" class="Generalizable">pieces</a> <a id="2116" class="Symbol">:</a> <a id="2118" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2124" href="Amethyst.PiecewiseLinear.As.Float.html#2124" class="Generalizable">lower</a>  <a id="2131" class="Symbol">:</a> <a id="2133" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a>
    <a id="2143" href="Amethyst.PiecewiseLinear.As.Float.html#2143" class="Generalizable">step</a>   <a id="2150" class="Symbol">:</a> <a id="2152" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a>
    <a id="2162" href="Amethyst.PiecewiseLinear.As.Float.html#2162" class="Generalizable">upper</a>  <a id="2169" class="Symbol">:</a> <a id="2171" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a>

<a id="2178" class="Keyword">private</a>
  <a id="2188" class="Comment">-- |Return the y-value corresponding to x on the line segment ls. If x is out of</a>
  <a id="2271" class="Comment">--  bounds, extrapolate the line segment.</a>
  <a id="evalExtrapLineSegment"></a><a id="2315" href="Amethyst.PiecewiseLinear.As.Float.html#2315" class="Function">evalExtrapLineSegment</a> <a id="2337" class="Symbol">:</a> <a id="2339" class="Symbol">(</a><a id="2340" href="Amethyst.PiecewiseLinear.As.Float.html#2340" class="Bound">ls</a> <a id="2343" class="Symbol">:</a> <a id="2345" href="Amethyst.PiecewiseLinear.Base.html#2232" class="Record">LineSegment</a> <a id="2357" href="Amethyst.PiecewiseLinear.As.Float.html#2124" class="Generalizable">lower</a> <a id="2363" href="Amethyst.PiecewiseLinear.As.Float.html#2162" class="Generalizable">upper</a><a id="2368" class="Symbol">)</a> <a id="2370" class="Symbol">(</a><a id="2371" href="Amethyst.PiecewiseLinear.As.Float.html#2371" class="Bound">x</a> <a id="2373" class="Symbol">:</a> <a id="2375" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="2380" class="Symbol">)</a> <a id="2382" class="Symbol">→</a> <a id="2384" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a>
  <a id="2392" href="Amethyst.PiecewiseLinear.As.Float.html#2315" class="Function">evalExtrapLineSegment</a> <a id="2414" href="Amethyst.PiecewiseLinear.As.Float.html#2414" class="Bound">ls</a> <a id="2417" href="Amethyst.PiecewiseLinear.As.Float.html#2417" class="Bound">x</a> <a id="2419" class="Symbol">=</a> <a id="2421" class="Symbol">(</a><a id="2422" href="Amethyst.PiecewiseLinear.As.Float.html#2417" class="Bound">x</a> <a id="2424" href="Agda.Builtin.Float.html#1442" class="Primitive Operator">*</a> <a id="2426" href="Amethyst.PiecewiseLinear.Base.html#2290" class="Function">slope</a><a id="2431" class="Symbol">)</a> <a id="2433" href="Agda.Builtin.Float.html#1336" class="Primitive Operator">+</a> <a id="2435" href="Amethyst.PiecewiseLinear.Base.html#2312" class="Function">intercept</a>
    <a id="2449" class="Keyword">where</a>
      <a id="2461" class="Keyword">open</a> <a id="2466" href="Amethyst.PiecewiseLinear.Base.html#2232" class="Module">LineSegment</a> <a id="2478" href="Amethyst.PiecewiseLinear.As.Float.html#2414" class="Bound">ls</a> <a id="2481" class="Keyword">using</a> <a id="2487" class="Symbol">(</a><a id="2488" href="Amethyst.PiecewiseLinear.Base.html#2290" class="Field">slope</a><a id="2493" class="Symbol">;</a> <a id="2495" href="Amethyst.PiecewiseLinear.Base.html#2312" class="Field">intercept</a><a id="2504" class="Symbol">)</a>

  <a id="2509" class="Comment">-- |Return the y-value corresponding to x on the line segment ls. If x is out of</a>
  <a id="2592" class="Comment">--  bounds, return the y-value corresponding to the x-value closest to x which is</a>
  <a id="2676" class="Comment">--  in bounds, i.e., either lower or upper.</a>
  <a id="evalBoundedLineSegment"></a><a id="2722" href="Amethyst.PiecewiseLinear.As.Float.html#2722" class="Function">evalBoundedLineSegment</a> <a id="2745" class="Symbol">:</a> <a id="2747" class="Symbol">(</a><a id="2748" href="Amethyst.PiecewiseLinear.As.Float.html#2748" class="Bound">ls</a> <a id="2751" class="Symbol">:</a> <a id="2753" href="Amethyst.PiecewiseLinear.Base.html#2232" class="Record">LineSegment</a> <a id="2765" href="Amethyst.PiecewiseLinear.As.Float.html#2124" class="Generalizable">lower</a> <a id="2771" href="Amethyst.PiecewiseLinear.As.Float.html#2162" class="Generalizable">upper</a><a id="2776" class="Symbol">)</a> <a id="2778" class="Symbol">→</a> <a id="2780" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="2786" class="Symbol">→</a> <a id="2788" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a>
  <a id="2796" href="Amethyst.PiecewiseLinear.As.Float.html#2722" class="Function">evalBoundedLineSegment</a> <a id="2819" class="Symbol">{</a><a id="2820" href="Amethyst.PiecewiseLinear.As.Float.html#2820" class="Bound">lower</a><a id="2825" class="Symbol">}</a> <a id="2827" class="Symbol">{</a><a id="2828" href="Amethyst.PiecewiseLinear.As.Float.html#2828" class="Bound">upper</a><a id="2833" class="Symbol">}</a> <a id="2835" href="Amethyst.PiecewiseLinear.As.Float.html#2835" class="Bound">ls</a> <a id="2838" href="Amethyst.PiecewiseLinear.As.Float.html#2838" class="Bound">x</a> <a id="2840" class="Symbol">=</a>
    <a id="2846" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2849" href="Amethyst.PiecewiseLinear.As.Float.html#2838" class="Bound">x</a> <a id="2851" href="Agda.Builtin.Float.html#422" class="Primitive Operator">≤ᵇ</a> <a id="2854" href="Amethyst.PiecewiseLinear.As.Float.html#2820" class="Bound">lower</a> <a id="2860" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2865" href="Amethyst.PiecewiseLinear.As.Float.html#2315" class="Function">evalExtrapLineSegment</a> <a id="2887" href="Amethyst.PiecewiseLinear.As.Float.html#2835" class="Bound">ls</a> <a id="2890" href="Amethyst.PiecewiseLinear.As.Float.html#2820" class="Bound">lower</a> <a id="2896" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
    <a id="2905" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2908" href="Amethyst.PiecewiseLinear.As.Float.html#2828" class="Bound">upper</a> <a id="2914" href="Agda.Builtin.Float.html#422" class="Primitive Operator">≤ᵇ</a> <a id="2917" href="Amethyst.PiecewiseLinear.As.Float.html#2838" class="Bound">x</a> <a id="2919" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2924" href="Amethyst.PiecewiseLinear.As.Float.html#2315" class="Function">evalExtrapLineSegment</a> <a id="2946" href="Amethyst.PiecewiseLinear.As.Float.html#2835" class="Bound">ls</a> <a id="2949" href="Amethyst.PiecewiseLinear.As.Float.html#2828" class="Bound">upper</a> <a id="2955" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
    <a id="2964" href="Amethyst.PiecewiseLinear.As.Float.html#2315" class="Function">evalExtrapLineSegment</a> <a id="2986" href="Amethyst.PiecewiseLinear.As.Float.html#2835" class="Bound">ls</a> <a id="2989" href="Amethyst.PiecewiseLinear.As.Float.html#2838" class="Bound">x</a>

<a id="2992" class="Comment">-- |Return the y-value corresponding to x on the piecewise-linear function.</a>
<a id="3068" class="Comment">--  If x is out of bounds, extrapolate the head/last line segment.</a>
<a id="evalExtrap"></a><a id="3135" href="Amethyst.PiecewiseLinear.As.Float.html#3135" class="Function">evalExtrap</a> <a id="3146" class="Symbol">:</a> <a id="3148" class="Symbol">(</a><a id="3149" href="Amethyst.PiecewiseLinear.As.Float.html#3149" class="Bound">pl</a> <a id="3152" class="Symbol">:</a> <a id="3154" href="Amethyst.PiecewiseLinear.Base.html#2400" class="Datatype">PiecewiseLinear</a> <a id="3170" href="Amethyst.PiecewiseLinear.As.Float.html#2124" class="Generalizable">lower</a> <a id="3176" href="Amethyst.PiecewiseLinear.As.Float.html#2143" class="Generalizable">step</a> <a id="3181" class="Symbol">(</a><a id="3182" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3186" href="Amethyst.PiecewiseLinear.As.Float.html#2109" class="Generalizable">pieces</a><a id="3192" class="Symbol">))</a> <a id="3195" class="Symbol">→</a> <a id="3197" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="3203" class="Symbol">→</a> <a id="3205" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a>
<a id="3211" href="Amethyst.PiecewiseLinear.As.Float.html#3135" class="Function">evalExtrap</a> <a id="3222" class="Symbol">{</a><a id="3223" href="Amethyst.PiecewiseLinear.As.Float.html#3223" class="Bound">lower</a><a id="3228" class="Symbol">}</a> <a id="3230" class="Symbol">{</a><a id="3231" href="Amethyst.PiecewiseLinear.As.Float.html#3231" class="Bound">step</a><a id="3235" class="Symbol">}</a> <a id="3237" class="Symbol">(</a><a id="3238" href="Amethyst.PiecewiseLinear.As.Float.html#3238" class="Bound">ls</a> <a id="3241" href="Amethyst.PiecewiseLinear.Base.html#2503" class="InductiveConstructor Operator">∷</a> <a id="3243" href="Amethyst.PiecewiseLinear.Base.html#2466" class="InductiveConstructor">[]</a><a id="3245" class="Symbol">)</a>         <a id="3255" href="Amethyst.PiecewiseLinear.As.Float.html#3255" class="Bound">x</a> <a id="3257" class="Symbol">=</a> <a id="3259" href="Amethyst.PiecewiseLinear.As.Float.html#2315" class="Function">evalExtrapLineSegment</a> <a id="3281" href="Amethyst.PiecewiseLinear.As.Float.html#3238" class="Bound">ls</a> <a id="3284" href="Amethyst.PiecewiseLinear.As.Float.html#3255" class="Bound">x</a>
<a id="3286" href="Amethyst.PiecewiseLinear.As.Float.html#3135" class="Function">evalExtrap</a> <a id="3297" class="Symbol">{</a><a id="3298" href="Amethyst.PiecewiseLinear.As.Float.html#3298" class="Bound">lower</a><a id="3303" class="Symbol">}</a> <a id="3305" class="Symbol">{</a><a id="3306" href="Amethyst.PiecewiseLinear.As.Float.html#3306" class="Bound">step</a><a id="3310" class="Symbol">}</a> <a id="3312" class="Symbol">(</a><a id="3313" href="Amethyst.PiecewiseLinear.As.Float.html#3313" class="Bound">ls</a> <a id="3316" href="Amethyst.PiecewiseLinear.Base.html#2503" class="InductiveConstructor Operator">∷</a> <a id="3318" href="Amethyst.PiecewiseLinear.As.Float.html#3318" class="Bound">pl</a><a id="3320" class="Symbol">@(_</a> <a id="3324" href="Amethyst.PiecewiseLinear.Base.html#2503" class="InductiveConstructor Operator">∷</a> <a id="3326" class="Symbol">_))</a> <a id="3330" href="Amethyst.PiecewiseLinear.As.Float.html#3330" class="Bound">x</a> <a id="3332" class="Symbol">=</a>
  <a id="3336" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="3339" href="Amethyst.PiecewiseLinear.As.Float.html#3330" class="Bound">x</a> <a id="3341" href="Agda.Builtin.Float.html#422" class="Primitive Operator">≤ᵇ</a> <a id="3344" href="Amethyst.PiecewiseLinear.As.Float.html#3298" class="Bound">lower</a> <a id="3350" href="Agda.Builtin.Float.html#1336" class="Primitive Operator">+</a> <a id="3352" href="Amethyst.PiecewiseLinear.As.Float.html#3306" class="Bound">step</a> <a id="3357" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="3362" href="Amethyst.PiecewiseLinear.As.Float.html#2315" class="Function">evalExtrapLineSegment</a> <a id="3384" href="Amethyst.PiecewiseLinear.As.Float.html#3313" class="Bound">ls</a> <a id="3387" href="Amethyst.PiecewiseLinear.As.Float.html#3330" class="Bound">x</a> <a id="3389" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
  <a id="3396" href="Amethyst.PiecewiseLinear.As.Float.html#3135" class="Function">evalExtrap</a> <a id="3407" href="Amethyst.PiecewiseLinear.As.Float.html#3318" class="Bound">pl</a> <a id="3410" href="Amethyst.PiecewiseLinear.As.Float.html#3330" class="Bound">x</a>

<a id="3413" class="Comment">-- |Return the y-value corresponding to x on the piecewise-linear function.</a>
<a id="3489" class="Comment">--  If x is out of bounds, return the y-value corresponding to the x-value</a>
<a id="3564" class="Comment">--  closest to x which is in bounds, i.e., either lower or upper.</a>
<a id="evalBounded"></a><a id="3630" href="Amethyst.PiecewiseLinear.As.Float.html#3630" class="Function">evalBounded</a> <a id="3642" class="Symbol">:</a> <a id="3644" class="Symbol">(</a><a id="3645" href="Amethyst.PiecewiseLinear.As.Float.html#3645" class="Bound">pl</a> <a id="3648" class="Symbol">:</a> <a id="3650" href="Amethyst.PiecewiseLinear.Base.html#2400" class="Datatype">PiecewiseLinear</a> <a id="3666" href="Amethyst.PiecewiseLinear.As.Float.html#2124" class="Generalizable">lower</a> <a id="3672" href="Amethyst.PiecewiseLinear.As.Float.html#2143" class="Generalizable">step</a> <a id="3677" class="Symbol">(</a><a id="3678" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3682" href="Amethyst.PiecewiseLinear.As.Float.html#2109" class="Generalizable">pieces</a><a id="3688" class="Symbol">))</a> <a id="3691" class="Symbol">→</a> <a id="3693" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="3699" class="Symbol">→</a> <a id="3701" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a>
<a id="3707" href="Amethyst.PiecewiseLinear.As.Float.html#3630" class="Function">evalBounded</a> <a id="3719" class="Symbol">{</a><a id="3720" href="Amethyst.PiecewiseLinear.As.Float.html#3720" class="Bound">lower</a><a id="3725" class="Symbol">}</a> <a id="3727" class="Symbol">{</a><a id="3728" href="Amethyst.PiecewiseLinear.As.Float.html#3728" class="Bound">step</a><a id="3732" class="Symbol">}</a> <a id="3734" class="Symbol">{</a><a id="3735" href="Amethyst.PiecewiseLinear.As.Float.html#3735" class="Bound">pieces</a><a id="3741" class="Symbol">}</a> <a id="3743" href="Amethyst.PiecewiseLinear.As.Float.html#3743" class="Bound">pl</a> <a id="3746" href="Amethyst.PiecewiseLinear.As.Float.html#3746" class="Bound">x</a> <a id="3748" class="Symbol">=</a>
  <a id="3752" class="Keyword">let</a> <a id="3756" href="Amethyst.PiecewiseLinear.As.Float.html#3756" class="Bound">upper</a> <a id="3762" class="Symbol">=</a> <a id="3764" href="Amethyst.PiecewiseLinear.As.Float.html#3720" class="Bound">lower</a> <a id="3770" href="Amethyst.PiecewiseLinear.Base.html#3320" class="Function Operator">+[</a> <a id="3773" href="Amethyst.PiecewiseLinear.As.Float.html#3728" class="Bound">step</a> <a id="3778" href="Amethyst.PiecewiseLinear.Base.html#3320" class="Function Operator">*</a> <a id="3780" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3784" href="Amethyst.PiecewiseLinear.As.Float.html#3735" class="Bound">pieces</a> <a id="3791" href="Amethyst.PiecewiseLinear.Base.html#3320" class="Function Operator">]</a>
  <a id="3795" class="Keyword">in</a> <a id="3798" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="3801" href="Amethyst.PiecewiseLinear.As.Float.html#3746" class="Bound">x</a> <a id="3803" href="Agda.Builtin.Float.html#422" class="Primitive Operator">≤ᵇ</a> <a id="3806" href="Amethyst.PiecewiseLinear.As.Float.html#3720" class="Bound">lower</a> <a id="3812" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="3817" href="Amethyst.PiecewiseLinear.As.Float.html#2315" class="Function">evalExtrapLineSegment</a> <a id="3839" class="Symbol">(</a><a id="3840" href="Amethyst.PiecewiseLinear.Base.html#2722" class="Function">head</a> <a id="3845" href="Amethyst.PiecewiseLinear.As.Float.html#3743" class="Bound">pl</a><a id="3847" class="Symbol">)</a> <a id="3849" href="Amethyst.PiecewiseLinear.As.Float.html#3746" class="Bound">x</a> <a id="3851" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
     <a id="3861" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="3864" href="Amethyst.PiecewiseLinear.As.Float.html#3756" class="Bound">upper</a> <a id="3870" href="Agda.Builtin.Float.html#422" class="Primitive Operator">≤ᵇ</a> <a id="3873" href="Amethyst.PiecewiseLinear.As.Float.html#3746" class="Bound">x</a> <a id="3875" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="3880" href="Amethyst.PiecewiseLinear.As.Float.html#2315" class="Function">evalExtrapLineSegment</a> <a id="3902" class="Symbol">(</a><a id="3903" href="Amethyst.PiecewiseLinear.Base.html#3485" class="Function">last</a> <a id="3908" href="Amethyst.PiecewiseLinear.As.Float.html#3743" class="Bound">pl</a><a id="3910" class="Symbol">)</a> <a id="3912" href="Amethyst.PiecewiseLinear.As.Float.html#3746" class="Bound">x</a> <a id="3914" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
     <a id="3924" href="Amethyst.PiecewiseLinear.As.Float.html#3135" class="Function">evalExtrap</a> <a id="3935" href="Amethyst.PiecewiseLinear.As.Float.html#3743" class="Bound">pl</a> <a id="3938" href="Amethyst.PiecewiseLinear.As.Float.html#3746" class="Bound">x</a>
</pre></body></html>