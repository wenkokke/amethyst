<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.Network.As.Schmitty</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- This module contains functions to reflect networks as Schmitty terms and</a>
<a id="77" class="Comment">-- scripts.</a>
<a id="89" class="Comment">--</a>
<a id="92" class="Comment">-- Exports:</a>
<a id="104" class="Comment">--</a>
<a id="107" class="Comment">--   - reflectActivation</a>
<a id="132" class="Comment">--   - reflectLayer</a>
<a id="152" class="Comment">--   - reflectNetwork</a>
<a id="174" class="Comment">--   - reflectNetworkAsScript</a>
<a id="204" class="Comment">--</a>
<a id="207" class="Keyword">module</a> <a id="214" href="Amethyst.Network.As.Schmitty.html" class="Module">Amethyst.Network.As.Schmitty</a> <a id="243" class="Keyword">where</a>

<a id="250" class="Keyword">open</a> <a id="255" class="Keyword">import</a> <a id="262" href="Amethyst.Network.Base.html" class="Module">Amethyst.Network.Base</a> <a id="284" class="Keyword">using</a> <a id="290" class="Symbol">(</a><a id="291" href="Amethyst.Network.Base.html#913" class="Datatype">Network</a><a id="298" class="Symbol">;</a> <a id="300" href="Amethyst.Network.Base.html#981" class="InductiveConstructor">[]</a><a id="302" class="Symbol">;</a> <a id="304" href="Amethyst.Network.Base.html#1015" class="InductiveConstructor Operator">_∷_</a><a id="307" class="Symbol">;</a> <a id="309" href="Amethyst.Network.Base.html#733" class="Record">Layer</a><a id="314" class="Symbol">;</a> <a id="316" href="Amethyst.Network.Base.html#587" class="Datatype">Activation</a><a id="326" class="Symbol">)</a>
<a id="328" class="Keyword">open</a> <a id="333" class="Keyword">import</a> <a id="340" href="Amethyst.PiecewiseLinear.Base.html" class="Module">Amethyst.PiecewiseLinear.Base</a>
<a id="370" class="Keyword">open</a> <a id="375" class="Keyword">import</a> <a id="382" href="Amethyst.PiecewiseLinear.As.Schmitty.html" class="Module">Amethyst.PiecewiseLinear.As.Schmitty</a>
<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Amethyst.LinearAlgebra.As.Schmitty.html" class="Module">Amethyst.LinearAlgebra.As.Schmitty</a>
<a id="466" class="Keyword">open</a> <a id="471" class="Keyword">import</a> <a id="478" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="488" class="Symbol">as</a> <a id="491" class="Module">Bool</a> <a id="496" class="Keyword">using</a> <a id="502" class="Symbol">(</a><a id="503" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="507" class="Symbol">;</a> <a id="509" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="514" class="Symbol">;</a> <a id="516" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="520" class="Symbol">)</a>
<a id="522" class="Keyword">open</a> <a id="527" class="Keyword">import</a> <a id="534" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="543" class="Symbol">as</a> <a id="546" class="Module">Fin</a> <a id="550" class="Keyword">using</a> <a id="556" class="Symbol">(</a><a id="557" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="560" class="Symbol">;</a> <a id="562" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a><a id="566" class="Symbol">;</a> <a id="568" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a><a id="571" class="Symbol">)</a>
<a id="573" class="Keyword">open</a> <a id="578" class="Keyword">import</a> <a id="585" href="Data.Float.html" class="Module">Data.Float</a> <a id="596" class="Symbol">as</a> <a id="599" class="Module">Float</a> <a id="605" class="Keyword">using</a> <a id="611" class="Symbol">(</a><a id="612" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="617" class="Symbol">)</a>
<a id="619" class="Keyword">open</a> <a id="624" class="Keyword">import</a> <a id="631" href="Data.List.html" class="Module">Data.List</a> <a id="641" class="Symbol">as</a> <a id="644" class="Module">List</a> <a id="649" class="Keyword">using</a> <a id="655" class="Symbol">(</a><a id="656" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="660" class="Symbol">;</a> <a id="662" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="664" class="Symbol">;</a> <a id="666" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="669" class="Symbol">;</a> <a id="671" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="675" class="Symbol">;</a> <a id="677" href="Data.List.Base.html#9558" class="Function Operator">_ʳ++_</a><a id="682" class="Symbol">)</a>
<a id="684" class="Keyword">import</a> <a id="691" href="Data.List.Properties.html" class="Module">Data.List.Properties</a> <a id="712" class="Symbol">as</a> <a id="715" class="Module">List</a>
<a id="720" class="Keyword">open</a> <a id="725" class="Keyword">import</a> <a id="732" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="741" class="Symbol">as</a> <a id="744" class="Module">Nat</a> <a id="748" class="Keyword">using</a> <a id="754" class="Symbol">(</a><a id="755" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="756" class="Symbol">;</a> <a id="758" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="762" class="Symbol">;</a> <a id="764" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="767" class="Symbol">)</a>
<a id="769" class="Keyword">open</a> <a id="774" class="Keyword">import</a> <a id="781" href="Data.Product.html" class="Module">Data.Product</a> <a id="794" class="Symbol">as</a> <a id="797" class="Module">Prod</a> <a id="802" class="Keyword">using</a> <a id="808" class="Symbol">(</a><a id="809" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="812" class="Symbol">;</a> <a id="814" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="817" class="Symbol">;</a> <a id="819" href="Data.Product.html#3399" class="Function">uncurry</a><a id="826" class="Symbol">)</a>
<a id="828" class="Keyword">open</a> <a id="833" class="Keyword">import</a> <a id="840" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="849" class="Symbol">as</a> <a id="852" class="Module">Vec</a> <a id="856" class="Keyword">using</a> <a id="862" class="Symbol">(</a><a id="863" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="866" class="Symbol">;</a> <a id="868" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="870" class="Symbol">;</a> <a id="872" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="875" class="Symbol">)</a>
<a id="877" class="Keyword">open</a> <a id="882" class="Keyword">import</a> <a id="889" href="Function.html" class="Module">Function</a> <a id="898" class="Keyword">using</a> <a id="904" class="Symbol">(</a><a id="905" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="908" class="Symbol">;</a> <a id="910" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="913" class="Symbol">;</a> <a id="915" href="Function.Base.html#2210" class="Function Operator">_|&gt;_</a><a id="919" class="Symbol">;</a> <a id="921" href="Function.Base.html#615" class="Function">id</a><a id="923" class="Symbol">)</a>
<a id="925" class="Keyword">open</a> <a id="930" class="Keyword">import</a> <a id="937" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="975" class="Symbol">as</a> <a id="978" class="Module">Eq</a> <a id="981" class="Keyword">using</a> <a id="987" class="Symbol">(</a><a id="988" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="991" class="Symbol">;</a> <a id="993" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="997" class="Symbol">)</a>
<a id="999" class="Keyword">open</a> <a id="1004" href="Relation.Binary.PropositionalEquality.Core.html#2647" class="Module">Eq.≡-Reasoning</a>

<a id="1020" class="Comment">-- * Activation functions</a>

<a id="1047" class="Keyword">private</a>
  <a id="1057" class="Keyword">variable</a>
    <a id="1070" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a> <a id="1072" class="Symbol">:</a> <a id="1074" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a>
    <a id="1083" href="Amethyst.Network.As.Schmitty.html#1083" class="Generalizable">n</a> <a id="1085" class="Symbol">:</a> <a id="1087" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1090" class="Keyword">private</a>
  <a id="relu"></a><a id="1100" href="Amethyst.Network.As.Schmitty.html#1100" class="Function">relu</a> <a id="1105" class="Symbol">:</a> <a id="1107" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1112" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a> <a id="1114" class="Symbol">→</a> <a id="1116" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1121" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a>
  <a id="1125" href="Amethyst.Network.As.Schmitty.html#1100" class="Function">relu</a> <a id="1130" href="Amethyst.Network.As.Schmitty.html#1130" class="Bound">x</a> <a id="1132" class="Symbol">=</a> <a id="1134" href="SMT.Script.Base.html#1976" class="InductiveConstructor">app₃</a> <a id="1139" href="SMT.Theories.Reals.html#4677" class="InductiveConstructor">ite</a> <a id="1143" class="Symbol">(</a><a id="1144" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1149" href="SMT.Theories.Reals.html#4878" class="InductiveConstructor">leq</a> <a id="1153" href="Amethyst.Network.As.Schmitty.html#1130" class="Bound">x</a> <a id="1155" class="Symbol">(</a><a id="1156" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="1160" class="Symbol">(</a><a id="1161" href="SMT.Theories.Reals.html#3769" class="InductiveConstructor">nat</a> <a id="1165" class="Number">0</a><a id="1166" class="Symbol">)))</a> <a id="1170" class="Symbol">(</a><a id="1171" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="1175" class="Symbol">(</a><a id="1176" href="SMT.Theories.Reals.html#3769" class="InductiveConstructor">nat</a> <a id="1180" class="Number">0</a><a id="1181" class="Symbol">))</a> <a id="1184" href="Amethyst.Network.As.Schmitty.html#1130" class="Bound">x</a>

  <a id="lexp"></a><a id="1189" href="Amethyst.Network.As.Schmitty.html#1189" class="Function">lexp</a> <a id="1194" class="Symbol">:</a> <a id="1196" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1201" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a> <a id="1203" class="Symbol">→</a> <a id="1205" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1210" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a>
  <a id="1214" href="Amethyst.Network.As.Schmitty.html#1189" class="Function">lexp</a> <a id="1219" class="Symbol">=</a> <a id="1221" href="Amethyst.PiecewiseLinear.As.Schmitty.html#1725" class="Function">reflectExtrap</a> <a id="1235" class="Symbol">(</a><a id="1236" href="Amethyst.PiecewiseLinear.Base.html#3005" class="Function">linearise</a> <a id="1246" href="Agda.Builtin.Float.html#1691" class="Primitive Operator">Float.e^_</a> <a id="1256" class="Number">-4.0</a> <a id="1261" class="Number">4.0</a> <a id="1265" class="Number">15</a><a id="1267" class="Symbol">)</a>

  <a id="lsigmoid"></a><a id="1272" href="Amethyst.Network.As.Schmitty.html#1272" class="Function">lsigmoid</a> <a id="1281" class="Symbol">:</a> <a id="1283" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1288" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a> <a id="1290" class="Symbol">→</a> <a id="1292" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1297" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a>
  <a id="1301" href="Amethyst.Network.As.Schmitty.html#1272" class="Function">lsigmoid</a> <a id="1310" href="Amethyst.Network.As.Schmitty.html#1310" class="Bound">x</a> <a id="1312" class="Symbol">=</a> <a id="1314" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1319" href="SMT.Theories.Reals.html#4847" class="InductiveConstructor">div</a> <a id="1323" class="Symbol">(</a><a id="1324" href="Amethyst.LinearAlgebra.As.Schmitty.html#714" class="Function">toReal</a> <a id="1331" class="Number">1.0</a><a id="1334" class="Symbol">)</a> <a id="1336" class="Symbol">(</a><a id="1337" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1342" href="SMT.Theories.Reals.html#4785" class="InductiveConstructor">add</a> <a id="1346" class="Symbol">(</a><a id="1347" href="Amethyst.LinearAlgebra.As.Schmitty.html#714" class="Function">toReal</a> <a id="1354" class="Number">1.0</a><a id="1357" class="Symbol">)</a> <a id="1359" class="Symbol">(</a><a id="1360" href="Amethyst.Network.As.Schmitty.html#1189" class="Function">lexp</a> <a id="1365" class="Symbol">(</a><a id="1366" href="SMT.Script.Base.html#1896" class="InductiveConstructor">app₁</a> <a id="1371" href="SMT.Theories.Reals.html#4723" class="InductiveConstructor">neg</a> <a id="1375" href="Amethyst.Network.As.Schmitty.html#1310" class="Bound">x</a><a id="1376" class="Symbol">)))</a>

  <a id="lsoftmax"></a><a id="1383" href="Amethyst.Network.As.Schmitty.html#1383" class="Function">lsoftmax</a> <a id="1392" class="Symbol">:</a> <a id="1394" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1398" class="Symbol">(</a><a id="1399" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1404" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a><a id="1405" class="Symbol">)</a> <a id="1407" href="Amethyst.Network.As.Schmitty.html#1083" class="Generalizable">n</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1415" class="Symbol">(</a><a id="1416" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1421" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a><a id="1422" class="Symbol">)</a> <a id="1424" href="Amethyst.Network.As.Schmitty.html#1083" class="Generalizable">n</a>
  <a id="1428" href="Amethyst.Network.As.Schmitty.html#1383" class="Function">lsoftmax</a> <a id="1437" href="Amethyst.Network.As.Schmitty.html#1437" class="Bound">xs</a> <a id="1440" class="Symbol">=</a> <a id="1442" href="Amethyst.LinearAlgebra.As.Schmitty.html#1578" class="Function">normalise</a> <a id="1452" class="Symbol">(</a><a id="1453" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1461" href="Amethyst.Network.As.Schmitty.html#1189" class="Function">lexp</a> <a id="1466" href="Amethyst.Network.As.Schmitty.html#1437" class="Bound">xs</a><a id="1468" class="Symbol">)</a>

  <a id="ltanh"></a><a id="1473" href="Amethyst.Network.As.Schmitty.html#1473" class="Function">ltanh</a> <a id="1479" class="Symbol">:</a> <a id="1481" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1486" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a> <a id="1488" class="Symbol">→</a> <a id="1490" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1495" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a>
  <a id="1499" href="Amethyst.Network.As.Schmitty.html#1473" class="Function">ltanh</a> <a id="1505" class="Symbol">=</a> <a id="1507" href="Amethyst.PiecewiseLinear.As.Schmitty.html#1725" class="Function">reflectExtrap</a> <a id="1521" class="Symbol">(</a><a id="1522" href="Amethyst.PiecewiseLinear.Base.html#3005" class="Function">linearise</a> <a id="1532" href="Agda.Builtin.Float.html#2194" class="Primitive">Float.tanh</a> <a id="1543" class="Number">-3.0</a> <a id="1548" class="Number">3.0</a> <a id="1552" class="Number">3</a><a id="1553" class="Symbol">)</a>

<a id="1556" class="Comment">-- |Convert activation functions to SMT terms.</a>
<a id="1603" class="Comment">--</a>
<a id="1606" class="Comment">--  Takes an activation function description and an environment of SMT terms</a>
<a id="1683" class="Comment">--  describing the activation function inputs, and returns an environment of SMT</a>
<a id="1764" class="Comment">--  terms with the activation function applied.</a>
<a id="reflectActivation"></a><a id="1812" href="Amethyst.Network.As.Schmitty.html#1812" class="Function">reflectActivation</a> <a id="1830" class="Symbol">:</a> <a id="1832" href="Amethyst.Network.Base.html#587" class="Datatype">Activation</a> <a id="1843" class="Symbol">→</a> <a id="1845" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1849" class="Symbol">(</a><a id="1850" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1855" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a><a id="1856" class="Symbol">)</a> <a id="1858" href="Amethyst.Network.As.Schmitty.html#1083" class="Generalizable">n</a> <a id="1860" class="Symbol">→</a> <a id="1862" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1866" class="Symbol">(</a><a id="1867" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1872" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a><a id="1873" class="Symbol">)</a> <a id="1875" href="Amethyst.Network.As.Schmitty.html#1083" class="Generalizable">n</a>
<a id="1877" href="Amethyst.Network.As.Schmitty.html#1812" class="Function">reflectActivation</a> <a id="1895" href="Amethyst.Network.Base.html#612" class="InductiveConstructor">Activation.linear</a>  <a id="1914" class="Symbol">=</a> <a id="1916" href="Function.Base.html#615" class="Function">id</a>
<a id="1919" href="Amethyst.Network.As.Schmitty.html#1812" class="Function">reflectActivation</a> <a id="1937" href="Amethyst.Network.Base.html#635" class="InductiveConstructor">Activation.relu</a>    <a id="1956" class="Symbol">=</a> <a id="1958" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1966" href="Amethyst.Network.As.Schmitty.html#1100" class="Function">relu</a>
<a id="1971" href="Amethyst.Network.As.Schmitty.html#1812" class="Function">reflectActivation</a> <a id="1989" href="Amethyst.Network.Base.html#658" class="InductiveConstructor">Activation.sigmoid</a> <a id="2008" class="Symbol">=</a> <a id="2010" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2018" href="Amethyst.Network.As.Schmitty.html#1272" class="Function">lsigmoid</a>
<a id="2027" href="Amethyst.Network.As.Schmitty.html#1812" class="Function">reflectActivation</a> <a id="2045" href="Amethyst.Network.Base.html#681" class="InductiveConstructor">Activation.softmax</a> <a id="2064" class="Symbol">=</a> <a id="2066" href="Amethyst.Network.As.Schmitty.html#1383" class="Function">lsoftmax</a>
<a id="2075" href="Amethyst.Network.As.Schmitty.html#1812" class="Function">reflectActivation</a> <a id="2093" href="Amethyst.Network.Base.html#704" class="InductiveConstructor">Activation.tanh</a>    <a id="2112" class="Symbol">=</a> <a id="2114" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2122" href="Amethyst.Network.As.Schmitty.html#1473" class="Function">ltanh</a>


<a id="2130" class="Comment">-- * Neural networks</a>

<a id="2152" class="Keyword">private</a>
  <a id="2162" class="Keyword">variable</a>
    <a id="2175" href="Amethyst.Network.As.Schmitty.html#2175" class="Generalizable">inputs</a>  <a id="2183" class="Symbol">:</a> <a id="2185" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2191" href="Amethyst.Network.As.Schmitty.html#2191" class="Generalizable">hidden</a>  <a id="2199" class="Symbol">:</a> <a id="2201" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2207" href="Amethyst.Network.As.Schmitty.html#2207" class="Generalizable">outputs</a> <a id="2215" class="Symbol">:</a> <a id="2217" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2223" href="Amethyst.Network.As.Schmitty.html#2223" class="Generalizable">layers</a>  <a id="2231" class="Symbol">:</a> <a id="2233" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="2236" class="Comment">-- |Convert layers to SMT terms.</a>
<a id="2269" class="Comment">--</a>
<a id="2272" class="Comment">--  Takes a layer description and an environment of SMT terms describing the</a>
<a id="2349" class="Comment">--  layer inputs, and returns an environment of SMT terms describing the layer</a>
<a id="2428" class="Comment">--  outputs.</a>
<a id="reflectLayer"></a><a id="2441" href="Amethyst.Network.As.Schmitty.html#2441" class="Function">reflectLayer</a> <a id="2454" class="Symbol">:</a> <a id="2456" href="Amethyst.Network.Base.html#733" class="Record">Layer</a> <a id="2462" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="2468" href="Amethyst.Network.As.Schmitty.html#2175" class="Generalizable">inputs</a> <a id="2475" href="Amethyst.Network.As.Schmitty.html#2207" class="Generalizable">outputs</a> <a id="2483" class="Symbol">→</a> <a id="2485" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2489" class="Symbol">(</a><a id="2490" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="2495" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a><a id="2496" class="Symbol">)</a> <a id="2498" href="Amethyst.Network.As.Schmitty.html#2175" class="Generalizable">inputs</a> <a id="2505" class="Symbol">→</a> <a id="2507" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2511" class="Symbol">(</a><a id="2512" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="2517" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a><a id="2518" class="Symbol">)</a> <a id="2520" href="Amethyst.Network.As.Schmitty.html#2207" class="Generalizable">outputs</a>
<a id="2528" href="Amethyst.Network.As.Schmitty.html#2441" class="Function">reflectLayer</a> <a id="2541" href="Amethyst.Network.As.Schmitty.html#2541" class="Bound">l</a> <a id="2543" href="Amethyst.Network.As.Schmitty.html#2543" class="Bound">xs</a> <a id="2546" class="Symbol">=</a> <a id="2548" href="Amethyst.Network.As.Schmitty.html#1812" class="Function">reflectActivation</a> <a id="2566" href="Amethyst.Network.Base.html#794" class="Function">activation</a> <a id="2577" class="Symbol">(</a><a id="2578" href="Amethyst.Network.As.Schmitty.html#2672" class="Function">biases′</a> <a id="2586" href="Amethyst.LinearAlgebra.As.Schmitty.html#1170" class="Function Operator">⊕</a> <a id="2588" class="Symbol">(</a><a id="2589" href="Amethyst.Network.As.Schmitty.html#2543" class="Bound">xs</a> <a id="2592" href="Amethyst.LinearAlgebra.As.Schmitty.html#1770" class="Function Operator">v⊡m</a> <a id="2596" href="Amethyst.Network.As.Schmitty.html#2709" class="Function">weights′</a><a id="2604" class="Symbol">))</a>
  <a id="2609" class="Keyword">where</a>
    <a id="2619" class="Keyword">open</a> <a id="2624" href="Amethyst.Network.Base.html#733" class="Module">Layer</a> <a id="2630" href="Amethyst.Network.As.Schmitty.html#2541" class="Bound">l</a> <a id="2632" class="Keyword">using</a> <a id="2638" class="Symbol">(</a><a id="2639" href="Amethyst.Network.Base.html#794" class="Field">activation</a><a id="2649" class="Symbol">;</a> <a id="2651" href="Amethyst.Network.Base.html#822" class="Field">weights</a><a id="2658" class="Symbol">;</a> <a id="2660" href="Amethyst.Network.Base.html#866" class="Field">biases</a><a id="2666" class="Symbol">)</a>
    <a id="2672" href="Amethyst.Network.As.Schmitty.html#2672" class="Function">biases′</a>  <a id="2681" class="Symbol">=</a> <a id="2683" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2691" href="Amethyst.LinearAlgebra.As.Schmitty.html#714" class="Function">toReal</a> <a id="2698" href="Amethyst.Network.Base.html#866" class="Function">biases</a>
    <a id="2709" href="Amethyst.Network.As.Schmitty.html#2709" class="Function">weights′</a> <a id="2718" class="Symbol">=</a> <a id="2720" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2728" class="Symbol">(</a><a id="2729" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2737" href="Amethyst.LinearAlgebra.As.Schmitty.html#714" class="Function">toReal</a><a id="2743" class="Symbol">)</a> <a id="2745" href="Amethyst.Network.Base.html#822" class="Function">weights</a>

<a id="2754" class="Comment">-- |Convert networks to SMT terms.</a>
<a id="2789" class="Comment">--</a>
<a id="2792" class="Comment">--  Takes a network description and an environment of SMT terms describing the</a>
<a id="2871" class="Comment">--  network inputs, and returns an environment of SMT terms describing the network</a>
<a id="2954" class="Comment">--  outputs.</a>
<a id="reflectNetwork"></a><a id="2967" href="Amethyst.Network.As.Schmitty.html#2967" class="Function">reflectNetwork</a> <a id="2982" class="Symbol">:</a> <a id="2984" href="Amethyst.Network.Base.html#913" class="Datatype">Network</a> <a id="2992" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="2998" href="Amethyst.Network.As.Schmitty.html#2175" class="Generalizable">inputs</a> <a id="3005" href="Amethyst.Network.As.Schmitty.html#2207" class="Generalizable">outputs</a> <a id="3013" href="Amethyst.Network.As.Schmitty.html#2223" class="Generalizable">layers</a> <a id="3020" class="Symbol">→</a> <a id="3022" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3026" class="Symbol">(</a><a id="3027" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="3032" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a><a id="3033" class="Symbol">)</a> <a id="3035" href="Amethyst.Network.As.Schmitty.html#2175" class="Generalizable">inputs</a> <a id="3042" class="Symbol">→</a> <a id="3044" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3048" class="Symbol">(</a><a id="3049" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="3054" href="Amethyst.Network.As.Schmitty.html#1070" class="Generalizable">Γ</a><a id="3055" class="Symbol">)</a> <a id="3057" href="Amethyst.Network.As.Schmitty.html#2207" class="Generalizable">outputs</a>
<a id="3065" href="Amethyst.Network.As.Schmitty.html#2967" class="Function">reflectNetwork</a> <a id="3080" href="Amethyst.Network.Base.html#981" class="InductiveConstructor">[]</a>      <a id="3088" class="Symbol">=</a> <a id="3090" href="Function.Base.html#615" class="Function">id</a>
<a id="3093" href="Amethyst.Network.As.Schmitty.html#2967" class="Function">reflectNetwork</a> <a id="3108" class="Symbol">(</a><a id="3109" href="Amethyst.Network.As.Schmitty.html#3109" class="Bound">l</a> <a id="3111" href="Amethyst.Network.Base.html#1015" class="InductiveConstructor Operator">∷</a> <a id="3113" href="Amethyst.Network.As.Schmitty.html#3113" class="Bound">n</a><a id="3114" class="Symbol">)</a> <a id="3116" class="Symbol">=</a> <a id="3118" href="Amethyst.Network.As.Schmitty.html#2967" class="Function">reflectNetwork</a> <a id="3133" href="Amethyst.Network.As.Schmitty.html#3113" class="Bound">n</a> <a id="3135" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3137" href="Amethyst.Network.As.Schmitty.html#2441" class="Function">reflectLayer</a> <a id="3150" href="Amethyst.Network.As.Schmitty.html#3109" class="Bound">l</a>

<a id="3153" class="Keyword">private</a>
  <a id="3163" class="Comment">-- |The reverse-append of two reversed lists is equivalent to the append of the lists.</a>
  <a id="3252" class="Comment">--</a>
  <a id="3257" class="Comment">--  NOTE: The variable contexts for a Script are in reversed order, so we pass</a>
  <a id="3338" class="Comment">--        the reversed input/output contexts to `declare-consts` to ensure</a>
  <a id="3415" class="Comment">--        that we end up with *doubly* reversed contexts in the Script.</a>
  <a id="3489" class="Comment">--        We use this lemma to show that the doubly reversed contexts are</a>
  <a id="3565" class="Comment">--        equivalent to the original input/output context.</a>
  <a id="3626" class="Comment">--</a>
  <a id="3631" class="Comment">--  NOTE: Perhaps this lemma should be submitted to Data.List.Properties?</a>
  <a id="3707" class="Comment">--</a>
  <a id="ʳ++-reverse"></a><a id="3712" href="Amethyst.Network.As.Schmitty.html#3712" class="Function">ʳ++-reverse</a> <a id="3724" class="Symbol">:</a> <a id="3726" class="Symbol">∀</a> <a id="3728" class="Symbol">{</a><a id="3729" href="Amethyst.Network.As.Schmitty.html#3729" class="Bound">a</a><a id="3730" class="Symbol">}</a> <a id="3732" class="Symbol">{</a><a id="3733" href="Amethyst.Network.As.Schmitty.html#3733" class="Bound">A</a> <a id="3735" class="Symbol">:</a> <a id="3737" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3741" href="Amethyst.Network.As.Schmitty.html#3729" class="Bound">a</a><a id="3742" class="Symbol">}</a> <a id="3744" class="Symbol">(</a><a id="3745" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">xs</a> <a id="3748" href="Amethyst.Network.As.Schmitty.html#3748" class="Bound">ys</a> <a id="3751" class="Symbol">:</a> <a id="3753" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3758" href="Amethyst.Network.As.Schmitty.html#3733" class="Bound">A</a><a id="3759" class="Symbol">)</a> <a id="3761" class="Symbol">→</a> <a id="3763" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3776" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">xs</a> <a id="3779" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="3783" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3796" href="Amethyst.Network.As.Schmitty.html#3748" class="Bound">ys</a>  <a id="3800" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="3804" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="3807" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3809" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">xs</a> <a id="3812" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="3815" href="Amethyst.Network.As.Schmitty.html#3748" class="Bound">ys</a>
  <a id="3820" href="Amethyst.Network.As.Schmitty.html#3712" class="Function">ʳ++-reverse</a> <a id="3832" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a> <a id="3835" href="Amethyst.Network.As.Schmitty.html#3835" class="Bound">ys</a> <a id="3838" class="Symbol">=</a>
    <a id="3844" href="Relation.Binary.PropositionalEquality.Core.html#2745" class="Function Operator">begin</a>
      <a id="3856" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3869" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a> <a id="3872" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="3876" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3889" href="Amethyst.Network.As.Schmitty.html#3835" class="Bound">ys</a> <a id="3892" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="3896" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="3903" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="3906" href="Data.List.Properties.html#30377" class="Function">List.ʳ++-defn</a> <a id="3920" class="Symbol">(</a><a id="3921" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3934" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a><a id="3936" class="Symbol">)</a> <a id="3938" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="3946" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3959" class="Symbol">(</a><a id="3960" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3973" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a><a id="3975" class="Symbol">)</a> <a id="3977" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="3980" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3993" href="Amethyst.Network.As.Schmitty.html#3835" class="Bound">ys</a>  <a id="3997" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4001" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4008" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4011" href="Data.List.Properties.html#33859" class="Function">List.reverse-involutive</a> <a id="4035" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a> <a id="4038" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4041" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4049" class="Symbol">(</a><a id="4050" href="Data.List.Base.html#1763" class="Function Operator">_++</a> <a id="4054" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4067" href="Amethyst.Network.As.Schmitty.html#3835" class="Bound">ys</a> <a id="4070" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4074" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4076" class="Symbol">)</a> <a id="4078" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4086" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a> <a id="4089" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4092" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4105" href="Amethyst.Network.As.Schmitty.html#3835" class="Bound">ys</a> <a id="4108" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4112" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4119" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4122" href="Data.List.Properties.html#30377" class="Function">List.ʳ++-defn</a> <a id="4136" class="Symbol">(</a><a id="4137" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4150" href="Amethyst.Network.As.Schmitty.html#3835" class="Bound">ys</a><a id="4152" class="Symbol">)</a> <a id="4154" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4157" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4165" class="Symbol">(</a><a id="4166" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a> <a id="4169" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4172" class="Symbol">)</a> <a id="4174" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4182" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a> <a id="4185" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4188" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4201" class="Symbol">(</a><a id="4202" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4215" href="Amethyst.Network.As.Schmitty.html#3835" class="Bound">ys</a><a id="4217" class="Symbol">)</a> <a id="4219" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4222" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4229" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4232" href="Data.List.Properties.html#33859" class="Function">List.reverse-involutive</a> <a id="4256" href="Amethyst.Network.As.Schmitty.html#3835" class="Bound">ys</a> <a id="4259" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4262" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4270" class="Symbol">((</a><a id="4272" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a> <a id="4275" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4278" class="Symbol">)</a> <a id="4280" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4282" class="Symbol">(</a><a id="4283" href="Data.List.Base.html#1763" class="Function Operator">_++</a> <a id="4287" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4289" class="Symbol">))</a> <a id="4292" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4300" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a> <a id="4303" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4306" href="Amethyst.Network.As.Schmitty.html#3835" class="Bound">ys</a> <a id="4309" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4312" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4319" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4322" href="Data.List.Properties.html#5554" class="Function">List.++-identityʳ</a> <a id="4340" href="Amethyst.Network.As.Schmitty.html#3835" class="Bound">ys</a> <a id="4343" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4346" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4354" class="Symbol">(</a><a id="4355" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a> <a id="4358" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4361" class="Symbol">)</a> <a id="4363" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4371" href="Amethyst.Network.As.Schmitty.html#3832" class="Bound">xs</a> <a id="4374" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4377" href="Amethyst.Network.As.Schmitty.html#3835" class="Bound">ys</a>
    <a id="4384" href="Relation.Binary.PropositionalEquality.Core.html#3044" class="Function Operator">∎</a>

<a id="4387" class="Comment">-- |Convert networks to SMT scripts.</a>
<a id="reflectNetworkAsScript"></a><a id="4424" href="Amethyst.Network.As.Schmitty.html#4424" class="Function">reflectNetworkAsScript</a> <a id="4447" class="Symbol">:</a> <a id="4449" href="Amethyst.Network.Base.html#913" class="Datatype">Network</a> <a id="4457" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="4463" href="Amethyst.Network.As.Schmitty.html#2175" class="Generalizable">inputs</a> <a id="4470" href="Amethyst.Network.As.Schmitty.html#2207" class="Generalizable">outputs</a> <a id="4478" href="Amethyst.Network.As.Schmitty.html#2223" class="Generalizable">layers</a> <a id="4485" class="Symbol">→</a> <a id="4487" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="4494" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4497" class="Symbol">(</a><a id="4498" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="4504" href="Amethyst.Network.As.Schmitty.html#2175" class="Generalizable">inputs</a> <a id="4511" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4514" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="4520" href="Amethyst.Network.As.Schmitty.html#2207" class="Generalizable">outputs</a><a id="4527" class="Symbol">)</a> <a id="4529" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="4532" href="Amethyst.Network.As.Schmitty.html#4424" class="Function">reflectNetworkAsScript</a> <a id="4555" class="Symbol">{</a><a id="4556" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a><a id="4562" class="Symbol">}</a> <a id="4564" class="Symbol">{</a><a id="4565" href="Amethyst.Network.As.Schmitty.html#4565" class="Bound">outputs</a><a id="4572" class="Symbol">}</a> <a id="4574" href="Amethyst.Network.As.Schmitty.html#4574" class="Bound">n</a>
  <a id="4578" class="Symbol">=</a> <a id="4580" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a> <a id="4589" class="Symbol">(λ</a> <a id="4592" href="Amethyst.Network.As.Schmitty.html#4592" class="Bound">Γ</a> <a id="4594" class="Symbol">→</a> <a id="4596" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="4603" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4606" href="Amethyst.Network.As.Schmitty.html#4592" class="Bound">Γ</a> <a id="4608" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4610" class="Symbol">)</a> <a id="4612" class="Symbol">(</a><a id="4613" href="Amethyst.Network.As.Schmitty.html#3712" class="Function">ʳ++-reverse</a> <a id="4625" class="Symbol">(</a><a id="4626" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="4632" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a><a id="4638" class="Symbol">)</a> <a id="4640" class="Symbol">(</a><a id="4641" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="4647" href="Amethyst.Network.As.Schmitty.html#4565" class="Bound">outputs</a><a id="4654" class="Symbol">))</a>
  <a id="4659" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4661" href="SMT.Script.Base.html#8648" class="Function">declare-consts</a> <a id="4676" class="Symbol">(</a><a id="4677" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4690" class="Symbol">(</a><a id="4691" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="4697" href="Amethyst.Network.As.Schmitty.html#4565" class="Bound">outputs</a><a id="4704" class="Symbol">))</a>
  <a id="4709" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4711" href="SMT.Script.Base.html#8648" class="Function">declare-consts</a> <a id="4726" class="Symbol">(</a><a id="4727" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4740" class="Symbol">(</a><a id="4741" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="4747" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a><a id="4753" class="Symbol">))</a>
  <a id="4758" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4760" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a>
      <a id="4773" class="Symbol">(</a><a id="4774" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="4784" class="Symbol">_</a>
        <a id="4794" class="Symbol">(</a><a id="4795" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="4800" href="SMT.Theories.Core.Extensions.html#1401" class="Function">and</a><a id="4803" class="Symbol">)</a>
        <a id="4813" class="Symbol">(</a><a id="4814" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="4818" class="Symbol">(</a><a id="4819" href="SMT.Theories.Core.Extensions.html#955" class="Function">bool</a> <a id="4824" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="4828" class="Symbol">))</a>
        <a id="4839" class="Symbol">(</a><a id="4840" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a>
          <a id="4862" class="Symbol">(</a><a id="4863" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="4868" href="SMT.Theories.Reals.html#4615" class="InductiveConstructor">eq</a><a id="4870" class="Symbol">)</a>
          <a id="4882" class="Symbol">(</a><a id="4883" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a>
            <a id="4904" class="Symbol">(λ</a> <a id="4907" href="Amethyst.Network.As.Schmitty.html#4907" class="Bound">Γ</a> <a id="4909" class="Symbol">→</a> <a id="4911" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4915" class="Symbol">(</a><a id="4916" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="4921" href="Amethyst.Network.As.Schmitty.html#4907" class="Bound">Γ</a><a id="4922" class="Symbol">)</a> <a id="4924" href="Amethyst.Network.As.Schmitty.html#4565" class="Bound">outputs</a><a id="4931" class="Symbol">)</a>
            <a id="4945" class="Symbol">(</a><a id="4946" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">Eq.sym</a> <a id="4953" class="Symbol">(</a><a id="4954" href="Amethyst.Network.As.Schmitty.html#3712" class="Function">ʳ++-reverse</a> <a id="4966" class="Symbol">(</a><a id="4967" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="4973" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a><a id="4979" class="Symbol">)</a> <a id="4981" class="Symbol">(</a><a id="4982" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="4988" href="Amethyst.Network.As.Schmitty.html#4565" class="Bound">outputs</a><a id="4995" class="Symbol">)))</a>
            <a id="5011" href="Amethyst.Network.As.Schmitty.html#5382" class="Function">outputVec</a><a id="5020" class="Symbol">)</a>
          <a id="5032" class="Symbol">(</a><a id="5033" href="Amethyst.Network.As.Schmitty.html#2967" class="Function">reflectNetwork</a> <a id="5048" href="Amethyst.Network.As.Schmitty.html#4574" class="Bound">n</a>
            <a id="5062" class="Symbol">(</a><a id="5063" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a>
              <a id="5086" class="Symbol">(λ</a> <a id="5089" href="Amethyst.Network.As.Schmitty.html#5089" class="Bound">Γ</a> <a id="5091" class="Symbol">→</a> <a id="5093" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5097" class="Symbol">(</a><a id="5098" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="5103" href="Amethyst.Network.As.Schmitty.html#5089" class="Bound">Γ</a><a id="5104" class="Symbol">)</a> <a id="5106" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a><a id="5112" class="Symbol">)</a>
              <a id="5128" class="Symbol">(</a><a id="5129" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">Eq.sym</a> <a id="5136" class="Symbol">(</a><a id="5137" href="Amethyst.Network.As.Schmitty.html#3712" class="Function">ʳ++-reverse</a> <a id="5149" class="Symbol">(</a><a id="5150" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="5156" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a><a id="5162" class="Symbol">)</a> <a id="5164" class="Symbol">(</a><a id="5165" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="5171" href="Amethyst.Network.As.Schmitty.html#4565" class="Bound">outputs</a><a id="5178" class="Symbol">)))</a>
              <a id="5196" href="Amethyst.Network.As.Schmitty.html#5228" class="Function">inputVec</a><a id="5204" class="Symbol">))))</a>
  <a id="5211" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="5213" href="SMT.Script.Base.html#8084" class="InductiveConstructor">[]</a>
  <a id="5218" class="Keyword">where</a>
    <a id="5228" href="Amethyst.Network.As.Schmitty.html#5228" class="Function">inputVec</a> <a id="5237" class="Symbol">:</a> <a id="5239" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5243" class="Symbol">(</a><a id="5244" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="5249" class="Symbol">(</a><a id="5250" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="5256" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a> <a id="5263" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="5266" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="5272" href="Amethyst.Network.As.Schmitty.html#4565" class="Bound">outputs</a><a id="5279" class="Symbol">))</a> <a id="5282" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a>
    <a id="5293" href="Amethyst.Network.As.Schmitty.html#5228" class="Function">inputVec</a> <a id="5302" class="Symbol">=</a> <a id="5304" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="5312" class="Symbol">(</a><a id="5313" href="SMT.Script.Base.html#1517" class="InductiveConstructor">var</a> <a id="5317" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5319" href="SMT.Script.Base.html#3034" class="Function">injectVar</a> <a id="5329" class="Symbol">(</a><a id="5330" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="5336" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a><a id="5342" class="Symbol">)</a> <a id="5344" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5346" href="Amethyst.LinearAlgebra.As.Schmitty.html#920" class="Function">Reals∋Real</a><a id="5356" class="Symbol">)</a> <a id="5358" class="Symbol">(</a><a id="5359" href="Data.Vec.Base.html#5972" class="Function">Vec.allFin</a> <a id="5370" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a><a id="5376" class="Symbol">)</a>
    <a id="5382" href="Amethyst.Network.As.Schmitty.html#5382" class="Function">outputVec</a> <a id="5392" class="Symbol">:</a> <a id="5394" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5398" class="Symbol">(</a><a id="5399" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="5404" class="Symbol">(</a><a id="5405" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="5411" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a> <a id="5418" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="5421" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="5427" href="Amethyst.Network.As.Schmitty.html#4565" class="Bound">outputs</a><a id="5434" class="Symbol">))</a> <a id="5437" href="Amethyst.Network.As.Schmitty.html#4565" class="Bound">outputs</a>
    <a id="5449" href="Amethyst.Network.As.Schmitty.html#5382" class="Function">outputVec</a> <a id="5459" class="Symbol">=</a> <a id="5461" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="5469" class="Symbol">(</a><a id="5470" href="SMT.Script.Base.html#1517" class="InductiveConstructor">var</a> <a id="5474" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5476" href="SMT.Script.Base.html#3189" class="Function">raiseVar</a> <a id="5485" class="Symbol">(</a><a id="5486" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="5492" href="Amethyst.Network.As.Schmitty.html#4556" class="Bound">inputs</a><a id="5498" class="Symbol">)</a> <a id="5500" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5502" href="Amethyst.LinearAlgebra.As.Schmitty.html#920" class="Function">Reals∋Real</a><a id="5512" class="Symbol">)</a> <a id="5514" class="Symbol">(</a><a id="5515" href="Data.Vec.Base.html#5972" class="Function">Vec.allFin</a> <a id="5526" href="Amethyst.Network.As.Schmitty.html#4565" class="Bound">outputs</a><a id="5533" class="Symbol">)</a>
</pre></body></html>