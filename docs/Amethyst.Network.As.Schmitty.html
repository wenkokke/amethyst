<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.Network.As.Schmitty</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst: Neural Network Verification in Agda</a>
<a id="131" class="Comment">--</a>
<a id="134" class="Comment">-- This module contains functions to reflect networks as Schmitty terms. It also</a>
<a id="215" class="Comment">-- provides the `withReflectedNetwork` function, which reflects a network as a</a>
<a id="294" class="Comment">-- Schmitty term, and wraps that term in a script which declares the appropriate</a>
<a id="375" class="Comment">-- constants for the inputs and outputs, and allows the caller to append further</a>
<a id="456" class="Comment">-- portions of script.</a>
<a id="479" class="Comment">--</a>
<a id="482" class="Comment">-- Exports:</a>
<a id="494" class="Comment">--</a>
<a id="497" class="Comment">--   - reflectActivation</a>
<a id="522" class="Comment">--   - reflectLayer</a>
<a id="542" class="Comment">--   - reflectNetwork</a>
<a id="564" class="Comment">--   - withReflectedNetworkAsScript</a>
<a id="600" class="Comment">--</a>
<a id="603" class="Comment">--------------------------------------------------------------------------------</a>
<a id="684" class="Keyword">module</a> <a id="691" href="Amethyst.Network.As.Schmitty.html" class="Module">Amethyst.Network.As.Schmitty</a> <a id="720" class="Keyword">where</a>

<a id="727" class="Keyword">open</a> <a id="732" class="Keyword">import</a> <a id="739" href="Amethyst.Network.Base.html" class="Module">Amethyst.Network.Base</a> <a id="761" class="Keyword">using</a> <a id="767" class="Symbol">(</a><a id="768" href="Amethyst.Network.Base.html#1123" class="Datatype">Network</a><a id="775" class="Symbol">;</a> <a id="777" href="Amethyst.Network.Base.html#1191" class="InductiveConstructor">[]</a><a id="779" class="Symbol">;</a> <a id="781" href="Amethyst.Network.Base.html#1225" class="InductiveConstructor Operator">_∷_</a><a id="784" class="Symbol">;</a> <a id="786" href="Amethyst.Network.Base.html#943" class="Record">Layer</a><a id="791" class="Symbol">;</a> <a id="793" href="Amethyst.Network.Base.html#797" class="Datatype">Activation</a><a id="803" class="Symbol">)</a>
<a id="805" class="Keyword">open</a> <a id="810" class="Keyword">import</a> <a id="817" href="Amethyst.PiecewiseLinear.Base.html" class="Module">Amethyst.PiecewiseLinear.Base</a>
<a id="847" class="Keyword">open</a> <a id="852" class="Keyword">import</a> <a id="859" href="Amethyst.PiecewiseLinear.As.Schmitty.html" class="Module">Amethyst.PiecewiseLinear.As.Schmitty</a>
<a id="896" class="Keyword">open</a> <a id="901" class="Keyword">import</a> <a id="908" href="Amethyst.LinearAlgebra.As.Schmitty.html" class="Module">Amethyst.LinearAlgebra.As.Schmitty</a>
<a id="943" class="Keyword">open</a> <a id="948" class="Keyword">import</a> <a id="955" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="965" class="Symbol">as</a> <a id="968" class="Module">Bool</a> <a id="973" class="Keyword">using</a> <a id="979" class="Symbol">(</a><a id="980" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="984" class="Symbol">;</a> <a id="986" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="991" class="Symbol">;</a> <a id="993" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="997" class="Symbol">)</a>
<a id="999" class="Keyword">open</a> <a id="1004" class="Keyword">import</a> <a id="1011" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="1020" class="Symbol">as</a> <a id="1023" class="Module">Fin</a> <a id="1027" class="Keyword">using</a> <a id="1033" class="Symbol">(</a><a id="1034" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="1037" class="Symbol">;</a> <a id="1039" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a><a id="1043" class="Symbol">;</a> <a id="1045" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a><a id="1048" class="Symbol">)</a>
<a id="1050" class="Keyword">open</a> <a id="1055" class="Keyword">import</a> <a id="1062" href="Data.Float.html" class="Module">Data.Float</a> <a id="1073" class="Symbol">as</a> <a id="1076" class="Module">Float</a> <a id="1082" class="Keyword">using</a> <a id="1088" class="Symbol">(</a><a id="1089" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="1094" class="Symbol">)</a>
<a id="1096" class="Keyword">open</a> <a id="1101" class="Keyword">import</a> <a id="1108" href="Data.List.html" class="Module">Data.List</a> <a id="1118" class="Symbol">as</a> <a id="1121" class="Module">List</a> <a id="1126" class="Keyword">using</a> <a id="1132" class="Symbol">(</a><a id="1133" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="1137" class="Symbol">;</a> <a id="1139" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="1141" class="Symbol">;</a> <a id="1143" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="1146" class="Symbol">;</a> <a id="1148" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="1152" class="Symbol">;</a> <a id="1154" href="Data.List.Base.html#9558" class="Function Operator">_ʳ++_</a><a id="1159" class="Symbol">)</a>
<a id="1161" class="Keyword">import</a> <a id="1168" href="Data.List.Properties.html" class="Module">Data.List.Properties</a> <a id="1189" class="Symbol">as</a> <a id="1192" class="Module">List</a>
<a id="1197" class="Keyword">open</a> <a id="1202" class="Keyword">import</a> <a id="1209" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="1218" class="Symbol">as</a> <a id="1221" class="Module">Nat</a> <a id="1225" class="Keyword">using</a> <a id="1231" class="Symbol">(</a><a id="1232" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1233" class="Symbol">;</a> <a id="1235" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1239" class="Symbol">;</a> <a id="1241" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="1244" class="Symbol">)</a>
<a id="1246" class="Keyword">open</a> <a id="1251" class="Keyword">import</a> <a id="1258" href="Data.Product.html" class="Module">Data.Product</a> <a id="1271" class="Symbol">as</a> <a id="1274" class="Module">Prod</a> <a id="1279" class="Keyword">using</a> <a id="1285" class="Symbol">(</a><a id="1286" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="1289" class="Symbol">;</a> <a id="1291" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="1294" class="Symbol">;</a> <a id="1296" href="Data.Product.html#3399" class="Function">uncurry</a><a id="1303" class="Symbol">)</a>
<a id="1305" class="Keyword">open</a> <a id="1310" class="Keyword">import</a> <a id="1317" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1326" class="Symbol">as</a> <a id="1329" class="Module">Vec</a> <a id="1333" class="Keyword">using</a> <a id="1339" class="Symbol">(</a><a id="1340" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="1343" class="Symbol">;</a> <a id="1345" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1347" class="Symbol">;</a> <a id="1349" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="1352" class="Symbol">)</a>
<a id="1354" class="Keyword">open</a> <a id="1359" class="Keyword">import</a> <a id="1366" href="Function.html" class="Module">Function</a> <a id="1375" class="Keyword">using</a> <a id="1381" class="Symbol">(</a><a id="1382" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="1385" class="Symbol">;</a> <a id="1387" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="1390" class="Symbol">;</a> <a id="1392" href="Function.Base.html#2210" class="Function Operator">_|&gt;_</a><a id="1396" class="Symbol">;</a> <a id="1398" href="Function.Base.html#615" class="Function">id</a><a id="1400" class="Symbol">)</a>
<a id="1402" class="Keyword">open</a> <a id="1407" class="Keyword">import</a> <a id="1414" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1452" class="Symbol">as</a> <a id="1455" class="Module">Eq</a> <a id="1458" class="Keyword">using</a> <a id="1464" class="Symbol">(</a><a id="1465" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="1468" class="Symbol">;</a> <a id="1470" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1474" class="Symbol">)</a>
<a id="1476" class="Keyword">open</a> <a id="1481" href="Relation.Binary.PropositionalEquality.Core.html#2647" class="Module">Eq.≡-Reasoning</a>

<a id="1497" class="Comment">-- * Activation functions</a>

<a id="1524" class="Keyword">private</a>
  <a id="1534" class="Keyword">variable</a>
    <a id="1547" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a> <a id="1549" class="Symbol">:</a> <a id="1551" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a>
    <a id="1560" href="Amethyst.Network.As.Schmitty.html#1560" class="Generalizable">n</a> <a id="1562" class="Symbol">:</a> <a id="1564" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1567" class="Keyword">private</a>
  <a id="relu"></a><a id="1577" href="Amethyst.Network.As.Schmitty.html#1577" class="Function">relu</a> <a id="1582" class="Symbol">:</a> <a id="1584" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1589" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a> <a id="1591" class="Symbol">→</a> <a id="1593" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1598" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a>
  <a id="1602" href="Amethyst.Network.As.Schmitty.html#1577" class="Function">relu</a> <a id="1607" href="Amethyst.Network.As.Schmitty.html#1607" class="Bound">x</a> <a id="1609" class="Symbol">=</a> <a id="1611" href="SMT.Script.Base.html#1976" class="InductiveConstructor">app₃</a> <a id="1616" href="SMT.Theories.Reals.html#4677" class="InductiveConstructor">ite</a> <a id="1620" class="Symbol">(</a><a id="1621" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1626" href="SMT.Theories.Reals.html#4878" class="InductiveConstructor">leq</a> <a id="1630" href="Amethyst.Network.As.Schmitty.html#1607" class="Bound">x</a> <a id="1632" class="Symbol">(</a><a id="1633" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="1637" class="Symbol">(</a><a id="1638" href="SMT.Theories.Reals.html#3769" class="InductiveConstructor">nat</a> <a id="1642" class="Number">0</a><a id="1643" class="Symbol">)))</a> <a id="1647" class="Symbol">(</a><a id="1648" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="1652" class="Symbol">(</a><a id="1653" href="SMT.Theories.Reals.html#3769" class="InductiveConstructor">nat</a> <a id="1657" class="Number">0</a><a id="1658" class="Symbol">))</a> <a id="1661" href="Amethyst.Network.As.Schmitty.html#1607" class="Bound">x</a>

  <a id="lexp"></a><a id="1666" href="Amethyst.Network.As.Schmitty.html#1666" class="Function">lexp</a> <a id="1671" class="Symbol">:</a> <a id="1673" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1678" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a> <a id="1680" class="Symbol">→</a> <a id="1682" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1687" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a>
  <a id="1691" href="Amethyst.Network.As.Schmitty.html#1666" class="Function">lexp</a> <a id="1696" class="Symbol">=</a> <a id="1698" href="Amethyst.PiecewiseLinear.As.Schmitty.html#2046" class="Function">reflectExtrap</a> <a id="1712" class="Symbol">(</a><a id="1713" href="Amethyst.PiecewiseLinear.Base.html#4520" class="Function">linearise</a> <a id="1723" href="Agda.Builtin.Float.html#1691" class="Primitive Operator">Float.e^_</a> <a id="1733" class="Number">-4.0</a> <a id="1738" class="Number">4.0</a> <a id="1742" class="Number">15</a><a id="1744" class="Symbol">)</a>

  <a id="lsigmoid"></a><a id="1749" href="Amethyst.Network.As.Schmitty.html#1749" class="Function">lsigmoid</a> <a id="1758" class="Symbol">:</a> <a id="1760" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1765" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a> <a id="1767" class="Symbol">→</a> <a id="1769" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1774" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a>
  <a id="1778" href="Amethyst.Network.As.Schmitty.html#1749" class="Function">lsigmoid</a> <a id="1787" href="Amethyst.Network.As.Schmitty.html#1787" class="Bound">x</a> <a id="1789" class="Symbol">=</a> <a id="1791" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1796" href="SMT.Theories.Reals.html#4847" class="InductiveConstructor">div</a> <a id="1800" class="Symbol">(</a><a id="1801" href="Amethyst.LinearAlgebra.As.Schmitty.html#1204" class="Function">toReal</a> <a id="1808" class="Number">1.0</a><a id="1811" class="Symbol">)</a> <a id="1813" class="Symbol">(</a><a id="1814" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1819" href="SMT.Theories.Reals.html#4785" class="InductiveConstructor">add</a> <a id="1823" class="Symbol">(</a><a id="1824" href="Amethyst.LinearAlgebra.As.Schmitty.html#1204" class="Function">toReal</a> <a id="1831" class="Number">1.0</a><a id="1834" class="Symbol">)</a> <a id="1836" class="Symbol">(</a><a id="1837" href="Amethyst.Network.As.Schmitty.html#1666" class="Function">lexp</a> <a id="1842" class="Symbol">(</a><a id="1843" href="SMT.Script.Base.html#1896" class="InductiveConstructor">app₁</a> <a id="1848" href="SMT.Theories.Reals.html#4723" class="InductiveConstructor">neg</a> <a id="1852" href="Amethyst.Network.As.Schmitty.html#1787" class="Bound">x</a><a id="1853" class="Symbol">)))</a>

  <a id="lsoftmax"></a><a id="1860" href="Amethyst.Network.As.Schmitty.html#1860" class="Function">lsoftmax</a> <a id="1869" class="Symbol">:</a> <a id="1871" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1875" class="Symbol">(</a><a id="1876" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1881" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a><a id="1882" class="Symbol">)</a> <a id="1884" href="Amethyst.Network.As.Schmitty.html#1560" class="Generalizable">n</a> <a id="1886" class="Symbol">→</a> <a id="1888" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1892" class="Symbol">(</a><a id="1893" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1898" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a><a id="1899" class="Symbol">)</a> <a id="1901" href="Amethyst.Network.As.Schmitty.html#1560" class="Generalizable">n</a>
  <a id="1905" href="Amethyst.Network.As.Schmitty.html#1860" class="Function">lsoftmax</a> <a id="1914" href="Amethyst.Network.As.Schmitty.html#1914" class="Bound">xs</a> <a id="1917" class="Symbol">=</a> <a id="1919" href="Amethyst.LinearAlgebra.As.Schmitty.html#2068" class="Function">normalise</a> <a id="1929" class="Symbol">(</a><a id="1930" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1938" href="Amethyst.Network.As.Schmitty.html#1666" class="Function">lexp</a> <a id="1943" href="Amethyst.Network.As.Schmitty.html#1914" class="Bound">xs</a><a id="1945" class="Symbol">)</a>

  <a id="ltanh"></a><a id="1950" href="Amethyst.Network.As.Schmitty.html#1950" class="Function">ltanh</a> <a id="1956" class="Symbol">:</a> <a id="1958" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1963" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a> <a id="1965" class="Symbol">→</a> <a id="1967" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1972" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a>
  <a id="1976" href="Amethyst.Network.As.Schmitty.html#1950" class="Function">ltanh</a> <a id="1982" class="Symbol">=</a> <a id="1984" href="Amethyst.PiecewiseLinear.As.Schmitty.html#2046" class="Function">reflectExtrap</a> <a id="1998" class="Symbol">(</a><a id="1999" href="Amethyst.PiecewiseLinear.Base.html#4520" class="Function">linearise</a> <a id="2009" href="Agda.Builtin.Float.html#2194" class="Primitive">Float.tanh</a> <a id="2020" class="Number">-3.0</a> <a id="2025" class="Number">3.0</a> <a id="2029" class="Number">3</a><a id="2030" class="Symbol">)</a>

<a id="2033" class="Comment">-- |Convert activation functions to SMT terms.</a>
<a id="2080" class="Comment">--</a>
<a id="2083" class="Comment">--  Takes an activation function description and an environment of SMT terms</a>
<a id="2160" class="Comment">--  describing the activation function inputs, and returns an environment of SMT</a>
<a id="2241" class="Comment">--  terms with the activation function applied.</a>
<a id="reflectActivation"></a><a id="2289" href="Amethyst.Network.As.Schmitty.html#2289" class="Function">reflectActivation</a> <a id="2307" class="Symbol">:</a> <a id="2309" href="Amethyst.Network.Base.html#797" class="Datatype">Activation</a> <a id="2320" class="Symbol">→</a> <a id="2322" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2326" class="Symbol">(</a><a id="2327" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2332" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a><a id="2333" class="Symbol">)</a> <a id="2335" href="Amethyst.Network.As.Schmitty.html#1560" class="Generalizable">n</a> <a id="2337" class="Symbol">→</a> <a id="2339" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2343" class="Symbol">(</a><a id="2344" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2349" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a><a id="2350" class="Symbol">)</a> <a id="2352" href="Amethyst.Network.As.Schmitty.html#1560" class="Generalizable">n</a>
<a id="2354" href="Amethyst.Network.As.Schmitty.html#2289" class="Function">reflectActivation</a> <a id="2372" href="Amethyst.Network.Base.html#822" class="InductiveConstructor">Activation.linear</a>  <a id="2391" class="Symbol">=</a> <a id="2393" href="Function.Base.html#615" class="Function">id</a>
<a id="2396" href="Amethyst.Network.As.Schmitty.html#2289" class="Function">reflectActivation</a> <a id="2414" href="Amethyst.Network.Base.html#845" class="InductiveConstructor">Activation.relu</a>    <a id="2433" class="Symbol">=</a> <a id="2435" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2443" href="Amethyst.Network.As.Schmitty.html#1577" class="Function">relu</a>
<a id="2448" href="Amethyst.Network.As.Schmitty.html#2289" class="Function">reflectActivation</a> <a id="2466" href="Amethyst.Network.Base.html#868" class="InductiveConstructor">Activation.sigmoid</a> <a id="2485" class="Symbol">=</a> <a id="2487" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2495" href="Amethyst.Network.As.Schmitty.html#1749" class="Function">lsigmoid</a>
<a id="2504" href="Amethyst.Network.As.Schmitty.html#2289" class="Function">reflectActivation</a> <a id="2522" href="Amethyst.Network.Base.html#891" class="InductiveConstructor">Activation.softmax</a> <a id="2541" class="Symbol">=</a> <a id="2543" href="Amethyst.Network.As.Schmitty.html#1860" class="Function">lsoftmax</a>
<a id="2552" href="Amethyst.Network.As.Schmitty.html#2289" class="Function">reflectActivation</a> <a id="2570" href="Amethyst.Network.Base.html#914" class="InductiveConstructor">Activation.tanh</a>    <a id="2589" class="Symbol">=</a> <a id="2591" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2599" href="Amethyst.Network.As.Schmitty.html#1950" class="Function">ltanh</a>


<a id="2607" class="Comment">-- * Neural networks</a>

<a id="2629" class="Keyword">private</a>
  <a id="2639" class="Keyword">variable</a>
    <a id="2652" href="Amethyst.Network.As.Schmitty.html#2652" class="Generalizable">inputs</a>  <a id="2660" class="Symbol">:</a> <a id="2662" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2668" href="Amethyst.Network.As.Schmitty.html#2668" class="Generalizable">hidden</a>  <a id="2676" class="Symbol">:</a> <a id="2678" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2684" href="Amethyst.Network.As.Schmitty.html#2684" class="Generalizable">outputs</a> <a id="2692" class="Symbol">:</a> <a id="2694" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2700" href="Amethyst.Network.As.Schmitty.html#2700" class="Generalizable">layers</a>  <a id="2708" class="Symbol">:</a> <a id="2710" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="2713" class="Comment">-- |Convert layers to SMT terms.</a>
<a id="2746" class="Comment">--</a>
<a id="2749" class="Comment">--  Takes a layer description and an environment of SMT terms describing the</a>
<a id="2826" class="Comment">--  layer inputs, and returns an environment of SMT terms describing the layer</a>
<a id="2905" class="Comment">--  outputs.</a>
<a id="reflectLayer"></a><a id="2918" href="Amethyst.Network.As.Schmitty.html#2918" class="Function">reflectLayer</a> <a id="2931" class="Symbol">:</a> <a id="2933" href="Amethyst.Network.Base.html#943" class="Record">Layer</a> <a id="2939" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="2945" href="Amethyst.Network.As.Schmitty.html#2652" class="Generalizable">inputs</a> <a id="2952" href="Amethyst.Network.As.Schmitty.html#2684" class="Generalizable">outputs</a> <a id="2960" class="Symbol">→</a> <a id="2962" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2966" class="Symbol">(</a><a id="2967" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2972" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a><a id="2973" class="Symbol">)</a> <a id="2975" href="Amethyst.Network.As.Schmitty.html#2652" class="Generalizable">inputs</a> <a id="2982" class="Symbol">→</a> <a id="2984" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2988" class="Symbol">(</a><a id="2989" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2994" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a><a id="2995" class="Symbol">)</a> <a id="2997" href="Amethyst.Network.As.Schmitty.html#2684" class="Generalizable">outputs</a>
<a id="3005" href="Amethyst.Network.As.Schmitty.html#2918" class="Function">reflectLayer</a> <a id="3018" href="Amethyst.Network.As.Schmitty.html#3018" class="Bound">l</a> <a id="3020" href="Amethyst.Network.As.Schmitty.html#3020" class="Bound">xs</a> <a id="3023" class="Symbol">=</a> <a id="3025" href="Amethyst.Network.As.Schmitty.html#2289" class="Function">reflectActivation</a> <a id="3043" href="Amethyst.Network.Base.html#1004" class="Function">activation</a> <a id="3054" class="Symbol">(</a><a id="3055" href="Amethyst.Network.As.Schmitty.html#3149" class="Function">biases′</a> <a id="3063" href="Amethyst.LinearAlgebra.As.Schmitty.html#1660" class="Function Operator">⊕</a> <a id="3065" class="Symbol">(</a><a id="3066" href="Amethyst.Network.As.Schmitty.html#3020" class="Bound">xs</a> <a id="3069" href="Amethyst.LinearAlgebra.As.Schmitty.html#2260" class="Function Operator">v⊡m</a> <a id="3073" href="Amethyst.Network.As.Schmitty.html#3186" class="Function">weights′</a><a id="3081" class="Symbol">))</a>
  <a id="3086" class="Keyword">where</a>
    <a id="3096" class="Keyword">open</a> <a id="3101" href="Amethyst.Network.Base.html#943" class="Module">Layer</a> <a id="3107" href="Amethyst.Network.As.Schmitty.html#3018" class="Bound">l</a> <a id="3109" class="Keyword">using</a> <a id="3115" class="Symbol">(</a><a id="3116" href="Amethyst.Network.Base.html#1004" class="Field">activation</a><a id="3126" class="Symbol">;</a> <a id="3128" href="Amethyst.Network.Base.html#1032" class="Field">weights</a><a id="3135" class="Symbol">;</a> <a id="3137" href="Amethyst.Network.Base.html#1076" class="Field">biases</a><a id="3143" class="Symbol">)</a>
    <a id="3149" href="Amethyst.Network.As.Schmitty.html#3149" class="Function">biases′</a>  <a id="3158" class="Symbol">=</a> <a id="3160" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="3168" href="Amethyst.LinearAlgebra.As.Schmitty.html#1204" class="Function">toReal</a> <a id="3175" href="Amethyst.Network.Base.html#1076" class="Function">biases</a>
    <a id="3186" href="Amethyst.Network.As.Schmitty.html#3186" class="Function">weights′</a> <a id="3195" class="Symbol">=</a> <a id="3197" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="3205" class="Symbol">(</a><a id="3206" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="3214" href="Amethyst.LinearAlgebra.As.Schmitty.html#1204" class="Function">toReal</a><a id="3220" class="Symbol">)</a> <a id="3222" href="Amethyst.Network.Base.html#1032" class="Function">weights</a>

<a id="3231" class="Comment">-- |Convert networks to SMT terms.</a>
<a id="3266" class="Comment">--</a>
<a id="3269" class="Comment">--  Takes a network description and an environment of SMT terms describing the</a>
<a id="3348" class="Comment">--  network inputs, and returns an environment of SMT terms describing the network</a>
<a id="3431" class="Comment">--  outputs.</a>
<a id="reflectNetwork"></a><a id="3444" href="Amethyst.Network.As.Schmitty.html#3444" class="Function">reflectNetwork</a> <a id="3459" class="Symbol">:</a> <a id="3461" href="Amethyst.Network.Base.html#1123" class="Datatype">Network</a> <a id="3469" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="3475" href="Amethyst.Network.As.Schmitty.html#2652" class="Generalizable">inputs</a> <a id="3482" href="Amethyst.Network.As.Schmitty.html#2684" class="Generalizable">outputs</a> <a id="3490" href="Amethyst.Network.As.Schmitty.html#2700" class="Generalizable">layers</a> <a id="3497" class="Symbol">→</a> <a id="3499" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3503" class="Symbol">(</a><a id="3504" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="3509" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a><a id="3510" class="Symbol">)</a> <a id="3512" href="Amethyst.Network.As.Schmitty.html#2652" class="Generalizable">inputs</a> <a id="3519" class="Symbol">→</a> <a id="3521" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3525" class="Symbol">(</a><a id="3526" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="3531" href="Amethyst.Network.As.Schmitty.html#1547" class="Generalizable">Γ</a><a id="3532" class="Symbol">)</a> <a id="3534" href="Amethyst.Network.As.Schmitty.html#2684" class="Generalizable">outputs</a>
<a id="3542" href="Amethyst.Network.As.Schmitty.html#3444" class="Function">reflectNetwork</a> <a id="3557" href="Amethyst.Network.Base.html#1191" class="InductiveConstructor">[]</a>      <a id="3565" class="Symbol">=</a> <a id="3567" href="Function.Base.html#615" class="Function">id</a>
<a id="3570" href="Amethyst.Network.As.Schmitty.html#3444" class="Function">reflectNetwork</a> <a id="3585" class="Symbol">(</a><a id="3586" href="Amethyst.Network.As.Schmitty.html#3586" class="Bound">l</a> <a id="3588" href="Amethyst.Network.Base.html#1225" class="InductiveConstructor Operator">∷</a> <a id="3590" href="Amethyst.Network.As.Schmitty.html#3590" class="Bound">n</a><a id="3591" class="Symbol">)</a> <a id="3593" class="Symbol">=</a> <a id="3595" href="Amethyst.Network.As.Schmitty.html#3444" class="Function">reflectNetwork</a> <a id="3610" href="Amethyst.Network.As.Schmitty.html#3590" class="Bound">n</a> <a id="3612" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3614" href="Amethyst.Network.As.Schmitty.html#2918" class="Function">reflectLayer</a> <a id="3627" href="Amethyst.Network.As.Schmitty.html#3586" class="Bound">l</a>

<a id="3630" class="Keyword">private</a>
  <a id="3640" class="Comment">-- |The reverse-append of two reversed lists is equivalent to the append of the lists.</a>
  <a id="3729" class="Comment">--</a>
  <a id="3734" class="Comment">--  NOTE: The variable contexts for a Script are in reversed order, so we pass</a>
  <a id="3815" class="Comment">--        the reversed input/output contexts to `declare-consts` to ensure</a>
  <a id="3892" class="Comment">--        that we end up with *doubly* reversed contexts in the Script.</a>
  <a id="3966" class="Comment">--        We use this lemma to show that the doubly reversed contexts are</a>
  <a id="4042" class="Comment">--        equivalent to the original input/output context.</a>
  <a id="4103" class="Comment">--</a>
  <a id="4108" class="Comment">--  NOTE: Perhaps this lemma should be submitted to Data.List.Properties?</a>
  <a id="4184" class="Comment">--</a>
  <a id="ʳ++-reverse"></a><a id="4189" href="Amethyst.Network.As.Schmitty.html#4189" class="Function">ʳ++-reverse</a> <a id="4201" class="Symbol">:</a> <a id="4203" class="Symbol">∀</a> <a id="4205" class="Symbol">{</a><a id="4206" href="Amethyst.Network.As.Schmitty.html#4206" class="Bound">a</a><a id="4207" class="Symbol">}</a> <a id="4209" class="Symbol">{</a><a id="4210" href="Amethyst.Network.As.Schmitty.html#4210" class="Bound">A</a> <a id="4212" class="Symbol">:</a> <a id="4214" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4218" href="Amethyst.Network.As.Schmitty.html#4206" class="Bound">a</a><a id="4219" class="Symbol">}</a> <a id="4221" class="Symbol">(</a><a id="4222" href="Amethyst.Network.As.Schmitty.html#4222" class="Bound">xs</a> <a id="4225" href="Amethyst.Network.As.Schmitty.html#4225" class="Bound">ys</a> <a id="4228" class="Symbol">:</a> <a id="4230" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4235" href="Amethyst.Network.As.Schmitty.html#4210" class="Bound">A</a><a id="4236" class="Symbol">)</a> <a id="4238" class="Symbol">→</a> <a id="4240" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4253" href="Amethyst.Network.As.Schmitty.html#4222" class="Bound">xs</a> <a id="4256" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4260" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4273" href="Amethyst.Network.As.Schmitty.html#4225" class="Bound">ys</a>  <a id="4277" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4281" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4284" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4286" href="Amethyst.Network.As.Schmitty.html#4222" class="Bound">xs</a> <a id="4289" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4292" href="Amethyst.Network.As.Schmitty.html#4225" class="Bound">ys</a>
  <a id="4297" href="Amethyst.Network.As.Schmitty.html#4189" class="Function">ʳ++-reverse</a> <a id="4309" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a> <a id="4312" href="Amethyst.Network.As.Schmitty.html#4312" class="Bound">ys</a> <a id="4315" class="Symbol">=</a>
    <a id="4321" href="Relation.Binary.PropositionalEquality.Core.html#2745" class="Function Operator">begin</a>
      <a id="4333" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4346" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a> <a id="4349" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4353" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4366" href="Amethyst.Network.As.Schmitty.html#4312" class="Bound">ys</a> <a id="4369" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4373" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4380" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4383" href="Data.List.Properties.html#30377" class="Function">List.ʳ++-defn</a> <a id="4397" class="Symbol">(</a><a id="4398" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4411" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a><a id="4413" class="Symbol">)</a> <a id="4415" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4423" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4436" class="Symbol">(</a><a id="4437" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4450" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a><a id="4452" class="Symbol">)</a> <a id="4454" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4457" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4470" href="Amethyst.Network.As.Schmitty.html#4312" class="Bound">ys</a>  <a id="4474" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4478" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4485" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4488" href="Data.List.Properties.html#33859" class="Function">List.reverse-involutive</a> <a id="4512" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a> <a id="4515" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4518" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4526" class="Symbol">(</a><a id="4527" href="Data.List.Base.html#1763" class="Function Operator">_++</a> <a id="4531" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4544" href="Amethyst.Network.As.Schmitty.html#4312" class="Bound">ys</a> <a id="4547" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4551" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4553" class="Symbol">)</a> <a id="4555" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4563" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a> <a id="4566" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4569" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4582" href="Amethyst.Network.As.Schmitty.html#4312" class="Bound">ys</a> <a id="4585" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4589" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4596" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4599" href="Data.List.Properties.html#30377" class="Function">List.ʳ++-defn</a> <a id="4613" class="Symbol">(</a><a id="4614" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4627" href="Amethyst.Network.As.Schmitty.html#4312" class="Bound">ys</a><a id="4629" class="Symbol">)</a> <a id="4631" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4634" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4642" class="Symbol">(</a><a id="4643" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a> <a id="4646" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4649" class="Symbol">)</a> <a id="4651" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4659" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a> <a id="4662" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4665" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4678" class="Symbol">(</a><a id="4679" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4692" href="Amethyst.Network.As.Schmitty.html#4312" class="Bound">ys</a><a id="4694" class="Symbol">)</a> <a id="4696" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4699" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4706" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4709" href="Data.List.Properties.html#33859" class="Function">List.reverse-involutive</a> <a id="4733" href="Amethyst.Network.As.Schmitty.html#4312" class="Bound">ys</a> <a id="4736" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4739" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4747" class="Symbol">((</a><a id="4749" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a> <a id="4752" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4755" class="Symbol">)</a> <a id="4757" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4759" class="Symbol">(</a><a id="4760" href="Data.List.Base.html#1763" class="Function Operator">_++</a> <a id="4764" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4766" class="Symbol">))</a> <a id="4769" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4777" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a> <a id="4780" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4783" href="Amethyst.Network.As.Schmitty.html#4312" class="Bound">ys</a> <a id="4786" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4789" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4796" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4799" href="Data.List.Properties.html#5554" class="Function">List.++-identityʳ</a> <a id="4817" href="Amethyst.Network.As.Schmitty.html#4312" class="Bound">ys</a> <a id="4820" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4823" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4831" class="Symbol">(</a><a id="4832" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a> <a id="4835" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4838" class="Symbol">)</a> <a id="4840" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4848" href="Amethyst.Network.As.Schmitty.html#4309" class="Bound">xs</a> <a id="4851" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4854" href="Amethyst.Network.As.Schmitty.html#4312" class="Bound">ys</a>
    <a id="4861" href="Relation.Binary.PropositionalEquality.Core.html#3044" class="Function Operator">∎</a>


<a id="4865" class="Comment">-- |Convert a networks to an SMT script, and allow the caller to append further commands.</a>
<a id="withReflectedNetworkAsScript"></a><a id="4955" href="Amethyst.Network.As.Schmitty.html#4955" class="Function">withReflectedNetworkAsScript</a>
  <a id="4986" class="Symbol">:</a> <a id="4988" class="Symbol">∀</a> <a id="4990" class="Symbol">{</a><a id="4991" href="Amethyst.Network.As.Schmitty.html#4991" class="Bound">Γ</a> <a id="4993" href="Amethyst.Network.As.Schmitty.html#4993" class="Bound">Ξ</a><a id="4994" class="Symbol">}</a>
  <a id="4998" class="Symbol">→</a> <a id="5000" href="Amethyst.Network.Base.html#1123" class="Datatype">Network</a> <a id="5008" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="5014" href="Amethyst.Network.As.Schmitty.html#2652" class="Generalizable">inputs</a> <a id="5021" href="Amethyst.Network.As.Schmitty.html#2684" class="Generalizable">outputs</a> <a id="5029" href="Amethyst.Network.As.Schmitty.html#2700" class="Generalizable">layers</a>
  <a id="5038" class="Symbol">→</a> <a id="5040" class="Symbol">(</a> <a id="5042" class="Symbol">(</a><a id="5043" href="Amethyst.Network.As.Schmitty.html#5043" class="Bound">iv</a> <a id="5046" class="Symbol">:</a> <a id="5048" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5052" class="Symbol">(</a><a id="5053" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="5058" class="Symbol">(</a><a id="5059" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5065" href="Amethyst.Network.As.Schmitty.html#2652" class="Generalizable">inputs</a> <a id="5072" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="5075" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5081" href="Amethyst.Network.As.Schmitty.html#2684" class="Generalizable">outputs</a><a id="5088" class="Symbol">))</a> <a id="5091" href="Amethyst.Network.As.Schmitty.html#2652" class="Generalizable">inputs</a><a id="5097" class="Symbol">)</a>
    <a id="5103" class="Symbol">→</a> <a id="5105" class="Symbol">(</a><a id="5106" href="Amethyst.Network.As.Schmitty.html#5106" class="Bound">ov</a> <a id="5109" class="Symbol">:</a> <a id="5111" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5115" class="Symbol">(</a><a id="5116" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="5121" class="Symbol">(</a><a id="5122" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5128" href="Amethyst.Network.As.Schmitty.html#2652" class="Generalizable">inputs</a> <a id="5135" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="5138" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5144" href="Amethyst.Network.As.Schmitty.html#2684" class="Generalizable">outputs</a><a id="5151" class="Symbol">))</a> <a id="5154" href="Amethyst.Network.As.Schmitty.html#2684" class="Generalizable">outputs</a><a id="5161" class="Symbol">)</a>
    <a id="5167" class="Symbol">→</a> <a id="5169" class="Symbol">(</a><a id="5170" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="5177" class="Symbol">(</a><a id="5178" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5184" href="Amethyst.Network.As.Schmitty.html#2652" class="Generalizable">inputs</a> <a id="5191" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="5194" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5200" href="Amethyst.Network.As.Schmitty.html#2684" class="Generalizable">outputs</a><a id="5207" class="Symbol">)</a> <a id="5209" href="Amethyst.Network.As.Schmitty.html#4991" class="Bound">Γ</a> <a id="5211" href="Amethyst.Network.As.Schmitty.html#4993" class="Bound">Ξ</a><a id="5212" class="Symbol">))</a>
    <a id="5219" class="Symbol">→</a> <a id="5221" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="5228" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="5231" href="Amethyst.Network.As.Schmitty.html#4991" class="Bound">Γ</a> <a id="5233" href="Amethyst.Network.As.Schmitty.html#4993" class="Bound">Ξ</a>
<a id="5235" href="Amethyst.Network.As.Schmitty.html#4955" class="Function">withReflectedNetworkAsScript</a> <a id="5264" class="Symbol">{</a><a id="5265" href="Amethyst.Network.As.Schmitty.html#5265" class="Bound">inputs</a><a id="5271" class="Symbol">}</a> <a id="5273" class="Symbol">{</a><a id="5274" href="Amethyst.Network.As.Schmitty.html#5274" class="Bound">outputs</a><a id="5281" class="Symbol">}</a> <a id="5283" href="Amethyst.Network.As.Schmitty.html#5283" class="Bound">n</a> <a id="5285" href="Amethyst.Network.As.Schmitty.html#5285" class="Bound">k</a>
  <a id="5289" class="Symbol">=</a> <a id="5291" class="Symbol">(</a> <a id="5293" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a> <a id="5302" class="Symbol">(λ</a> <a id="5305" href="Amethyst.Network.As.Schmitty.html#5305" class="Bound">Γ</a> <a id="5307" class="Symbol">→</a> <a id="5309" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="5316" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="5319" href="Amethyst.Network.As.Schmitty.html#5305" class="Bound">Γ</a> <a id="5321" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5323" class="Symbol">)</a> <a id="5325" class="Symbol">(</a><a id="5326" href="Amethyst.Network.As.Schmitty.html#4189" class="Function">ʳ++-reverse</a> <a id="5338" class="Symbol">(</a><a id="5339" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5345" href="Amethyst.Network.As.Schmitty.html#5265" class="Bound">inputs</a><a id="5351" class="Symbol">)</a> <a id="5353" class="Symbol">(</a><a id="5354" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5360" href="Amethyst.Network.As.Schmitty.html#5274" class="Bound">outputs</a><a id="5367" class="Symbol">))</a>
    <a id="5374" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5376" href="SMT.Script.Base.html#8648" class="Function">declare-consts</a> <a id="5391" class="Symbol">(</a><a id="5392" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="5405" class="Symbol">(</a><a id="5406" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5412" href="Amethyst.Network.As.Schmitty.html#5274" class="Bound">outputs</a><a id="5419" class="Symbol">))</a>
    <a id="5426" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5428" href="SMT.Script.Base.html#8648" class="Function">declare-consts</a> <a id="5443" class="Symbol">(</a><a id="5444" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="5457" class="Symbol">(</a><a id="5458" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5464" href="Amethyst.Network.As.Schmitty.html#5265" class="Bound">inputs</a><a id="5470" class="Symbol">))</a>
    <a id="5477" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5479" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a>
      <a id="5492" class="Symbol">(</a><a id="5493" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="5503" class="Symbol">_</a>
        <a id="5513" class="Symbol">(</a><a id="5514" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="5519" href="SMT.Theories.Core.Extensions.html#1401" class="Function">and</a><a id="5522" class="Symbol">)</a>
        <a id="5532" class="Symbol">(</a><a id="5533" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="5537" class="Symbol">(</a><a id="5538" href="SMT.Theories.Core.Extensions.html#955" class="Function">bool</a> <a id="5543" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="5547" class="Symbol">))</a>
        <a id="5558" class="Symbol">(</a><a id="5559" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a>
          <a id="5581" class="Symbol">(</a><a id="5582" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="5587" href="SMT.Theories.Reals.html#4615" class="InductiveConstructor">eq</a><a id="5589" class="Symbol">)</a>
          <a id="5601" class="Symbol">(</a><a id="5602" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a> <a id="5611" class="Symbol">(λ</a> <a id="5614" href="Amethyst.Network.As.Schmitty.html#5614" class="Bound">Γ</a> <a id="5616" class="Symbol">→</a> <a id="5618" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5622" class="Symbol">(</a><a id="5623" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="5628" href="Amethyst.Network.As.Schmitty.html#5614" class="Bound">Γ</a><a id="5629" class="Symbol">)</a> <a id="5631" href="Amethyst.Network.As.Schmitty.html#5274" class="Bound">outputs</a><a id="5638" class="Symbol">)</a> <a id="5640" class="Symbol">(</a><a id="5641" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">Eq.sym</a> <a id="5648" class="Symbol">(</a><a id="5649" href="Amethyst.Network.As.Schmitty.html#4189" class="Function">ʳ++-reverse</a> <a id="5661" class="Symbol">(</a><a id="5662" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5668" href="Amethyst.Network.As.Schmitty.html#5265" class="Bound">inputs</a><a id="5674" class="Symbol">)</a> <a id="5676" class="Symbol">(</a><a id="5677" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5683" href="Amethyst.Network.As.Schmitty.html#5274" class="Bound">outputs</a><a id="5690" class="Symbol">)))</a> <a id="5694" href="Amethyst.Network.As.Schmitty.html#5953" class="Function">ov</a><a id="5696" class="Symbol">)</a>
          <a id="5708" class="Symbol">(</a><a id="5709" href="Amethyst.Network.As.Schmitty.html#3444" class="Function">reflectNetwork</a> <a id="5724" href="Amethyst.Network.As.Schmitty.html#5283" class="Bound">n</a>
            <a id="5738" class="Symbol">(</a><a id="5739" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a> <a id="5748" class="Symbol">(λ</a> <a id="5751" href="Amethyst.Network.As.Schmitty.html#5751" class="Bound">Γ</a> <a id="5753" class="Symbol">→</a> <a id="5755" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5759" class="Symbol">(</a><a id="5760" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="5765" href="Amethyst.Network.As.Schmitty.html#5751" class="Bound">Γ</a><a id="5766" class="Symbol">)</a> <a id="5768" href="Amethyst.Network.As.Schmitty.html#5265" class="Bound">inputs</a><a id="5774" class="Symbol">)</a> <a id="5776" class="Symbol">(</a><a id="5777" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">Eq.sym</a> <a id="5784" class="Symbol">(</a><a id="5785" href="Amethyst.Network.As.Schmitty.html#4189" class="Function">ʳ++-reverse</a> <a id="5797" class="Symbol">(</a><a id="5798" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5804" href="Amethyst.Network.As.Schmitty.html#5265" class="Bound">inputs</a><a id="5810" class="Symbol">)</a> <a id="5812" class="Symbol">(</a><a id="5813" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5819" href="Amethyst.Network.As.Schmitty.html#5274" class="Bound">outputs</a><a id="5826" class="Symbol">)))</a> <a id="5830" href="Amethyst.Network.As.Schmitty.html#5872" class="Function">iv</a><a id="5832" class="Symbol">))))</a>
    <a id="5841" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="5843" href="SMT.Script.Base.html#8084" class="InductiveConstructor">[]</a>
    <a id="5850" class="Symbol">)</a> <a id="5852" href="SMT.Script.Base.html#8191" class="Function Operator">◆</a> <a id="5854" href="Amethyst.Network.As.Schmitty.html#5285" class="Bound">k</a> <a id="5856" href="Amethyst.Network.As.Schmitty.html#5872" class="Function">iv</a> <a id="5859" href="Amethyst.Network.As.Schmitty.html#5953" class="Function">ov</a>
  <a id="5864" class="Keyword">where</a>
  <a id="5872" href="Amethyst.Network.As.Schmitty.html#5872" class="Function">iv</a> <a id="5875" class="Symbol">=</a> <a id="5877" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="5885" class="Symbol">(</a><a id="5886" href="SMT.Script.Base.html#1517" class="InductiveConstructor">var</a> <a id="5890" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5892" href="SMT.Script.Base.html#3034" class="Function">injectVar</a> <a id="5902" class="Symbol">(</a><a id="5903" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5909" href="Amethyst.Network.As.Schmitty.html#5265" class="Bound">inputs</a><a id="5915" class="Symbol">)</a> <a id="5917" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5919" href="Amethyst.LinearAlgebra.As.Schmitty.html#1410" class="Function">Reals∋Real</a><a id="5929" class="Symbol">)</a> <a id="5931" class="Symbol">(</a><a id="5932" href="Data.Vec.Base.html#5972" class="Function">Vec.allFin</a> <a id="5943" href="Amethyst.Network.As.Schmitty.html#5265" class="Bound">inputs</a><a id="5949" class="Symbol">)</a>
  <a id="5953" href="Amethyst.Network.As.Schmitty.html#5953" class="Function">ov</a> <a id="5956" class="Symbol">=</a> <a id="5958" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="5966" class="Symbol">(</a><a id="5967" href="SMT.Script.Base.html#1517" class="InductiveConstructor">var</a> <a id="5971" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5973" href="SMT.Script.Base.html#3189" class="Function">raiseVar</a>  <a id="5983" class="Symbol">(</a><a id="5984" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="5990" href="Amethyst.Network.As.Schmitty.html#5265" class="Bound">inputs</a><a id="5996" class="Symbol">)</a> <a id="5998" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6000" href="Amethyst.LinearAlgebra.As.Schmitty.html#1410" class="Function">Reals∋Real</a><a id="6010" class="Symbol">)</a> <a id="6012" class="Symbol">(</a><a id="6013" href="Data.Vec.Base.html#5972" class="Function">Vec.allFin</a> <a id="6024" href="Amethyst.Network.As.Schmitty.html#5274" class="Bound">outputs</a><a id="6031" class="Symbol">)</a>
</pre></body></html>