<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.Network.As.Schmitty</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst: Neural Network Verification in Agda</a>
<a id="131" class="Comment">--</a>
<a id="134" class="Comment">-- This module contains functions to reflect networks as Schmitty terms. It also</a>
<a id="215" class="Comment">-- provides the `withReflectedNetwork` function, which reflects a network as a</a>
<a id="294" class="Comment">-- Schmitty term, and wraps that term in a script which declares the appropriate</a>
<a id="375" class="Comment">-- constants for the inputs and outputs, and allows the caller to append further</a>
<a id="456" class="Comment">-- portions of script.</a>
<a id="479" class="Comment">--</a>
<a id="482" class="Comment">-- Exports:</a>
<a id="494" class="Comment">--</a>
<a id="497" class="Comment">--   - reflectActivation</a>
<a id="522" class="Comment">--   - reflectLayer</a>
<a id="542" class="Comment">--   - reflectNetwork</a>
<a id="564" class="Comment">--   - withReflectedNetworkAsScript</a>
<a id="600" class="Comment">--</a>
<a id="603" class="Comment">--------------------------------------------------------------------------------</a>
<a id="684" class="Keyword">module</a> <a id="691" href="Amethyst.Network.As.Schmitty.html" class="Module">Amethyst.Network.As.Schmitty</a> <a id="720" class="Keyword">where</a>

<a id="727" class="Keyword">open</a> <a id="732" class="Keyword">import</a> <a id="739" href="SMT.Theories.Reals.Base.html" class="Module">SMT.Theories.Reals.Base</a> <a id="763" class="Keyword">using</a> <a id="769" class="Symbol">(</a><a id="770" href="SMT.Theories.Core.Extensions.html#1557" class="Function">true</a><a id="774" class="Symbol">)</a>

<a id="777" class="Keyword">open</a> <a id="782" class="Keyword">import</a> <a id="789" href="Amethyst.Network.Base.html" class="Module">Amethyst.Network.Base</a>
  <a id="813" class="Keyword">using</a> <a id="819" class="Symbol">(</a><a id="820" href="Amethyst.Network.Base.html#1285" class="Datatype">Network</a><a id="827" class="Symbol">;</a> <a id="829" href="Amethyst.Network.Base.html#1351" class="InductiveConstructor">[]</a><a id="831" class="Symbol">;</a> <a id="833" href="Amethyst.Network.Base.html#1386" class="InductiveConstructor Operator">_∷_</a><a id="836" class="Symbol">;</a> <a id="838" href="Amethyst.Network.Base.html#966" class="Record">Layer</a><a id="843" class="Symbol">;</a> <a id="845" href="Amethyst.Network.Base.html#1127" class="Function">LayerSpec</a><a id="854" class="Symbol">;</a> <a id="856" href="Amethyst.Network.Base.html#820" class="Datatype">Activation</a><a id="866" class="Symbol">;</a> <a id="868" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣_₀∣</a><a id="872" class="Symbol">;</a> <a id="874" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣_ₙ∣</a><a id="878" class="Symbol">)</a>
<a id="880" class="Keyword">open</a> <a id="885" class="Keyword">import</a> <a id="892" href="Amethyst.Network.Approximation.html" class="Module">Amethyst.Network.Approximation</a>
<a id="923" class="Keyword">open</a> <a id="928" class="Keyword">import</a> <a id="935" href="Amethyst.PiecewiseLinear.Base.html" class="Module">Amethyst.PiecewiseLinear.Base</a>
<a id="965" class="Keyword">open</a> <a id="970" class="Keyword">import</a> <a id="977" href="Amethyst.PiecewiseLinear.As.Schmitty.html" class="Module">Amethyst.PiecewiseLinear.As.Schmitty</a>
<a id="1014" class="Keyword">open</a> <a id="1019" class="Keyword">import</a> <a id="1026" href="Amethyst.LinearAlgebra.As.Schmitty.html" class="Module">Amethyst.LinearAlgebra.As.Schmitty</a>

<a id="1062" class="Keyword">open</a> <a id="1067" class="Keyword">import</a> <a id="1074" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="1083" class="Symbol">as</a> <a id="1086" class="Module">Fin</a> <a id="1090" class="Keyword">using</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="1100" class="Symbol">;</a> <a id="1102" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a><a id="1106" class="Symbol">;</a> <a id="1108" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a><a id="1111" class="Symbol">)</a>
<a id="1113" class="Keyword">open</a> <a id="1118" class="Keyword">import</a> <a id="1125" href="Data.Float.html" class="Module">Data.Float</a> <a id="1136" class="Symbol">as</a> <a id="1139" class="Module">Float</a> <a id="1145" class="Keyword">using</a> <a id="1151" class="Symbol">(</a><a id="1152" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="1157" class="Symbol">)</a>
<a id="1159" class="Keyword">open</a> <a id="1164" class="Keyword">import</a> <a id="1171" href="Data.List.html" class="Module">Data.List</a> <a id="1181" class="Symbol">as</a> <a id="1184" class="Module">List</a> <a id="1189" class="Keyword">using</a> <a id="1195" class="Symbol">(</a><a id="1196" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="1200" class="Symbol">;</a> <a id="1202" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="1204" class="Symbol">;</a> <a id="1206" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="1209" class="Symbol">;</a> <a id="1211" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="1215" class="Symbol">;</a> <a id="1217" href="Data.List.Base.html#9558" class="Function Operator">_ʳ++_</a><a id="1222" class="Symbol">)</a>
<a id="1224" class="Keyword">open</a> <a id="1229" class="Keyword">import</a> <a id="1236" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="1265" class="Keyword">using</a> <a id="1271" class="Symbol">(</a><a id="1272" href="Data.List.Relation.Unary.All.html#1460" class="InductiveConstructor">[]</a><a id="1274" class="Symbol">)</a>
<a id="1276" class="Keyword">import</a> <a id="1283" href="Data.List.Properties.html" class="Module">Data.List.Properties</a> <a id="1304" class="Symbol">as</a> <a id="1307" class="Module">List</a>
<a id="1312" class="Keyword">import</a> <a id="1319" href="Data.List.Properties.Extra.html" class="Module">Data.List.Properties.Extra</a> <a id="1346" class="Symbol">as</a> <a id="1349" class="Module">List</a>
<a id="1354" class="Keyword">open</a> <a id="1359" class="Keyword">import</a> <a id="1366" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="1375" class="Symbol">as</a> <a id="1378" class="Module">Nat</a> <a id="1382" class="Keyword">using</a> <a id="1388" class="Symbol">(</a><a id="1389" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1390" class="Symbol">;</a> <a id="1392" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1396" class="Symbol">;</a> <a id="1398" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="1401" class="Symbol">)</a>
<a id="1403" class="Keyword">open</a> <a id="1408" class="Keyword">import</a> <a id="1415" href="Data.Product.html" class="Module">Data.Product</a> <a id="1428" class="Symbol">as</a> <a id="1431" class="Module">Prod</a> <a id="1436" class="Keyword">using</a> <a id="1442" class="Symbol">(</a><a id="1443" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="1446" class="Symbol">;</a> <a id="1448" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="1451" class="Symbol">;</a> <a id="1453" href="Data.Product.html#3422" class="Function">uncurry</a><a id="1460" class="Symbol">)</a>
<a id="1462" class="Keyword">open</a> <a id="1467" class="Keyword">import</a> <a id="1474" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1483" class="Symbol">as</a> <a id="1486" class="Module">Vec</a> <a id="1490" class="Keyword">using</a> <a id="1496" class="Symbol">(</a><a id="1497" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="1500" class="Symbol">;</a> <a id="1502" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1504" class="Symbol">;</a> <a id="1506" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="1509" class="Symbol">)</a>
<a id="1511" class="Keyword">open</a> <a id="1516" class="Keyword">import</a> <a id="1523" href="Function.html" class="Module">Function</a> <a id="1532" class="Keyword">using</a> <a id="1538" class="Symbol">(</a><a id="1539" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="1542" class="Symbol">;</a> <a id="1544" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="1547" class="Symbol">;</a> <a id="1549" href="Function.Base.html#2210" class="Function Operator">_|&gt;_</a><a id="1553" class="Symbol">;</a> <a id="1555" href="Function.Base.html#615" class="Function">id</a><a id="1557" class="Symbol">)</a>
<a id="1559" class="Keyword">open</a> <a id="1564" class="Keyword">import</a> <a id="1571" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1609" class="Symbol">as</a> <a id="1612" class="Module">Eq</a> <a id="1615" class="Keyword">using</a> <a id="1621" class="Symbol">(</a><a id="1622" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="1625" class="Symbol">;</a> <a id="1627" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1631" class="Symbol">)</a>
<a id="1633" class="Keyword">open</a> <a id="1638" href="Relation.Binary.PropositionalEquality.Core.html#2647" class="Module">Eq.≡-Reasoning</a>

<a id="1654" class="Comment">-- * Activation functions</a>

<a id="1681" class="Keyword">private</a>
  <a id="1691" class="Keyword">variable</a>
    <a id="1704" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a> <a id="1706" class="Symbol">:</a> <a id="1708" href="SMT.Script.Base.html#2510" class="Function">Ctxt</a>
    <a id="1717" href="Amethyst.Network.As.Schmitty.html#1717" class="Generalizable">n</a> <a id="1719" class="Symbol">:</a> <a id="1721" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1724" class="Keyword">private</a>
  <a id="relu"></a><a id="1734" href="Amethyst.Network.As.Schmitty.html#1734" class="Function">relu</a> <a id="1739" class="Symbol">:</a> <a id="1741" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1746" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a> <a id="1748" class="Symbol">→</a> <a id="1750" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1755" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a>
  <a id="1759" href="Amethyst.Network.As.Schmitty.html#1734" class="Function">relu</a> <a id="1764" href="Amethyst.Network.As.Schmitty.html#1764" class="Bound">x</a> <a id="1766" class="Symbol">=</a> <a id="1768" href="SMT.Script.Base.html#4035" class="InductiveConstructor">`app₃</a> <a id="1774" href="SMT.Theories.Reals.Base.html#4568" class="InductiveConstructor">ite</a> <a id="1778" class="Symbol">(</a><a id="1779" href="SMT.Script.Base.html#3991" class="InductiveConstructor">`app₂</a> <a id="1785" href="SMT.Theories.Reals.Base.html#4769" class="InductiveConstructor">leq</a> <a id="1789" href="Amethyst.Network.As.Schmitty.html#1764" class="Bound">x</a> <a id="1791" class="Symbol">(</a><a id="1792" href="SMT.Script.Base.html#3347" class="InductiveConstructor">`lit</a> <a id="1797" class="Symbol">(</a><a id="1798" href="SMT.Theories.Reals.Base.html#3925" class="InductiveConstructor">nat</a> <a id="1802" class="Number">0</a><a id="1803" class="Symbol">)))</a> <a id="1807" class="Symbol">(</a><a id="1808" href="SMT.Script.Base.html#3347" class="InductiveConstructor">`lit</a> <a id="1813" class="Symbol">(</a><a id="1814" href="SMT.Theories.Reals.Base.html#3925" class="InductiveConstructor">nat</a> <a id="1818" class="Number">0</a><a id="1819" class="Symbol">))</a> <a id="1822" href="Amethyst.Network.As.Schmitty.html#1764" class="Bound">x</a>

  <a id="lexp"></a><a id="1827" href="Amethyst.Network.As.Schmitty.html#1827" class="Function">lexp</a> <a id="1832" class="Symbol">:</a> <a id="1834" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1839" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a> <a id="1841" class="Symbol">→</a> <a id="1843" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1848" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a>
  <a id="1852" href="Amethyst.Network.As.Schmitty.html#1827" class="Function">lexp</a> <a id="1857" class="Symbol">=</a> <a id="1859" href="Amethyst.PiecewiseLinear.As.Schmitty.html#2517" class="Function">reflect</a> <a id="1867" href="Amethyst.Network.Approximation.html#765" class="Function">expApprox</a>

  <a id="lsigmoid"></a><a id="1880" href="Amethyst.Network.As.Schmitty.html#1880" class="Function">lsigmoid</a> <a id="1889" class="Symbol">:</a> <a id="1891" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1896" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a> <a id="1898" class="Symbol">→</a> <a id="1900" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1905" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a>
  <a id="1909" href="Amethyst.Network.As.Schmitty.html#1880" class="Function">lsigmoid</a> <a id="1918" class="Symbol">=</a> <a id="1920" href="Amethyst.PiecewiseLinear.As.Schmitty.html#2517" class="Function">reflect</a> <a id="1928" href="Amethyst.Network.Approximation.html#1239" class="Function">sigmoidApprox</a>

  <a id="lsoftmax"></a><a id="1945" href="Amethyst.Network.As.Schmitty.html#1945" class="Function">lsoftmax</a> <a id="1954" class="Symbol">:</a> <a id="1956" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1960" class="Symbol">(</a><a id="1961" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1966" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a><a id="1967" class="Symbol">)</a> <a id="1969" href="Amethyst.Network.As.Schmitty.html#1717" class="Generalizable">n</a> <a id="1971" class="Symbol">→</a> <a id="1973" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1977" class="Symbol">(</a><a id="1978" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1983" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a><a id="1984" class="Symbol">)</a> <a id="1986" href="Amethyst.Network.As.Schmitty.html#1717" class="Generalizable">n</a>
  <a id="1990" href="Amethyst.Network.As.Schmitty.html#1945" class="Function">lsoftmax</a> <a id="1999" href="Amethyst.Network.As.Schmitty.html#1999" class="Bound">xs</a> <a id="2002" class="Symbol">=</a> <a id="2004" href="Amethyst.LinearAlgebra.As.Schmitty.html#2131" class="Function">normalise</a> <a id="2014" class="Symbol">(</a><a id="2015" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2023" href="Amethyst.Network.As.Schmitty.html#1827" class="Function">lexp</a> <a id="2028" href="Amethyst.Network.As.Schmitty.html#1999" class="Bound">xs</a><a id="2030" class="Symbol">)</a>

  <a id="ltanh"></a><a id="2035" href="Amethyst.Network.As.Schmitty.html#2035" class="Function">ltanh</a> <a id="2041" class="Symbol">:</a> <a id="2043" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2048" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a> <a id="2050" class="Symbol">→</a> <a id="2052" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2057" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a>
  <a id="2061" href="Amethyst.Network.As.Schmitty.html#2035" class="Function">ltanh</a> <a id="2067" class="Symbol">=</a> <a id="2069" href="Amethyst.PiecewiseLinear.As.Schmitty.html#2517" class="Function">reflect</a> <a id="2077" href="Amethyst.Network.Approximation.html#1560" class="Function">tanhApprox</a>


<a id="2090" class="Comment">-- |Convert activation functions to SMT terms.</a>
<a id="2137" class="Comment">--</a>
<a id="2140" class="Comment">--  Takes an activation function description and an environment of SMT terms</a>
<a id="2217" class="Comment">--  describing the activation function inputs, and returns an environment of SMT</a>
<a id="2298" class="Comment">--  terms with the activation function applied.</a>
<a id="reflectActivation"></a><a id="2346" href="Amethyst.Network.As.Schmitty.html#2346" class="Function">reflectActivation</a> <a id="2364" class="Symbol">:</a> <a id="2366" href="Amethyst.Network.Base.html#820" class="Datatype">Activation</a> <a id="2377" class="Symbol">→</a> <a id="2379" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2383" class="Symbol">(</a><a id="2384" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2389" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a><a id="2390" class="Symbol">)</a> <a id="2392" href="Amethyst.Network.As.Schmitty.html#1717" class="Generalizable">n</a> <a id="2394" class="Symbol">→</a> <a id="2396" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2400" class="Symbol">(</a><a id="2401" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2406" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a><a id="2407" class="Symbol">)</a> <a id="2409" href="Amethyst.Network.As.Schmitty.html#1717" class="Generalizable">n</a>
<a id="2411" href="Amethyst.Network.As.Schmitty.html#2346" class="Function">reflectActivation</a> <a id="2429" href="Amethyst.Network.Base.html#845" class="InductiveConstructor">Activation.linear</a>  <a id="2448" class="Symbol">=</a> <a id="2450" href="Function.Base.html#615" class="Function">id</a>
<a id="2453" href="Amethyst.Network.As.Schmitty.html#2346" class="Function">reflectActivation</a> <a id="2471" href="Amethyst.Network.Base.html#868" class="InductiveConstructor">Activation.relu</a>    <a id="2490" class="Symbol">=</a> <a id="2492" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2500" href="Amethyst.Network.As.Schmitty.html#1734" class="Function">relu</a>
<a id="2505" href="Amethyst.Network.As.Schmitty.html#2346" class="Function">reflectActivation</a> <a id="2523" href="Amethyst.Network.Base.html#891" class="InductiveConstructor">Activation.sigmoid</a> <a id="2542" class="Symbol">=</a> <a id="2544" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2552" href="Amethyst.Network.As.Schmitty.html#1880" class="Function">lsigmoid</a>
<a id="2561" href="Amethyst.Network.As.Schmitty.html#2346" class="Function">reflectActivation</a> <a id="2579" href="Amethyst.Network.Base.html#914" class="InductiveConstructor">Activation.softmax</a> <a id="2598" class="Symbol">=</a> <a id="2600" href="Amethyst.Network.As.Schmitty.html#1945" class="Function">lsoftmax</a>
<a id="2609" href="Amethyst.Network.As.Schmitty.html#2346" class="Function">reflectActivation</a> <a id="2627" href="Amethyst.Network.Base.html#937" class="InductiveConstructor">Activation.tanh</a>    <a id="2646" class="Symbol">=</a> <a id="2648" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2656" href="Amethyst.Network.As.Schmitty.html#2035" class="Function">ltanh</a>


<a id="2664" class="Comment">-- * Neural networks</a>

<a id="2686" class="Keyword">private</a>
  <a id="2696" class="Keyword">variable</a>
    <a id="2709" href="Amethyst.Network.As.Schmitty.html#2709" class="Generalizable">inputs</a>  <a id="2717" class="Symbol">:</a> <a id="2719" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2725" href="Amethyst.Network.As.Schmitty.html#2725" class="Generalizable">hidden</a>  <a id="2733" class="Symbol">:</a> <a id="2735" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2741" href="Amethyst.Network.As.Schmitty.html#2741" class="Generalizable">outputs</a> <a id="2749" class="Symbol">:</a> <a id="2751" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2757" href="Amethyst.Network.As.Schmitty.html#2757" class="Generalizable">layers</a>  <a id="2765" class="Symbol">:</a> <a id="2767" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="2770" class="Comment">-- |Convert layers to SMT terms.</a>
<a id="2803" class="Comment">--</a>
<a id="2806" class="Comment">--  Takes a layer description and an environment of SMT terms describing the</a>
<a id="2883" class="Comment">--  layer inputs, and returns an environment of SMT terms describing the layer</a>
<a id="2962" class="Comment">--  outputs.</a>
<a id="reflectLayer"></a><a id="2975" href="Amethyst.Network.As.Schmitty.html#2975" class="Function">reflectLayer</a> <a id="2988" class="Symbol">:</a> <a id="2990" href="Amethyst.Network.Base.html#966" class="Record">Layer</a> <a id="2996" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="3002" href="Amethyst.Network.As.Schmitty.html#2709" class="Generalizable">inputs</a> <a id="3009" href="Amethyst.Network.As.Schmitty.html#2741" class="Generalizable">outputs</a> <a id="3017" class="Symbol">→</a> <a id="3019" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3023" class="Symbol">(</a><a id="3024" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="3029" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a><a id="3030" class="Symbol">)</a> <a id="3032" href="Amethyst.Network.As.Schmitty.html#2709" class="Generalizable">inputs</a> <a id="3039" class="Symbol">→</a> <a id="3041" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3045" class="Symbol">(</a><a id="3046" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="3051" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a><a id="3052" class="Symbol">)</a> <a id="3054" href="Amethyst.Network.As.Schmitty.html#2741" class="Generalizable">outputs</a>
<a id="3062" href="Amethyst.Network.As.Schmitty.html#2975" class="Function">reflectLayer</a> <a id="3075" href="Amethyst.Network.As.Schmitty.html#3075" class="Bound">l</a> <a id="3077" href="Amethyst.Network.As.Schmitty.html#3077" class="Bound">xs</a> <a id="3080" class="Symbol">=</a> <a id="3082" href="Amethyst.Network.As.Schmitty.html#2346" class="Function">reflectActivation</a> <a id="3100" href="Amethyst.Network.Base.html#1027" class="Function">activation</a> <a id="3111" class="Symbol">(</a><a id="3112" href="Amethyst.Network.As.Schmitty.html#3206" class="Function">biases′</a> <a id="3120" href="Amethyst.LinearAlgebra.As.Schmitty.html#1720" class="Function Operator">⊕</a> <a id="3122" class="Symbol">(</a><a id="3123" href="Amethyst.Network.As.Schmitty.html#3077" class="Bound">xs</a> <a id="3126" href="Amethyst.LinearAlgebra.As.Schmitty.html#2324" class="Function Operator">v⊡m</a> <a id="3130" href="Amethyst.Network.As.Schmitty.html#3243" class="Function">weights′</a><a id="3138" class="Symbol">))</a>
  <a id="3143" class="Keyword">where</a>
    <a id="3153" class="Keyword">open</a> <a id="3158" href="Amethyst.Network.Base.html#966" class="Module">Layer</a> <a id="3164" href="Amethyst.Network.As.Schmitty.html#3075" class="Bound">l</a> <a id="3166" class="Keyword">using</a> <a id="3172" class="Symbol">(</a><a id="3173" href="Amethyst.Network.Base.html#1027" class="Field">activation</a><a id="3183" class="Symbol">;</a> <a id="3185" href="Amethyst.Network.Base.html#1055" class="Field">weights</a><a id="3192" class="Symbol">;</a> <a id="3194" href="Amethyst.Network.Base.html#1099" class="Field">biases</a><a id="3200" class="Symbol">)</a>
    <a id="3206" href="Amethyst.Network.As.Schmitty.html#3206" class="Function">biases′</a>  <a id="3215" class="Symbol">=</a> <a id="3217" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="3225" href="Amethyst.LinearAlgebra.As.Schmitty.html#1275" class="Function">toReal</a> <a id="3232" href="Amethyst.Network.Base.html#1099" class="Function">biases</a>
    <a id="3243" href="Amethyst.Network.As.Schmitty.html#3243" class="Function">weights′</a> <a id="3252" class="Symbol">=</a> <a id="3254" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="3262" class="Symbol">(</a><a id="3263" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="3271" href="Amethyst.LinearAlgebra.As.Schmitty.html#1275" class="Function">toReal</a><a id="3277" class="Symbol">)</a> <a id="3279" href="Amethyst.Network.Base.html#1055" class="Function">weights</a>

<a id="3288" class="Comment">-- |Convert networks to SMT terms.</a>
<a id="3323" class="Comment">--</a>
<a id="3326" class="Comment">--  Takes a network description and an environment of SMT terms describing the</a>
<a id="3405" class="Comment">--  network inputs, and returns an environment of SMT terms describing the network</a>
<a id="3488" class="Comment">--  outputs.</a>
<a id="reflectNetwork"></a><a id="3501" href="Amethyst.Network.As.Schmitty.html#3501" class="Function">reflectNetwork</a> <a id="3516" class="Symbol">:</a> <a id="3518" class="Symbol">∀</a> <a id="3520" class="Symbol">{</a><a id="3521" href="Amethyst.Network.As.Schmitty.html#3521" class="Bound">n</a><a id="3522" class="Symbol">}</a> <a id="3524" class="Symbol">{</a><a id="3525" href="Amethyst.Network.As.Schmitty.html#3525" class="Bound">xs</a> <a id="3528" class="Symbol">:</a> <a id="3530" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3534" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3536" href="Amethyst.Network.As.Schmitty.html#3521" class="Bound">n</a><a id="3537" class="Symbol">}</a> <a id="3539" class="Symbol">→</a> <a id="3541" href="Amethyst.Network.Base.html#1285" class="Datatype">Network</a> <a id="3549" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="3555" href="Amethyst.Network.As.Schmitty.html#3525" class="Bound">xs</a> <a id="3558" class="Symbol">→</a> <a id="3560" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3564" class="Symbol">(</a><a id="3565" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="3570" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a><a id="3571" class="Symbol">)</a> <a id="3573" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="3575" href="Amethyst.Network.As.Schmitty.html#3525" class="Bound">xs</a> <a id="3578" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a> <a id="3581" class="Symbol">→</a> <a id="3583" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3587" class="Symbol">(</a><a id="3588" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="3593" href="Amethyst.Network.As.Schmitty.html#1704" class="Generalizable">Γ</a><a id="3594" class="Symbol">)</a> <a id="3596" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="3598" href="Amethyst.Network.As.Schmitty.html#3525" class="Bound">xs</a> <a id="3601" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a>
<a id="3604" href="Amethyst.Network.As.Schmitty.html#3501" class="Function">reflectNetwork</a> <a id="3619" href="Amethyst.Network.Base.html#1351" class="InductiveConstructor">[]</a>      <a id="3627" class="Symbol">=</a> <a id="3629" href="Function.Base.html#615" class="Function">id</a>
<a id="3632" href="Amethyst.Network.As.Schmitty.html#3501" class="Function">reflectNetwork</a> <a id="3647" class="Symbol">(</a><a id="3648" href="Amethyst.Network.As.Schmitty.html#3648" class="Bound">l</a> <a id="3650" href="Amethyst.Network.Base.html#1386" class="InductiveConstructor Operator">∷</a> <a id="3652" href="Amethyst.Network.As.Schmitty.html#3652" class="Bound">n</a><a id="3653" class="Symbol">)</a> <a id="3655" class="Symbol">=</a> <a id="3657" href="Amethyst.Network.As.Schmitty.html#3501" class="Function">reflectNetwork</a> <a id="3672" href="Amethyst.Network.As.Schmitty.html#3652" class="Bound">n</a> <a id="3674" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3676" href="Amethyst.Network.As.Schmitty.html#2975" class="Function">reflectLayer</a> <a id="3689" href="Amethyst.Network.As.Schmitty.html#3648" class="Bound">l</a>

<a id="3692" class="Comment">-- |Convert a networks to an SMT script, and allow the caller to append further commands.</a>
<a id="withReflectedNetworkAsScript"></a><a id="3782" href="Amethyst.Network.As.Schmitty.html#3782" class="Function">withReflectedNetworkAsScript</a>
  <a id="3813" class="Symbol">:</a> <a id="3815" class="Symbol">∀</a> <a id="3817" class="Symbol">{</a><a id="3818" href="Amethyst.Network.As.Schmitty.html#3818" class="Bound">Γ</a> <a id="3820" href="Amethyst.Network.As.Schmitty.html#3820" class="Bound">Ξ</a><a id="3821" class="Symbol">}</a> <a id="3823" class="Symbol">{</a><a id="3824" href="Amethyst.Network.As.Schmitty.html#3824" class="Bound">ls</a> <a id="3827" class="Symbol">:</a> <a id="3829" href="Amethyst.Network.Base.html#1127" class="Function">LayerSpec</a> <a id="3839" href="Amethyst.Network.As.Schmitty.html#2757" class="Generalizable">layers</a><a id="3845" class="Symbol">}</a>
  <a id="3849" class="Symbol">→</a> <a id="3851" href="Amethyst.Network.Base.html#1285" class="Datatype">Network</a> <a id="3859" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="3865" href="Amethyst.Network.As.Schmitty.html#3824" class="Bound">ls</a>
  <a id="3870" class="Symbol">→</a> <a id="3872" class="Symbol">(</a> <a id="3874" class="Symbol">(</a><a id="3875" href="Amethyst.Network.As.Schmitty.html#3875" class="Bound">iv</a> <a id="3878" class="Symbol">:</a> <a id="3880" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3884" class="Symbol">(</a><a id="3885" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="3890" class="Symbol">(</a><a id="3891" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="3897" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="3899" href="Amethyst.Network.As.Schmitty.html#3824" class="Bound">ls</a> <a id="3902" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a> <a id="3905" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="3908" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="3914" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="3916" href="Amethyst.Network.As.Schmitty.html#3824" class="Bound">ls</a> <a id="3919" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a><a id="3921" class="Symbol">))</a> <a id="3924" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="3926" href="Amethyst.Network.As.Schmitty.html#3824" class="Bound">ls</a> <a id="3929" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a><a id="3931" class="Symbol">)</a>
    <a id="3937" class="Symbol">→</a> <a id="3939" class="Symbol">(</a><a id="3940" href="Amethyst.Network.As.Schmitty.html#3940" class="Bound">ov</a> <a id="3943" class="Symbol">:</a> <a id="3945" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3949" class="Symbol">(</a><a id="3950" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="3955" class="Symbol">(</a><a id="3956" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="3962" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="3964" href="Amethyst.Network.As.Schmitty.html#3824" class="Bound">ls</a> <a id="3967" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a> <a id="3970" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="3973" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="3979" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="3981" href="Amethyst.Network.As.Schmitty.html#3824" class="Bound">ls</a> <a id="3984" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a><a id="3986" class="Symbol">))</a> <a id="3989" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="3991" href="Amethyst.Network.As.Schmitty.html#3824" class="Bound">ls</a> <a id="3994" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a><a id="3996" class="Symbol">)</a>
    <a id="4002" class="Symbol">→</a> <a id="4004" class="Symbol">(</a><a id="4005" href="SMT.Script.Base.html#10098" class="Datatype">Script</a> <a id="4012" class="Symbol">(</a><a id="4013" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4019" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="4021" href="Amethyst.Network.As.Schmitty.html#3824" class="Bound">ls</a> <a id="4024" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a> <a id="4027" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4030" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4036" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="4038" href="Amethyst.Network.As.Schmitty.html#3824" class="Bound">ls</a> <a id="4041" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a><a id="4043" class="Symbol">)</a> <a id="4045" href="Amethyst.Network.As.Schmitty.html#3818" class="Bound">Γ</a> <a id="4047" href="Amethyst.Network.As.Schmitty.html#3820" class="Bound">Ξ</a><a id="4048" class="Symbol">))</a>
  <a id="4053" class="Symbol">→</a> <a id="4055" href="SMT.Script.Base.html#10098" class="Datatype">Script</a> <a id="4062" class="InductiveConstructor">[]</a> <a id="4065" href="Amethyst.Network.As.Schmitty.html#3818" class="Bound">Γ</a> <a id="4067" href="Amethyst.Network.As.Schmitty.html#3820" class="Bound">Ξ</a>
<a id="4069" href="Amethyst.Network.As.Schmitty.html#3782" class="Function">withReflectedNetworkAsScript</a> <a id="4098" class="Symbol">{</a><a id="4099" class="Argument">ls</a> <a id="4102" class="Symbol">=</a> <a id="4104" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a><a id="4106" class="Symbol">}</a> <a id="4108" href="Amethyst.Network.As.Schmitty.html#4108" class="Bound">n</a> <a id="4110" href="Amethyst.Network.As.Schmitty.html#4110" class="Bound">constraints</a>
  <a id="4124" class="Symbol">=</a> <a id="4126" class="Symbol">(</a> <a id="4128" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a> <a id="4137" class="Symbol">(λ</a> <a id="4140" href="Amethyst.Network.As.Schmitty.html#4140" class="Bound">Γ</a> <a id="4142" class="Symbol">→</a> <a id="4144" href="SMT.Script.Base.html#10098" class="Datatype">Script</a> <a id="4151" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4154" href="Amethyst.Network.As.Schmitty.html#4140" class="Bound">Γ</a> <a id="4156" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4158" class="Symbol">)</a> <a id="4160" class="Symbol">(</a><a id="4161" href="Data.List.Properties.Extra.html#807" class="Function">List.ʳ++-reverse</a> <a id="4178" class="Symbol">(</a><a id="4179" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4185" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="4187" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4190" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a><a id="4192" class="Symbol">)</a> <a id="4194" class="Symbol">(</a><a id="4195" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4201" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="4203" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4206" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a><a id="4208" class="Symbol">))</a>
    <a id="4215" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4217" href="SMT.Script.Base.html#11015" class="Function">`declare-consts</a> <a id="4233" class="Symbol">(</a><a id="4234" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4247" class="Symbol">(</a><a id="4248" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4254" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="4256" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4259" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a><a id="4261" class="Symbol">))</a>
    <a id="4268" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4270" href="SMT.Script.Base.html#11015" class="Function">`declare-consts</a> <a id="4286" class="Symbol">(</a><a id="4287" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4300" class="Symbol">(</a><a id="4301" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4307" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="4309" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4312" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a><a id="4314" class="Symbol">))</a>
    <a id="4321" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4323" href="SMT.Script.Base.html#9866" class="InductiveConstructor">`assert</a> <a id="4331" class="Symbol">(</a><a id="4332" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="4342" class="Symbol">_</a>
        <a id="4352" class="Symbol">(</a><a id="4353" href="SMT.Script.Base.html#3991" class="InductiveConstructor">`app₂</a> <a id="4359" href="SMT.Theories.Core.Extensions.html#1830" class="Function">and</a><a id="4362" class="Symbol">)</a>
        <a id="4372" class="Symbol">(</a><a id="4373" href="SMT.Script.Base.html#3917" class="InductiveConstructor">`app₀</a> <a id="4379" href="SMT.Theories.Core.Extensions.html#1557" class="Function">true</a><a id="4383" class="Symbol">)</a>
        <a id="4393" class="Symbol">(</a><a id="4394" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a>
          <a id="4416" class="Symbol">(</a><a id="4417" href="SMT.Script.Base.html#3991" class="InductiveConstructor">`app₂</a> <a id="4423" href="SMT.Theories.Reals.Base.html#4506" class="InductiveConstructor">eq</a><a id="4425" class="Symbol">)</a>
          <a id="4437" class="Symbol">(</a><a id="4438" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a> <a id="4447" class="Symbol">(λ</a> <a id="4450" href="Amethyst.Network.As.Schmitty.html#4450" class="Bound">Γ</a> <a id="4452" class="Symbol">→</a> <a id="4454" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4458" class="Symbol">(</a><a id="4459" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="4464" href="Amethyst.Network.As.Schmitty.html#4450" class="Bound">Γ</a><a id="4465" class="Symbol">)</a> <a id="4467" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="4469" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4472" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a><a id="4474" class="Symbol">)</a> <a id="4476" class="Symbol">(</a><a id="4477" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">Eq.sym</a> <a id="4484" class="Symbol">(</a><a id="4485" href="Data.List.Properties.Extra.html#807" class="Function">List.ʳ++-reverse</a> <a id="4502" class="Symbol">(</a><a id="4503" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4509" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="4511" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4514" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a><a id="4516" class="Symbol">)</a> <a id="4518" class="Symbol">(</a><a id="4519" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4525" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="4527" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4530" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a><a id="4532" class="Symbol">)))</a> <a id="4536" href="Amethyst.Network.As.Schmitty.html#4829" class="Function">ov</a><a id="4538" class="Symbol">)</a>
          <a id="4550" class="Symbol">(</a><a id="4551" href="Amethyst.Network.As.Schmitty.html#3501" class="Function">reflectNetwork</a> <a id="4566" href="Amethyst.Network.As.Schmitty.html#4108" class="Bound">n</a>
                          <a id="4594" class="Symbol">(</a><a id="4595" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a> <a id="4604" class="Symbol">(λ</a> <a id="4607" href="Amethyst.Network.As.Schmitty.html#4607" class="Bound">Γ</a> <a id="4609" class="Symbol">→</a> <a id="4611" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4615" class="Symbol">(</a><a id="4616" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="4621" href="Amethyst.Network.As.Schmitty.html#4607" class="Bound">Γ</a><a id="4622" class="Symbol">)</a> <a id="4624" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="4626" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4629" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a><a id="4631" class="Symbol">)</a> <a id="4633" class="Symbol">(</a><a id="4634" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">Eq.sym</a> <a id="4641" class="Symbol">(</a><a id="4642" href="Data.List.Properties.Extra.html#807" class="Function">List.ʳ++-reverse</a> <a id="4659" class="Symbol">(</a><a id="4660" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4666" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="4668" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4671" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a><a id="4673" class="Symbol">)</a> <a id="4675" class="Symbol">(</a><a id="4676" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4682" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="4684" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4687" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a><a id="4689" class="Symbol">)))</a> <a id="4693" href="Amethyst.Network.As.Schmitty.html#4745" class="Function">iv</a><a id="4695" class="Symbol">))))</a>
    <a id="4704" href="SMT.Script.Base.html#10183" class="InductiveConstructor Operator">∷</a> <a id="4706" href="SMT.Script.Base.html#10161" class="InductiveConstructor">[]</a>
    <a id="4713" class="Symbol">)</a> <a id="4715" href="SMT.Script.Base.html#10268" class="Function Operator">◆</a> <a id="4717" href="Amethyst.Network.As.Schmitty.html#4110" class="Bound">constraints</a> <a id="4729" href="Amethyst.Network.As.Schmitty.html#4745" class="Function">iv</a> <a id="4732" href="Amethyst.Network.As.Schmitty.html#4829" class="Function">ov</a>
  <a id="4737" class="Keyword">where</a>
  <a id="4745" href="Amethyst.Network.As.Schmitty.html#4745" class="Function">iv</a> <a id="4748" class="Symbol">=</a> <a id="4750" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="4758" class="Symbol">(</a><a id="4759" href="SMT.Script.Base.html#3297" class="InductiveConstructor">`var</a> <a id="4764" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4766" href="SMT.Script.Base.html#2834" class="Function">injectVar</a> <a id="4776" class="Symbol">(</a><a id="4777" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4783" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="4785" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4788" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a><a id="4790" class="Symbol">)</a> <a id="4792" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4794" href="Amethyst.LinearAlgebra.As.Schmitty.html#1482" class="Function">Reals∋Real</a><a id="4804" class="Symbol">)</a> <a id="4806" class="Symbol">(</a><a id="4807" href="Data.Vec.Base.html#5972" class="Function">Vec.allFin</a> <a id="4818" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="4820" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4823" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a><a id="4825" class="Symbol">)</a>
  <a id="4829" href="Amethyst.Network.As.Schmitty.html#4829" class="Function">ov</a> <a id="4832" class="Symbol">=</a> <a id="4834" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="4842" class="Symbol">(</a><a id="4843" href="SMT.Script.Base.html#3297" class="InductiveConstructor">`var</a> <a id="4848" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4850" href="SMT.Script.Base.html#2913" class="Function">raiseVar</a>  <a id="4860" class="Symbol">(</a><a id="4861" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="4867" href="Amethyst.Network.Base.html#1166" class="Function Operator">∣</a> <a id="4869" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4872" href="Amethyst.Network.Base.html#1166" class="Function Operator">₀∣</a><a id="4874" class="Symbol">)</a> <a id="4876" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4878" href="Amethyst.LinearAlgebra.As.Schmitty.html#1482" class="Function">Reals∋Real</a><a id="4888" class="Symbol">)</a> <a id="4890" class="Symbol">(</a><a id="4891" href="Data.Vec.Base.html#5972" class="Function">Vec.allFin</a> <a id="4902" href="Amethyst.Network.Base.html#1216" class="Function Operator">∣</a> <a id="4904" href="Amethyst.Network.As.Schmitty.html#4104" class="Bound">ls</a> <a id="4907" href="Amethyst.Network.Base.html#1216" class="Function Operator">ₙ∣</a><a id="4909" class="Symbol">)</a>
</pre></body></html>