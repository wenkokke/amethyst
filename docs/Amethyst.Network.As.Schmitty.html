<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.Network.As.Schmitty</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Amethyst.Network.As.Schmitty.html" class="Module">Amethyst.Network.As.Schmitty</a> <a id="37" class="Keyword">where</a>

<a id="44" class="Keyword">open</a> <a id="49" class="Keyword">import</a> <a id="56" href="Amethyst.Network.html" class="Module">Amethyst.Network</a> <a id="73" class="Keyword">using</a> <a id="79" class="Symbol">(</a><a id="80" href="Amethyst.Network.html#677" class="Datatype">Network</a><a id="87" class="Symbol">;</a> <a id="89" href="Amethyst.Network.html#745" class="InductiveConstructor">[]</a><a id="91" class="Symbol">;</a> <a id="93" href="Amethyst.Network.html#779" class="InductiveConstructor Operator">_∷_</a><a id="96" class="Symbol">;</a> <a id="98" href="Amethyst.Network.html#497" class="Record">Layer</a><a id="103" class="Symbol">;</a> <a id="105" href="Amethyst.Network.html#351" class="Datatype">Activation</a><a id="115" class="Symbol">)</a>
<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="Amethyst.PiecewiseLinear.Base.html" class="Module">Amethyst.PiecewiseLinear.Base</a>
<a id="159" class="Keyword">open</a> <a id="164" class="Keyword">import</a> <a id="171" href="Amethyst.PiecewiseLinear.As.Schmitty.html" class="Module">Amethyst.PiecewiseLinear.As.Schmitty</a>
<a id="208" class="Keyword">open</a> <a id="213" class="Keyword">import</a> <a id="220" href="Amethyst.LinearAlgebra.As.Schmitty.html" class="Module">Amethyst.LinearAlgebra.As.Schmitty</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="277" class="Symbol">as</a> <a id="280" class="Module">Bool</a> <a id="285" class="Keyword">using</a> <a id="291" class="Symbol">(</a><a id="292" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="296" class="Symbol">;</a> <a id="298" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="303" class="Symbol">;</a> <a id="305" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="309" class="Symbol">)</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="332" class="Symbol">as</a> <a id="335" class="Module">Fin</a> <a id="339" class="Keyword">using</a> <a id="345" class="Symbol">(</a><a id="346" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="349" class="Symbol">;</a> <a id="351" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a><a id="355" class="Symbol">;</a> <a id="357" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a><a id="360" class="Symbol">)</a>
<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="Data.Float.html" class="Module">Data.Float</a> <a id="385" class="Symbol">as</a> <a id="388" class="Module">Float</a> <a id="394" class="Keyword">using</a> <a id="400" class="Symbol">(</a><a id="401" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="406" class="Symbol">)</a>
<a id="408" class="Keyword">open</a> <a id="413" class="Keyword">import</a> <a id="420" href="Data.List.html" class="Module">Data.List</a> <a id="430" class="Symbol">as</a> <a id="433" class="Module">List</a> <a id="438" class="Keyword">using</a> <a id="444" class="Symbol">(</a><a id="445" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="449" class="Symbol">;</a> <a id="451" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="453" class="Symbol">;</a> <a id="455" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="458" class="Symbol">;</a> <a id="460" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="464" class="Symbol">;</a> <a id="466" href="Data.List.Base.html#9558" class="Function Operator">_ʳ++_</a><a id="471" class="Symbol">)</a>
<a id="473" class="Keyword">import</a> <a id="480" href="Data.List.Properties.html" class="Module">Data.List.Properties</a> <a id="501" class="Symbol">as</a> <a id="504" class="Module">List</a>
<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="530" class="Symbol">as</a> <a id="533" class="Module">Nat</a> <a id="537" class="Keyword">using</a> <a id="543" class="Symbol">(</a><a id="544" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="545" class="Symbol">;</a> <a id="547" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="551" class="Symbol">;</a> <a id="553" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="556" class="Symbol">)</a>
<a id="558" class="Keyword">open</a> <a id="563" class="Keyword">import</a> <a id="570" href="Data.Product.html" class="Module">Data.Product</a> <a id="583" class="Symbol">as</a> <a id="586" class="Module">Prod</a> <a id="591" class="Keyword">using</a> <a id="597" class="Symbol">(</a><a id="598" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="601" class="Symbol">;</a> <a id="603" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="606" class="Symbol">;</a> <a id="608" href="Data.Product.html#3399" class="Function">uncurry</a><a id="615" class="Symbol">)</a>
<a id="617" class="Keyword">open</a> <a id="622" class="Keyword">import</a> <a id="629" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="638" class="Symbol">as</a> <a id="641" class="Module">Vec</a> <a id="645" class="Keyword">using</a> <a id="651" class="Symbol">(</a><a id="652" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="655" class="Symbol">;</a> <a id="657" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="659" class="Symbol">;</a> <a id="661" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="664" class="Symbol">)</a>
<a id="666" class="Keyword">open</a> <a id="671" class="Keyword">import</a> <a id="678" href="Function.html" class="Module">Function</a> <a id="687" class="Keyword">using</a> <a id="693" class="Symbol">(</a><a id="694" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="697" class="Symbol">;</a> <a id="699" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="702" class="Symbol">;</a> <a id="704" href="Function.Base.html#2210" class="Function Operator">_|&gt;_</a><a id="708" class="Symbol">;</a> <a id="710" href="Function.Base.html#615" class="Function">id</a><a id="712" class="Symbol">)</a>
<a id="714" class="Keyword">open</a> <a id="719" class="Keyword">import</a> <a id="726" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="764" class="Symbol">as</a> <a id="767" class="Module">Eq</a> <a id="770" class="Keyword">using</a> <a id="776" class="Symbol">(</a><a id="777" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="780" class="Symbol">;</a> <a id="782" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="786" class="Symbol">)</a>
<a id="788" class="Keyword">open</a> <a id="793" href="Relation.Binary.PropositionalEquality.Core.html#2647" class="Module">Eq.≡-Reasoning</a>

<a id="809" class="Comment">-- * Activation functions</a>

<a id="836" class="Keyword">private</a>
  <a id="846" class="Keyword">variable</a>
    <a id="859" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a> <a id="861" class="Symbol">:</a> <a id="863" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a>
    <a id="872" href="Amethyst.Network.As.Schmitty.html#872" class="Generalizable">n</a> <a id="874" class="Symbol">:</a> <a id="876" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="879" class="Keyword">private</a>
  <a id="relu"></a><a id="889" href="Amethyst.Network.As.Schmitty.html#889" class="Function">relu</a> <a id="894" class="Symbol">:</a> <a id="896" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="901" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a> <a id="903" class="Symbol">→</a> <a id="905" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="910" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a>
  <a id="914" href="Amethyst.Network.As.Schmitty.html#889" class="Function">relu</a> <a id="919" href="Amethyst.Network.As.Schmitty.html#919" class="Bound">x</a> <a id="921" class="Symbol">=</a> <a id="923" href="SMT.Script.Base.html#1976" class="InductiveConstructor">app₃</a> <a id="928" href="SMT.Theories.Reals.html#4452" class="InductiveConstructor">ite</a> <a id="932" class="Symbol">(</a><a id="933" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="938" href="SMT.Theories.Reals.html#4653" class="InductiveConstructor">leq</a> <a id="942" href="Amethyst.Network.As.Schmitty.html#919" class="Bound">x</a> <a id="944" class="Symbol">(</a><a id="945" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="949" class="Symbol">(</a><a id="950" href="SMT.Theories.Reals.html#3838" class="InductiveConstructor">nat</a> <a id="954" class="Number">0</a><a id="955" class="Symbol">)))</a> <a id="959" class="Symbol">(</a><a id="960" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="964" class="Symbol">(</a><a id="965" href="SMT.Theories.Reals.html#3838" class="InductiveConstructor">nat</a> <a id="969" class="Number">0</a><a id="970" class="Symbol">))</a> <a id="973" href="Amethyst.Network.As.Schmitty.html#919" class="Bound">x</a>

  <a id="lexp"></a><a id="978" href="Amethyst.Network.As.Schmitty.html#978" class="Function">lexp</a> <a id="983" class="Symbol">:</a> <a id="985" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="990" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a> <a id="992" class="Symbol">→</a> <a id="994" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="999" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a>
  <a id="1003" href="Amethyst.Network.As.Schmitty.html#978" class="Function">lexp</a> <a id="1008" class="Symbol">=</a> <a id="1010" href="Amethyst.PiecewiseLinear.As.Schmitty.html#1787" class="Function">reflectExtrap</a> <a id="1024" class="Symbol">(</a><a id="1025" href="Amethyst.PiecewiseLinear.Base.html#3005" class="Function">linearise</a> <a id="1035" href="Agda.Builtin.Float.html#1691" class="Primitive Operator">Float.e^_</a> <a id="1045" class="Number">-4.0</a> <a id="1050" class="Number">4.0</a> <a id="1054" class="Number">15</a><a id="1056" class="Symbol">)</a>

  <a id="lsigmoid"></a><a id="1061" href="Amethyst.Network.As.Schmitty.html#1061" class="Function">lsigmoid</a> <a id="1070" class="Symbol">:</a> <a id="1072" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1077" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a> <a id="1079" class="Symbol">→</a> <a id="1081" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1086" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a>
  <a id="1090" href="Amethyst.Network.As.Schmitty.html#1061" class="Function">lsigmoid</a> <a id="1099" href="Amethyst.Network.As.Schmitty.html#1099" class="Bound">x</a> <a id="1101" class="Symbol">=</a> <a id="1103" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1108" href="SMT.Theories.Reals.html#4622" class="InductiveConstructor">div</a> <a id="1112" class="Symbol">(</a><a id="1113" href="Amethyst.LinearAlgebra.As.Schmitty.html#714" class="Function">toReal</a> <a id="1120" class="Number">1.0</a><a id="1123" class="Symbol">)</a> <a id="1125" class="Symbol">(</a><a id="1126" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1131" href="SMT.Theories.Reals.html#4560" class="InductiveConstructor">add</a> <a id="1135" class="Symbol">(</a><a id="1136" href="Amethyst.LinearAlgebra.As.Schmitty.html#714" class="Function">toReal</a> <a id="1143" class="Number">1.0</a><a id="1146" class="Symbol">)</a> <a id="1148" class="Symbol">(</a><a id="1149" href="Amethyst.Network.As.Schmitty.html#978" class="Function">lexp</a> <a id="1154" class="Symbol">(</a><a id="1155" href="SMT.Script.Base.html#1896" class="InductiveConstructor">app₁</a> <a id="1160" href="SMT.Theories.Reals.html#4498" class="InductiveConstructor">neg</a> <a id="1164" href="Amethyst.Network.As.Schmitty.html#1099" class="Bound">x</a><a id="1165" class="Symbol">)))</a>

  <a id="lsoftmax"></a><a id="1172" href="Amethyst.Network.As.Schmitty.html#1172" class="Function">lsoftmax</a> <a id="1181" class="Symbol">:</a> <a id="1183" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1187" class="Symbol">(</a><a id="1188" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1193" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a><a id="1194" class="Symbol">)</a> <a id="1196" href="Amethyst.Network.As.Schmitty.html#872" class="Generalizable">n</a> <a id="1198" class="Symbol">→</a> <a id="1200" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1204" class="Symbol">(</a><a id="1205" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1210" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a><a id="1211" class="Symbol">)</a> <a id="1213" href="Amethyst.Network.As.Schmitty.html#872" class="Generalizable">n</a>
  <a id="1217" href="Amethyst.Network.As.Schmitty.html#1172" class="Function">lsoftmax</a> <a id="1226" href="Amethyst.Network.As.Schmitty.html#1226" class="Bound">xs</a> <a id="1229" class="Symbol">=</a> <a id="1231" href="Amethyst.LinearAlgebra.As.Schmitty.html#1602" class="Function">normalise</a> <a id="1241" class="Symbol">(</a><a id="1242" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1250" href="Amethyst.Network.As.Schmitty.html#978" class="Function">lexp</a> <a id="1255" href="Amethyst.Network.As.Schmitty.html#1226" class="Bound">xs</a><a id="1257" class="Symbol">)</a>

  <a id="ltanh"></a><a id="1262" href="Amethyst.Network.As.Schmitty.html#1262" class="Function">ltanh</a> <a id="1268" class="Symbol">:</a> <a id="1270" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1275" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a> <a id="1277" class="Symbol">→</a> <a id="1279" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1284" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a>
  <a id="1288" href="Amethyst.Network.As.Schmitty.html#1262" class="Function">ltanh</a> <a id="1294" class="Symbol">=</a> <a id="1296" href="Amethyst.PiecewiseLinear.As.Schmitty.html#1787" class="Function">reflectExtrap</a> <a id="1310" class="Symbol">(</a><a id="1311" href="Amethyst.PiecewiseLinear.Base.html#3005" class="Function">linearise</a> <a id="1321" href="Agda.Builtin.Float.html#2194" class="Primitive">Float.tanh</a> <a id="1332" class="Number">-3.0</a> <a id="1337" class="Number">3.0</a> <a id="1341" class="Number">3</a><a id="1342" class="Symbol">)</a>

<a id="1345" class="Comment">-- |Convert activation functions to SMT terms.</a>
<a id="1392" class="Comment">--</a>
<a id="1395" class="Comment">--  Takes an activation function description and an environment of SMT terms</a>
<a id="1472" class="Comment">--  describing the activation function inputs, and returns an environment of SMT</a>
<a id="1553" class="Comment">--  terms with the activation function applied.</a>
<a id="reflectActivation"></a><a id="1601" href="Amethyst.Network.As.Schmitty.html#1601" class="Function">reflectActivation</a> <a id="1619" class="Symbol">:</a> <a id="1621" href="Amethyst.Network.html#351" class="Datatype">Activation</a> <a id="1632" class="Symbol">→</a> <a id="1634" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1638" class="Symbol">(</a><a id="1639" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1644" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a><a id="1645" class="Symbol">)</a> <a id="1647" href="Amethyst.Network.As.Schmitty.html#872" class="Generalizable">n</a> <a id="1649" class="Symbol">→</a> <a id="1651" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1655" class="Symbol">(</a><a id="1656" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1661" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a><a id="1662" class="Symbol">)</a> <a id="1664" href="Amethyst.Network.As.Schmitty.html#872" class="Generalizable">n</a>
<a id="1666" href="Amethyst.Network.As.Schmitty.html#1601" class="Function">reflectActivation</a> <a id="1684" href="Amethyst.Network.html#376" class="InductiveConstructor">Activation.linear</a>  <a id="1703" class="Symbol">=</a> <a id="1705" href="Function.Base.html#615" class="Function">id</a>
<a id="1708" href="Amethyst.Network.As.Schmitty.html#1601" class="Function">reflectActivation</a> <a id="1726" href="Amethyst.Network.html#399" class="InductiveConstructor">Activation.relu</a>    <a id="1745" class="Symbol">=</a> <a id="1747" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1755" href="Amethyst.Network.As.Schmitty.html#889" class="Function">relu</a>
<a id="1760" href="Amethyst.Network.As.Schmitty.html#1601" class="Function">reflectActivation</a> <a id="1778" href="Amethyst.Network.html#422" class="InductiveConstructor">Activation.sigmoid</a> <a id="1797" class="Symbol">=</a> <a id="1799" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1807" href="Amethyst.Network.As.Schmitty.html#1061" class="Function">lsigmoid</a>
<a id="1816" href="Amethyst.Network.As.Schmitty.html#1601" class="Function">reflectActivation</a> <a id="1834" href="Amethyst.Network.html#445" class="InductiveConstructor">Activation.softmax</a> <a id="1853" class="Symbol">=</a> <a id="1855" href="Amethyst.Network.As.Schmitty.html#1172" class="Function">lsoftmax</a>
<a id="1864" href="Amethyst.Network.As.Schmitty.html#1601" class="Function">reflectActivation</a> <a id="1882" href="Amethyst.Network.html#468" class="InductiveConstructor">Activation.tanh</a>    <a id="1901" class="Symbol">=</a> <a id="1903" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1911" href="Amethyst.Network.As.Schmitty.html#1262" class="Function">ltanh</a>


<a id="1919" class="Comment">-- * Neural networks</a>

<a id="1941" class="Keyword">private</a>
  <a id="1951" class="Keyword">variable</a>
    <a id="1964" href="Amethyst.Network.As.Schmitty.html#1964" class="Generalizable">inputs</a>  <a id="1972" class="Symbol">:</a> <a id="1974" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1980" href="Amethyst.Network.As.Schmitty.html#1980" class="Generalizable">hidden</a>  <a id="1988" class="Symbol">:</a> <a id="1990" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1996" href="Amethyst.Network.As.Schmitty.html#1996" class="Generalizable">outputs</a> <a id="2004" class="Symbol">:</a> <a id="2006" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2012" href="Amethyst.Network.As.Schmitty.html#2012" class="Generalizable">layers</a>  <a id="2020" class="Symbol">:</a> <a id="2022" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="2025" class="Comment">-- |Convert layers to SMT terms.</a>
<a id="2058" class="Comment">--</a>
<a id="2061" class="Comment">--  Takes a layer description and an environment of SMT terms describing the</a>
<a id="2138" class="Comment">--  layer inputs, and returns an environment of SMT terms describing the layer</a>
<a id="2217" class="Comment">--  outputs.</a>
<a id="reflectLayer"></a><a id="2230" href="Amethyst.Network.As.Schmitty.html#2230" class="Function">reflectLayer</a> <a id="2243" class="Symbol">:</a> <a id="2245" href="Amethyst.Network.html#497" class="Record">Layer</a> <a id="2251" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="2257" href="Amethyst.Network.As.Schmitty.html#1964" class="Generalizable">inputs</a> <a id="2264" href="Amethyst.Network.As.Schmitty.html#1996" class="Generalizable">outputs</a> <a id="2272" class="Symbol">→</a> <a id="2274" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2278" class="Symbol">(</a><a id="2279" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="2284" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a><a id="2285" class="Symbol">)</a> <a id="2287" href="Amethyst.Network.As.Schmitty.html#1964" class="Generalizable">inputs</a> <a id="2294" class="Symbol">→</a> <a id="2296" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2300" class="Symbol">(</a><a id="2301" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="2306" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a><a id="2307" class="Symbol">)</a> <a id="2309" href="Amethyst.Network.As.Schmitty.html#1996" class="Generalizable">outputs</a>
<a id="2317" href="Amethyst.Network.As.Schmitty.html#2230" class="Function">reflectLayer</a> <a id="2330" href="Amethyst.Network.As.Schmitty.html#2330" class="Bound">l</a> <a id="2332" href="Amethyst.Network.As.Schmitty.html#2332" class="Bound">xs</a> <a id="2335" class="Symbol">=</a> <a id="2337" href="Amethyst.Network.As.Schmitty.html#1601" class="Function">reflectActivation</a> <a id="2355" href="Amethyst.Network.html#633" class="Function">activation</a> <a id="2366" class="Symbol">(</a><a id="2367" href="Amethyst.Network.As.Schmitty.html#2461" class="Function">biases′</a> <a id="2375" href="Amethyst.LinearAlgebra.As.Schmitty.html#1194" class="Function Operator">⊕</a> <a id="2377" class="Symbol">(</a><a id="2378" href="Amethyst.Network.As.Schmitty.html#2332" class="Bound">xs</a> <a id="2381" href="Amethyst.LinearAlgebra.As.Schmitty.html#1794" class="Function Operator">v⊡m</a> <a id="2385" href="Amethyst.Network.As.Schmitty.html#2498" class="Function">weights′</a><a id="2393" class="Symbol">))</a>
  <a id="2398" class="Keyword">where</a>
    <a id="2408" class="Keyword">open</a> <a id="2413" href="Amethyst.Network.html#497" class="Module">Layer</a> <a id="2419" href="Amethyst.Network.As.Schmitty.html#2330" class="Bound">l</a> <a id="2421" class="Keyword">using</a> <a id="2427" class="Symbol">(</a><a id="2428" href="Amethyst.Network.html#633" class="Field">activation</a><a id="2438" class="Symbol">;</a> <a id="2440" href="Amethyst.Network.html#558" class="Field">weights</a><a id="2447" class="Symbol">;</a> <a id="2449" href="Amethyst.Network.html#602" class="Field">biases</a><a id="2455" class="Symbol">)</a>
    <a id="2461" href="Amethyst.Network.As.Schmitty.html#2461" class="Function">biases′</a>  <a id="2470" class="Symbol">=</a> <a id="2472" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2480" href="Amethyst.LinearAlgebra.As.Schmitty.html#714" class="Function">toReal</a> <a id="2487" href="Amethyst.Network.html#602" class="Function">biases</a>
    <a id="2498" href="Amethyst.Network.As.Schmitty.html#2498" class="Function">weights′</a> <a id="2507" class="Symbol">=</a> <a id="2509" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2517" class="Symbol">(</a><a id="2518" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2526" href="Amethyst.LinearAlgebra.As.Schmitty.html#714" class="Function">toReal</a><a id="2532" class="Symbol">)</a> <a id="2534" href="Amethyst.Network.html#558" class="Function">weights</a>

<a id="2543" class="Comment">-- |Convert networks to SMT terms.</a>
<a id="2578" class="Comment">--</a>
<a id="2581" class="Comment">--  Takes a network description and an environment of SMT terms describing the</a>
<a id="2660" class="Comment">--  network inputs, and returns an environment of SMT terms describing the network</a>
<a id="2743" class="Comment">--  outputs.</a>
<a id="reflectNetwork"></a><a id="2756" href="Amethyst.Network.As.Schmitty.html#2756" class="Function">reflectNetwork</a> <a id="2771" class="Symbol">:</a> <a id="2773" href="Amethyst.Network.html#677" class="Datatype">Network</a> <a id="2781" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="2787" href="Amethyst.Network.As.Schmitty.html#1964" class="Generalizable">inputs</a> <a id="2794" href="Amethyst.Network.As.Schmitty.html#1996" class="Generalizable">outputs</a> <a id="2802" href="Amethyst.Network.As.Schmitty.html#2012" class="Generalizable">layers</a> <a id="2809" class="Symbol">→</a> <a id="2811" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2815" class="Symbol">(</a><a id="2816" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="2821" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a><a id="2822" class="Symbol">)</a> <a id="2824" href="Amethyst.Network.As.Schmitty.html#1964" class="Generalizable">inputs</a> <a id="2831" class="Symbol">→</a> <a id="2833" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2837" class="Symbol">(</a><a id="2838" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="2843" href="Amethyst.Network.As.Schmitty.html#859" class="Generalizable">Γ</a><a id="2844" class="Symbol">)</a> <a id="2846" href="Amethyst.Network.As.Schmitty.html#1996" class="Generalizable">outputs</a>
<a id="2854" href="Amethyst.Network.As.Schmitty.html#2756" class="Function">reflectNetwork</a> <a id="2869" href="Amethyst.Network.html#745" class="InductiveConstructor">[]</a>      <a id="2877" class="Symbol">=</a> <a id="2879" href="Function.Base.html#615" class="Function">id</a>
<a id="2882" href="Amethyst.Network.As.Schmitty.html#2756" class="Function">reflectNetwork</a> <a id="2897" class="Symbol">(</a><a id="2898" href="Amethyst.Network.As.Schmitty.html#2898" class="Bound">l</a> <a id="2900" href="Amethyst.Network.html#779" class="InductiveConstructor Operator">∷</a> <a id="2902" href="Amethyst.Network.As.Schmitty.html#2902" class="Bound">n</a><a id="2903" class="Symbol">)</a> <a id="2905" class="Symbol">=</a> <a id="2907" href="Amethyst.Network.As.Schmitty.html#2756" class="Function">reflectNetwork</a> <a id="2922" href="Amethyst.Network.As.Schmitty.html#2902" class="Bound">n</a> <a id="2924" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2926" href="Amethyst.Network.As.Schmitty.html#2230" class="Function">reflectLayer</a> <a id="2939" href="Amethyst.Network.As.Schmitty.html#2898" class="Bound">l</a>

<a id="2942" class="Keyword">private</a>
  <a id="NetworkCtxt"></a><a id="2952" href="Amethyst.Network.As.Schmitty.html#2952" class="Function">NetworkCtxt</a> <a id="2964" class="Symbol">:</a> <a id="2966" class="Symbol">(</a><a id="2967" href="Amethyst.Network.As.Schmitty.html#2967" class="Bound">inputs</a> <a id="2974" href="Amethyst.Network.As.Schmitty.html#2974" class="Bound">outputs</a> <a id="2982" class="Symbol">:</a> <a id="2984" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="2985" class="Symbol">)</a> <a id="2987" class="Symbol">→</a> <a id="2989" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a>
  <a id="2996" href="Amethyst.Network.As.Schmitty.html#2952" class="Function">NetworkCtxt</a> <a id="3008" href="Amethyst.Network.As.Schmitty.html#3008" class="Bound">inputs</a> <a id="3015" href="Amethyst.Network.As.Schmitty.html#3015" class="Bound">outputs</a> <a id="3023" class="Symbol">=</a> <a id="3025" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="3034" href="Amethyst.Network.As.Schmitty.html#3008" class="Bound">inputs</a> <a id="3041" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="3044" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="3053" href="Amethyst.Network.As.Schmitty.html#3015" class="Bound">outputs</a>


<a id="3063" class="Keyword">private</a>
  <a id="3073" class="Comment">-- |The reverse-append of two reversed lists is equivalent to the append of the lists.</a>
  <a id="3162" class="Comment">--</a>
  <a id="3167" class="Comment">--  NOTE: The variable contexts for a Script are in reversed order, so we pass</a>
  <a id="3248" class="Comment">--        the reversed input/output contexts to `declare-consts` to ensure</a>
  <a id="3325" class="Comment">--        that we end up with *doubly* reversed contexts in the Script.</a>
  <a id="3399" class="Comment">--        We use this lemma to show that the doubly reversed contexts are</a>
  <a id="3475" class="Comment">--        equivalent to the original input/output context.</a>
  <a id="3536" class="Comment">--</a>
  <a id="3541" class="Comment">--  NOTE: Perhaps this lemma should be submitted to Data.List.Properties?</a>
  <a id="3617" class="Comment">--</a>
  <a id="ʳ++-reverse"></a><a id="3622" href="Amethyst.Network.As.Schmitty.html#3622" class="Function">ʳ++-reverse</a> <a id="3634" class="Symbol">:</a> <a id="3636" class="Symbol">∀</a> <a id="3638" class="Symbol">{</a><a id="3639" href="Amethyst.Network.As.Schmitty.html#3639" class="Bound">a</a><a id="3640" class="Symbol">}</a> <a id="3642" class="Symbol">{</a><a id="3643" href="Amethyst.Network.As.Schmitty.html#3643" class="Bound">A</a> <a id="3645" class="Symbol">:</a> <a id="3647" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3651" href="Amethyst.Network.As.Schmitty.html#3639" class="Bound">a</a><a id="3652" class="Symbol">}</a> <a id="3654" class="Symbol">(</a><a id="3655" href="Amethyst.Network.As.Schmitty.html#3655" class="Bound">xs</a> <a id="3658" href="Amethyst.Network.As.Schmitty.html#3658" class="Bound">ys</a> <a id="3661" class="Symbol">:</a> <a id="3663" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3668" href="Amethyst.Network.As.Schmitty.html#3643" class="Bound">A</a><a id="3669" class="Symbol">)</a> <a id="3671" class="Symbol">→</a> <a id="3673" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3686" href="Amethyst.Network.As.Schmitty.html#3655" class="Bound">xs</a> <a id="3689" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="3693" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3706" href="Amethyst.Network.As.Schmitty.html#3658" class="Bound">ys</a>  <a id="3710" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="3714" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="3717" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3719" href="Amethyst.Network.As.Schmitty.html#3655" class="Bound">xs</a> <a id="3722" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="3725" href="Amethyst.Network.As.Schmitty.html#3658" class="Bound">ys</a>
  <a id="3730" href="Amethyst.Network.As.Schmitty.html#3622" class="Function">ʳ++-reverse</a> <a id="3742" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a> <a id="3745" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">ys</a> <a id="3748" class="Symbol">=</a>
    <a id="3754" href="Relation.Binary.PropositionalEquality.Core.html#2745" class="Function Operator">begin</a>
      <a id="3766" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3779" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a> <a id="3782" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="3786" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3799" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">ys</a> <a id="3802" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="3806" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="3813" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="3816" href="Data.List.Properties.html#30377" class="Function">List.ʳ++-defn</a> <a id="3830" class="Symbol">(</a><a id="3831" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3844" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a><a id="3846" class="Symbol">)</a> <a id="3848" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="3856" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3869" class="Symbol">(</a><a id="3870" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3883" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a><a id="3885" class="Symbol">)</a> <a id="3887" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="3890" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3903" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">ys</a>  <a id="3907" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="3911" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="3918" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="3921" href="Data.List.Properties.html#33859" class="Function">List.reverse-involutive</a> <a id="3945" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a> <a id="3948" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="3951" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="3959" class="Symbol">(</a><a id="3960" href="Data.List.Base.html#1763" class="Function Operator">_++</a> <a id="3964" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="3977" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">ys</a> <a id="3980" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="3984" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3986" class="Symbol">)</a> <a id="3988" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="3996" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a> <a id="3999" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4002" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4015" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">ys</a> <a id="4018" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4022" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4029" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4032" href="Data.List.Properties.html#30377" class="Function">List.ʳ++-defn</a> <a id="4046" class="Symbol">(</a><a id="4047" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4060" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">ys</a><a id="4062" class="Symbol">)</a> <a id="4064" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4067" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4075" class="Symbol">(</a><a id="4076" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a> <a id="4079" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4082" class="Symbol">)</a> <a id="4084" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4092" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a> <a id="4095" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4098" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4111" class="Symbol">(</a><a id="4112" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4125" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">ys</a><a id="4127" class="Symbol">)</a> <a id="4129" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4132" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4139" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4142" href="Data.List.Properties.html#33859" class="Function">List.reverse-involutive</a> <a id="4166" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">ys</a> <a id="4169" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4172" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4180" class="Symbol">((</a><a id="4182" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a> <a id="4185" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4188" class="Symbol">)</a> <a id="4190" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4192" class="Symbol">(</a><a id="4193" href="Data.List.Base.html#1763" class="Function Operator">_++</a> <a id="4197" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4199" class="Symbol">))</a> <a id="4202" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4210" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a> <a id="4213" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4216" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">ys</a> <a id="4219" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4222" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4229" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4232" href="Data.List.Properties.html#5554" class="Function">List.++-identityʳ</a> <a id="4250" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">ys</a> <a id="4253" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4256" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4264" class="Symbol">(</a><a id="4265" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a> <a id="4268" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4271" class="Symbol">)</a> <a id="4273" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4281" href="Amethyst.Network.As.Schmitty.html#3742" class="Bound">xs</a> <a id="4284" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4287" href="Amethyst.Network.As.Schmitty.html#3745" class="Bound">ys</a>
    <a id="4294" href="Relation.Binary.PropositionalEquality.Core.html#3044" class="Function Operator">∎</a>

<a id="4297" class="Comment">-- |Convert networks to SMT scripts.</a>
<a id="toScript"></a><a id="4334" href="Amethyst.Network.As.Schmitty.html#4334" class="Function">toScript</a> <a id="4343" class="Symbol">:</a> <a id="4345" href="Amethyst.Network.html#677" class="Datatype">Network</a> <a id="4353" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="4359" href="Amethyst.Network.As.Schmitty.html#1964" class="Generalizable">inputs</a> <a id="4366" href="Amethyst.Network.As.Schmitty.html#1996" class="Generalizable">outputs</a> <a id="4374" href="Amethyst.Network.As.Schmitty.html#2012" class="Generalizable">layers</a> <a id="4381" class="Symbol">→</a> <a id="4383" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="4390" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4393" class="Symbol">(</a><a id="4394" href="Amethyst.Network.As.Schmitty.html#2952" class="Function">NetworkCtxt</a> <a id="4406" href="Amethyst.Network.As.Schmitty.html#1964" class="Generalizable">inputs</a> <a id="4413" href="Amethyst.Network.As.Schmitty.html#1996" class="Generalizable">outputs</a><a id="4420" class="Symbol">)</a> <a id="4422" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="4425" href="Amethyst.Network.As.Schmitty.html#4334" class="Function">toScript</a> <a id="4434" class="Symbol">{</a><a id="4435" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a><a id="4441" class="Symbol">}</a> <a id="4443" class="Symbol">{</a><a id="4444" href="Amethyst.Network.As.Schmitty.html#4444" class="Bound">outputs</a><a id="4451" class="Symbol">}</a> <a id="4453" href="Amethyst.Network.As.Schmitty.html#4453" class="Bound">n</a>
  <a id="4457" class="Symbol">=</a> <a id="4459" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a> <a id="4468" class="Symbol">(λ</a> <a id="4471" href="Amethyst.Network.As.Schmitty.html#4471" class="Bound">Γ</a> <a id="4473" class="Symbol">→</a> <a id="4475" href="SMT.Script.Base.html#8021" class="Datatype">Script</a> <a id="4482" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4485" href="Amethyst.Network.As.Schmitty.html#4471" class="Bound">Γ</a> <a id="4487" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4489" class="Symbol">)</a> <a id="4491" class="Symbol">(</a><a id="4492" href="Amethyst.Network.As.Schmitty.html#3622" class="Function">ʳ++-reverse</a> <a id="4504" class="Symbol">(</a><a id="4505" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="4514" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a><a id="4520" class="Symbol">)</a> <a id="4522" class="Symbol">(</a><a id="4523" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="4532" href="Amethyst.Network.As.Schmitty.html#4444" class="Bound">outputs</a><a id="4539" class="Symbol">))</a>
  <a id="4544" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4546" href="SMT.Script.Base.html#8441" class="Function">declare-consts</a> <a id="4561" class="Symbol">(</a><a id="4562" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4575" class="Symbol">(</a><a id="4576" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="4585" href="Amethyst.Network.As.Schmitty.html#4444" class="Bound">outputs</a><a id="4592" class="Symbol">))</a>
  <a id="4597" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4599" href="SMT.Script.Base.html#8441" class="Function">declare-consts</a> <a id="4614" class="Symbol">(</a><a id="4615" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4628" class="Symbol">(</a><a id="4629" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="4638" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a><a id="4644" class="Symbol">))</a>
  <a id="4649" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4651" href="SMT.Script.Base.html#7792" class="InductiveConstructor">assert</a>
      <a id="4664" class="Symbol">(</a><a id="4665" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="4675" class="Symbol">_</a>
        <a id="4685" class="Symbol">(</a><a id="4686" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="4691" href="SMT.Theories.Core.Extensions.html#1302" class="Function">and</a><a id="4694" class="Symbol">)</a>
        <a id="4704" class="Symbol">(</a><a id="4705" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="4709" class="Symbol">(</a><a id="4710" href="SMT.Theories.Core.Extensions.html#857" class="Function">bool</a> <a id="4715" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="4719" class="Symbol">))</a>
        <a id="4730" class="Symbol">(</a><a id="4731" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a>
          <a id="4753" class="Symbol">(</a><a id="4754" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="4759" href="SMT.Theories.Reals.html#4390" class="InductiveConstructor">eq</a><a id="4761" class="Symbol">)</a>
          <a id="4773" class="Symbol">(</a><a id="4774" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a>
            <a id="4795" class="Symbol">(λ</a> <a id="4798" href="Amethyst.Network.As.Schmitty.html#4798" class="Bound">Γ</a> <a id="4800" class="Symbol">→</a> <a id="4802" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4806" class="Symbol">(</a><a id="4807" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="4812" href="Amethyst.Network.As.Schmitty.html#4798" class="Bound">Γ</a><a id="4813" class="Symbol">)</a> <a id="4815" href="Amethyst.Network.As.Schmitty.html#4444" class="Bound">outputs</a><a id="4822" class="Symbol">)</a>
            <a id="4836" class="Symbol">(</a><a id="4837" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">Eq.sym</a> <a id="4844" class="Symbol">(</a><a id="4845" href="Amethyst.Network.As.Schmitty.html#3622" class="Function">ʳ++-reverse</a> <a id="4857" class="Symbol">(</a><a id="4858" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="4867" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a><a id="4873" class="Symbol">)</a> <a id="4875" class="Symbol">(</a><a id="4876" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="4885" href="Amethyst.Network.As.Schmitty.html#4444" class="Bound">outputs</a><a id="4892" class="Symbol">)))</a>
            <a id="4908" href="Amethyst.Network.As.Schmitty.html#5288" class="Function">outputVec</a><a id="4917" class="Symbol">)</a>
          <a id="4929" class="Symbol">(</a><a id="4930" href="Amethyst.Network.As.Schmitty.html#2756" class="Function">reflectNetwork</a> <a id="4945" href="Amethyst.Network.As.Schmitty.html#4453" class="Bound">n</a>
            <a id="4959" class="Symbol">(</a><a id="4960" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a>
              <a id="4983" class="Symbol">(λ</a> <a id="4986" href="Amethyst.Network.As.Schmitty.html#4986" class="Bound">Γ</a> <a id="4988" class="Symbol">→</a> <a id="4990" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4994" class="Symbol">(</a><a id="4995" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="5000" href="Amethyst.Network.As.Schmitty.html#4986" class="Bound">Γ</a><a id="5001" class="Symbol">)</a> <a id="5003" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a><a id="5009" class="Symbol">)</a>
              <a id="5025" class="Symbol">(</a><a id="5026" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">Eq.sym</a> <a id="5033" class="Symbol">(</a><a id="5034" href="Amethyst.Network.As.Schmitty.html#3622" class="Function">ʳ++-reverse</a> <a id="5046" class="Symbol">(</a><a id="5047" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="5056" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a><a id="5062" class="Symbol">)</a> <a id="5064" class="Symbol">(</a><a id="5065" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="5074" href="Amethyst.Network.As.Schmitty.html#4444" class="Bound">outputs</a><a id="5081" class="Symbol">)))</a>
              <a id="5099" href="Amethyst.Network.As.Schmitty.html#5131" class="Function">inputVec</a><a id="5107" class="Symbol">))))</a>
  <a id="5114" href="SMT.Script.Base.html#8106" class="InductiveConstructor Operator">∷</a> <a id="5116" href="SMT.Script.Base.html#8084" class="InductiveConstructor">[]</a>
  <a id="5121" class="Keyword">where</a>
    <a id="5131" href="Amethyst.Network.As.Schmitty.html#5131" class="Function">inputVec</a> <a id="5140" class="Symbol">:</a> <a id="5142" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5146" class="Symbol">(</a><a id="5147" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="5152" class="Symbol">(</a><a id="5153" href="Amethyst.Network.As.Schmitty.html#2952" class="Function">NetworkCtxt</a> <a id="5165" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a> <a id="5172" href="Amethyst.Network.As.Schmitty.html#4444" class="Bound">outputs</a><a id="5179" class="Symbol">))</a> <a id="5182" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a>
    <a id="5193" href="Amethyst.Network.As.Schmitty.html#5131" class="Function">inputVec</a> <a id="5202" class="Symbol">=</a> <a id="5204" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="5212" class="Symbol">(</a><a id="5213" href="SMT.Script.Base.html#1517" class="InductiveConstructor">var</a> <a id="5217" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5219" href="SMT.Script.Base.html#3034" class="Function">injectVar</a> <a id="5229" class="Symbol">(</a><a id="5230" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="5239" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a><a id="5245" class="Symbol">)</a> <a id="5247" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5249" href="Amethyst.LinearAlgebra.As.Schmitty.html#929" class="Function">RealCtxt∋REAL</a><a id="5262" class="Symbol">)</a> <a id="5264" class="Symbol">(</a><a id="5265" href="Data.Vec.Base.html#5972" class="Function">Vec.allFin</a> <a id="5276" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a><a id="5282" class="Symbol">)</a>
    <a id="5288" href="Amethyst.Network.As.Schmitty.html#5288" class="Function">outputVec</a> <a id="5298" class="Symbol">:</a> <a id="5300" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5304" class="Symbol">(</a><a id="5305" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="5310" class="Symbol">(</a><a id="5311" href="Amethyst.Network.As.Schmitty.html#2952" class="Function">NetworkCtxt</a> <a id="5323" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a> <a id="5330" href="Amethyst.Network.As.Schmitty.html#4444" class="Bound">outputs</a><a id="5337" class="Symbol">))</a> <a id="5340" href="Amethyst.Network.As.Schmitty.html#4444" class="Bound">outputs</a>
    <a id="5352" href="Amethyst.Network.As.Schmitty.html#5288" class="Function">outputVec</a> <a id="5362" class="Symbol">=</a> <a id="5364" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="5372" class="Symbol">(</a><a id="5373" href="SMT.Script.Base.html#1517" class="InductiveConstructor">var</a> <a id="5377" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5379" href="SMT.Script.Base.html#3189" class="Function">raiseVar</a> <a id="5388" class="Symbol">(</a><a id="5389" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">RealCtxt</a> <a id="5398" href="Amethyst.Network.As.Schmitty.html#4435" class="Bound">inputs</a><a id="5404" class="Symbol">)</a> <a id="5406" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5408" href="Amethyst.LinearAlgebra.As.Schmitty.html#929" class="Function">RealCtxt∋REAL</a><a id="5421" class="Symbol">)</a> <a id="5423" class="Symbol">(</a><a id="5424" href="Data.Vec.Base.html#5972" class="Function">Vec.allFin</a> <a id="5435" href="Amethyst.Network.As.Schmitty.html#4444" class="Bound">outputs</a><a id="5442" class="Symbol">)</a>
</pre></body></html>