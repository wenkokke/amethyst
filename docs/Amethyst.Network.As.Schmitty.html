<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.Network.As.Schmitty</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst: Neural Network Verification in Agda</a>
<a id="131" class="Comment">--</a>
<a id="134" class="Comment">-- This module contains functions to reflect networks as Schmitty terms. It also</a>
<a id="215" class="Comment">-- provides the `withReflectedNetwork` function, which reflects a network as a</a>
<a id="294" class="Comment">-- Schmitty term, and wraps that term in a script which declares the appropriate</a>
<a id="375" class="Comment">-- constants for the inputs and outputs, and allows the caller to append further</a>
<a id="456" class="Comment">-- portions of script.</a>
<a id="479" class="Comment">--</a>
<a id="482" class="Comment">-- Exports:</a>
<a id="494" class="Comment">--</a>
<a id="497" class="Comment">--   - reflectActivation</a>
<a id="522" class="Comment">--   - reflectLayer</a>
<a id="542" class="Comment">--   - reflectNetwork</a>
<a id="564" class="Comment">--   - withReflectedNetworkAsScript</a>
<a id="600" class="Comment">--</a>
<a id="603" class="Comment">--------------------------------------------------------------------------------</a>
<a id="684" class="Keyword">module</a> <a id="691" href="Amethyst.Network.As.Schmitty.html" class="Module">Amethyst.Network.As.Schmitty</a> <a id="720" class="Keyword">where</a>

<a id="727" class="Keyword">open</a> <a id="732" class="Keyword">import</a> <a id="739" href="SMT.Theories.Reals.Base.html" class="Module">SMT.Theories.Reals.Base</a> <a id="763" class="Keyword">using</a> <a id="769" class="Symbol">(</a><a id="770" href="SMT.Theories.Core.Extensions.html#1020" class="Function">true</a><a id="774" class="Symbol">)</a>

<a id="777" class="Keyword">open</a> <a id="782" class="Keyword">import</a> <a id="789" href="Amethyst.Network.Base.html" class="Module">Amethyst.Network.Base</a>
  <a id="813" class="Keyword">using</a> <a id="819" class="Symbol">(</a><a id="820" href="Amethyst.Network.Base.html#1287" class="Datatype">Network</a><a id="827" class="Symbol">;</a> <a id="829" href="Amethyst.Network.Base.html#1353" class="InductiveConstructor">[]</a><a id="831" class="Symbol">;</a> <a id="833" href="Amethyst.Network.Base.html#1388" class="InductiveConstructor Operator">_∷_</a><a id="836" class="Symbol">;</a> <a id="838" href="Amethyst.Network.Base.html#969" class="Record">Layer</a><a id="843" class="Symbol">;</a> <a id="845" href="Amethyst.Network.Base.html#1130" class="Function">LayerSpec</a><a id="854" class="Symbol">;</a> <a id="856" href="Amethyst.Network.Base.html#823" class="Datatype">Activation</a><a id="866" class="Symbol">;</a> <a id="868" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣_₀∣</a><a id="872" class="Symbol">;</a> <a id="874" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣_ₙ∣</a><a id="878" class="Symbol">)</a>
<a id="880" class="Keyword">open</a> <a id="885" class="Keyword">import</a> <a id="892" href="Amethyst.Network.Approximation.html" class="Module">Amethyst.Network.Approximation</a>
<a id="923" class="Keyword">open</a> <a id="928" class="Keyword">import</a> <a id="935" href="Amethyst.PiecewiseLinear.Base.html" class="Module">Amethyst.PiecewiseLinear.Base</a>
<a id="965" class="Keyword">open</a> <a id="970" class="Keyword">import</a> <a id="977" href="Amethyst.PiecewiseLinear.As.Schmitty.html" class="Module">Amethyst.PiecewiseLinear.As.Schmitty</a>
<a id="1014" class="Keyword">open</a> <a id="1019" class="Keyword">import</a> <a id="1026" href="Amethyst.LinearAlgebra.As.Schmitty.html" class="Module">Amethyst.LinearAlgebra.As.Schmitty</a>
<a id="1061" class="Keyword">import</a> <a id="1068" href="Amethyst.Data.Vec.html" class="Module">Amethyst.Data.Vec</a> <a id="1086" class="Symbol">as</a> <a id="1089" class="Module">Vec</a>

<a id="1094" class="Keyword">open</a> <a id="1099" class="Keyword">import</a> <a id="1106" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="1115" class="Symbol">as</a> <a id="1118" class="Module">Fin</a> <a id="1122" class="Keyword">using</a> <a id="1128" class="Symbol">(</a><a id="1129" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="1132" class="Symbol">;</a> <a id="1134" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a><a id="1138" class="Symbol">;</a> <a id="1140" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a><a id="1143" class="Symbol">)</a>
<a id="1145" class="Keyword">open</a> <a id="1150" class="Keyword">import</a> <a id="1157" href="Data.Float.html" class="Module">Data.Float</a> <a id="1168" class="Symbol">as</a> <a id="1171" class="Module">Float</a> <a id="1177" class="Keyword">using</a> <a id="1183" class="Symbol">(</a><a id="1184" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="1189" class="Symbol">)</a>
<a id="1191" class="Keyword">open</a> <a id="1196" class="Keyword">import</a> <a id="1203" href="Data.List.html" class="Module">Data.List</a> <a id="1213" class="Symbol">as</a> <a id="1216" class="Module">List</a> <a id="1221" class="Keyword">using</a> <a id="1227" class="Symbol">(</a><a id="1228" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="1232" class="Symbol">;</a> <a id="1234" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="1236" class="Symbol">;</a> <a id="1238" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="1241" class="Symbol">;</a> <a id="1243" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="1247" class="Symbol">;</a> <a id="1249" href="Data.List.Base.html#9558" class="Function Operator">_ʳ++_</a><a id="1254" class="Symbol">)</a>
<a id="1256" class="Keyword">open</a> <a id="1261" class="Keyword">import</a> <a id="1268" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="1297" class="Keyword">using</a> <a id="1303" class="Symbol">(</a><a id="1304" href="Data.List.Relation.Unary.All.html#1460" class="InductiveConstructor">[]</a><a id="1306" class="Symbol">)</a>
<a id="1308" class="Keyword">import</a> <a id="1315" href="Data.List.Properties.html" class="Module">Data.List.Properties</a> <a id="1336" class="Symbol">as</a> <a id="1339" class="Module">List</a>
<a id="1344" class="Keyword">open</a> <a id="1349" class="Keyword">import</a> <a id="1356" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="1365" class="Symbol">as</a> <a id="1368" class="Module">Nat</a> <a id="1372" class="Keyword">using</a> <a id="1378" class="Symbol">(</a><a id="1379" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1380" class="Symbol">;</a> <a id="1382" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1386" class="Symbol">;</a> <a id="1388" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="1391" class="Symbol">)</a>
<a id="1393" class="Keyword">open</a> <a id="1398" class="Keyword">import</a> <a id="1405" href="Data.Product.html" class="Module">Data.Product</a> <a id="1418" class="Symbol">as</a> <a id="1421" class="Module">Prod</a> <a id="1426" class="Keyword">using</a> <a id="1432" class="Symbol">(</a><a id="1433" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="1436" class="Symbol">;</a> <a id="1438" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="1441" class="Symbol">;</a> <a id="1443" href="Data.Product.html#3386" class="Function">uncurry</a><a id="1450" class="Symbol">)</a>
<a id="1452" class="Keyword">open</a> <a id="1457" class="Keyword">import</a> <a id="1464" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1473" class="Symbol">as</a> <a id="1476" class="Module">Vec</a> <a id="1480" class="Keyword">using</a> <a id="1486" class="Symbol">(</a><a id="1487" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="1490" class="Symbol">;</a> <a id="1492" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1494" class="Symbol">;</a> <a id="1496" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="1499" class="Symbol">)</a>
<a id="1501" class="Keyword">open</a> <a id="1506" class="Keyword">import</a> <a id="1513" href="Function.html" class="Module">Function</a> <a id="1522" class="Keyword">using</a> <a id="1528" class="Symbol">(</a><a id="1529" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="1532" class="Symbol">;</a> <a id="1534" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="1537" class="Symbol">;</a> <a id="1539" href="Function.Base.html#2210" class="Function Operator">_|&gt;_</a><a id="1543" class="Symbol">;</a> <a id="1545" href="Function.Base.html#615" class="Function">id</a><a id="1547" class="Symbol">)</a>
<a id="1549" class="Keyword">open</a> <a id="1554" class="Keyword">import</a> <a id="1561" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1599" class="Symbol">as</a> <a id="1602" class="Module">Eq</a> <a id="1605" class="Keyword">using</a> <a id="1611" class="Symbol">(</a><a id="1612" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="1615" class="Symbol">;</a> <a id="1617" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1621" class="Symbol">)</a>
<a id="1623" class="Keyword">open</a> <a id="1628" href="Relation.Binary.PropositionalEquality.Core.html#2647" class="Module">Eq.≡-Reasoning</a>

<a id="1644" class="Comment">-- * Activation functions</a>

<a id="1671" class="Keyword">private</a>
  <a id="1681" class="Keyword">variable</a>
    <a id="1694" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a> <a id="1696" class="Symbol">:</a> <a id="1698" href="SMT.Script.Base.html#1088" class="Function">Ctxt</a>
    <a id="1707" href="Amethyst.Network.As.Schmitty.html#1707" class="Generalizable">n</a> <a id="1709" class="Symbol">:</a> <a id="1711" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1714" class="Keyword">private</a>
  <a id="relu"></a><a id="1724" href="Amethyst.Network.As.Schmitty.html#1724" class="Function">relu</a> <a id="1729" class="Symbol">:</a> <a id="1731" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1736" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a> <a id="1738" class="Symbol">→</a> <a id="1740" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1745" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a>
  <a id="1749" href="Amethyst.Network.As.Schmitty.html#1724" class="Function">relu</a> <a id="1754" href="Amethyst.Network.As.Schmitty.html#1754" class="Bound">x</a> <a id="1756" class="Symbol">=</a> <a id="1758" href="SMT.Script.Base.html#2183" class="InductiveConstructor">app₃</a> <a id="1763" href="SMT.Theories.Reals.Base.html#4294" class="InductiveConstructor">ite</a> <a id="1767" class="Symbol">(</a><a id="1768" href="SMT.Script.Base.html#2141" class="InductiveConstructor">app₂</a> <a id="1773" href="SMT.Theories.Reals.Base.html#4495" class="InductiveConstructor">leq</a> <a id="1777" href="Amethyst.Network.As.Schmitty.html#1754" class="Bound">x</a> <a id="1779" class="Symbol">(</a><a id="1780" href="SMT.Script.Base.html#1621" class="InductiveConstructor">lit</a> <a id="1784" class="Symbol">(</a><a id="1785" href="SMT.Theories.Reals.Base.html#3651" class="InductiveConstructor">nat</a> <a id="1789" class="Number">0</a><a id="1790" class="Symbol">)))</a> <a id="1794" class="Symbol">(</a><a id="1795" href="SMT.Script.Base.html#1621" class="InductiveConstructor">lit</a> <a id="1799" class="Symbol">(</a><a id="1800" href="SMT.Theories.Reals.Base.html#3651" class="InductiveConstructor">nat</a> <a id="1804" class="Number">0</a><a id="1805" class="Symbol">))</a> <a id="1808" href="Amethyst.Network.As.Schmitty.html#1754" class="Bound">x</a>

  <a id="lexp"></a><a id="1813" href="Amethyst.Network.As.Schmitty.html#1813" class="Function">lexp</a> <a id="1818" class="Symbol">:</a> <a id="1820" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1825" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a> <a id="1827" class="Symbol">→</a> <a id="1829" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1834" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a>
  <a id="1838" href="Amethyst.Network.As.Schmitty.html#1813" class="Function">lexp</a> <a id="1843" class="Symbol">=</a> <a id="1845" href="Amethyst.PiecewiseLinear.As.Schmitty.html#2512" class="Function">reflect</a> <a id="1853" href="Amethyst.Network.Approximation.html#765" class="Function">expApprox</a>

  <a id="lsigmoid"></a><a id="1866" href="Amethyst.Network.As.Schmitty.html#1866" class="Function">lsigmoid</a> <a id="1875" class="Symbol">:</a> <a id="1877" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1882" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a> <a id="1884" class="Symbol">→</a> <a id="1886" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1891" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a>
  <a id="1895" href="Amethyst.Network.As.Schmitty.html#1866" class="Function">lsigmoid</a> <a id="1904" class="Symbol">=</a> <a id="1906" href="Amethyst.PiecewiseLinear.As.Schmitty.html#2512" class="Function">reflect</a> <a id="1914" href="Amethyst.Network.Approximation.html#1239" class="Function">sigmoidApprox</a>

  <a id="lsoftmax"></a><a id="1931" href="Amethyst.Network.As.Schmitty.html#1931" class="Function">lsoftmax</a> <a id="1940" class="Symbol">:</a> <a id="1942" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1946" class="Symbol">(</a><a id="1947" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1952" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a><a id="1953" class="Symbol">)</a> <a id="1955" href="Amethyst.Network.As.Schmitty.html#1707" class="Generalizable">n</a> <a id="1957" class="Symbol">→</a> <a id="1959" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1963" class="Symbol">(</a><a id="1964" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1969" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a><a id="1970" class="Symbol">)</a> <a id="1972" href="Amethyst.Network.As.Schmitty.html#1707" class="Generalizable">n</a>
  <a id="1976" href="Amethyst.Network.As.Schmitty.html#1931" class="Function">lsoftmax</a> <a id="1985" href="Amethyst.Network.As.Schmitty.html#1985" class="Bound">xs</a> <a id="1988" class="Symbol">=</a> <a id="1990" href="Amethyst.LinearAlgebra.As.Schmitty.html#2073" class="Function">normalise</a> <a id="2000" class="Symbol">(</a><a id="2001" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2009" href="Amethyst.Network.As.Schmitty.html#1813" class="Function">lexp</a> <a id="2014" href="Amethyst.Network.As.Schmitty.html#1985" class="Bound">xs</a><a id="2016" class="Symbol">)</a>

  <a id="ltanh"></a><a id="2021" href="Amethyst.Network.As.Schmitty.html#2021" class="Function">ltanh</a> <a id="2027" class="Symbol">:</a> <a id="2029" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2034" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a> <a id="2036" class="Symbol">→</a> <a id="2038" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2043" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a>
  <a id="2047" href="Amethyst.Network.As.Schmitty.html#2021" class="Function">ltanh</a> <a id="2053" class="Symbol">=</a> <a id="2055" href="Amethyst.PiecewiseLinear.As.Schmitty.html#2512" class="Function">reflect</a> <a id="2063" href="Amethyst.Network.Approximation.html#1560" class="Function">tanhApprox</a>

<a id="2075" class="Comment">-- |Convert activation functions to SMT terms.</a>
<a id="2122" class="Comment">--</a>
<a id="2125" class="Comment">--  Takes an activation function description and an environment of SMT terms</a>
<a id="2202" class="Comment">--  describing the activation function inputs, and returns an environment of SMT</a>
<a id="2283" class="Comment">--  terms with the activation function applied.</a>
<a id="reflectActivation"></a><a id="2331" href="Amethyst.Network.As.Schmitty.html#2331" class="Function">reflectActivation</a> <a id="2349" class="Symbol">:</a> <a id="2351" href="Amethyst.Network.Base.html#823" class="Datatype">Activation</a> <a id="2362" class="Symbol">→</a> <a id="2364" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2368" class="Symbol">(</a><a id="2369" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2374" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a><a id="2375" class="Symbol">)</a> <a id="2377" href="Amethyst.Network.As.Schmitty.html#1707" class="Generalizable">n</a> <a id="2379" class="Symbol">→</a> <a id="2381" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2385" class="Symbol">(</a><a id="2386" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2391" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a><a id="2392" class="Symbol">)</a> <a id="2394" href="Amethyst.Network.As.Schmitty.html#1707" class="Generalizable">n</a>
<a id="2396" href="Amethyst.Network.As.Schmitty.html#2331" class="Function">reflectActivation</a> <a id="2414" href="Amethyst.Network.Base.html#848" class="InductiveConstructor">Activation.linear</a>  <a id="2433" class="Symbol">=</a> <a id="2435" href="Function.Base.html#615" class="Function">id</a>
<a id="2438" href="Amethyst.Network.As.Schmitty.html#2331" class="Function">reflectActivation</a> <a id="2456" href="Amethyst.Network.Base.html#871" class="InductiveConstructor">Activation.relu</a>    <a id="2475" class="Symbol">=</a> <a id="2477" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2485" href="Amethyst.Network.As.Schmitty.html#1724" class="Function">relu</a>
<a id="2490" href="Amethyst.Network.As.Schmitty.html#2331" class="Function">reflectActivation</a> <a id="2508" href="Amethyst.Network.Base.html#894" class="InductiveConstructor">Activation.sigmoid</a> <a id="2527" class="Symbol">=</a> <a id="2529" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2537" href="Amethyst.Network.As.Schmitty.html#1866" class="Function">lsigmoid</a>
<a id="2546" href="Amethyst.Network.As.Schmitty.html#2331" class="Function">reflectActivation</a> <a id="2564" href="Amethyst.Network.Base.html#917" class="InductiveConstructor">Activation.softmax</a> <a id="2583" class="Symbol">=</a> <a id="2585" href="Amethyst.Network.As.Schmitty.html#1931" class="Function">lsoftmax</a>
<a id="2594" href="Amethyst.Network.As.Schmitty.html#2331" class="Function">reflectActivation</a> <a id="2612" href="Amethyst.Network.Base.html#940" class="InductiveConstructor">Activation.tanh</a>    <a id="2631" class="Symbol">=</a> <a id="2633" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2641" href="Amethyst.Network.As.Schmitty.html#2021" class="Function">ltanh</a>


<a id="2649" class="Comment">-- * Neural networks</a>

<a id="2671" class="Keyword">private</a>
  <a id="2681" class="Keyword">variable</a>
    <a id="2694" href="Amethyst.Network.As.Schmitty.html#2694" class="Generalizable">inputs</a>  <a id="2702" class="Symbol">:</a> <a id="2704" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2710" href="Amethyst.Network.As.Schmitty.html#2710" class="Generalizable">hidden</a>  <a id="2718" class="Symbol">:</a> <a id="2720" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2726" href="Amethyst.Network.As.Schmitty.html#2726" class="Generalizable">outputs</a> <a id="2734" class="Symbol">:</a> <a id="2736" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2742" href="Amethyst.Network.As.Schmitty.html#2742" class="Generalizable">layers</a>  <a id="2750" class="Symbol">:</a> <a id="2752" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="2755" class="Comment">-- |Convert layers to SMT terms.</a>
<a id="2788" class="Comment">--</a>
<a id="2791" class="Comment">--  Takes a layer description and an environment of SMT terms describing the</a>
<a id="2868" class="Comment">--  layer inputs, and returns an environment of SMT terms describing the layer</a>
<a id="2947" class="Comment">--  outputs.</a>
<a id="reflectLayer"></a><a id="2960" href="Amethyst.Network.As.Schmitty.html#2960" class="Function">reflectLayer</a> <a id="2973" class="Symbol">:</a> <a id="2975" href="Amethyst.Network.Base.html#969" class="Record">Layer</a> <a id="2981" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="2987" href="Amethyst.Network.As.Schmitty.html#2694" class="Generalizable">inputs</a> <a id="2994" href="Amethyst.Network.As.Schmitty.html#2726" class="Generalizable">outputs</a> <a id="3002" class="Symbol">→</a> <a id="3004" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3008" class="Symbol">(</a><a id="3009" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="3014" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a><a id="3015" class="Symbol">)</a> <a id="3017" href="Amethyst.Network.As.Schmitty.html#2694" class="Generalizable">inputs</a> <a id="3024" class="Symbol">→</a> <a id="3026" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3030" class="Symbol">(</a><a id="3031" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="3036" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a><a id="3037" class="Symbol">)</a> <a id="3039" href="Amethyst.Network.As.Schmitty.html#2726" class="Generalizable">outputs</a>
<a id="3047" href="Amethyst.Network.As.Schmitty.html#2960" class="Function">reflectLayer</a> <a id="3060" href="Amethyst.Network.As.Schmitty.html#3060" class="Bound">l</a> <a id="3062" href="Amethyst.Network.As.Schmitty.html#3062" class="Bound">xs</a> <a id="3065" class="Symbol">=</a> <a id="3067" href="Amethyst.Network.As.Schmitty.html#2331" class="Function">reflectActivation</a> <a id="3085" href="Amethyst.Network.Base.html#1030" class="Function">activation</a> <a id="3096" class="Symbol">(</a><a id="3097" href="Amethyst.Network.As.Schmitty.html#3191" class="Function">biases′</a> <a id="3105" href="Amethyst.LinearAlgebra.As.Schmitty.html#1665" class="Function Operator">⊕</a> <a id="3107" class="Symbol">(</a><a id="3108" href="Amethyst.Network.As.Schmitty.html#3062" class="Bound">xs</a> <a id="3111" href="Amethyst.LinearAlgebra.As.Schmitty.html#2265" class="Function Operator">v⊡m</a> <a id="3115" href="Amethyst.Network.As.Schmitty.html#3228" class="Function">weights′</a><a id="3123" class="Symbol">))</a>
  <a id="3128" class="Keyword">where</a>
    <a id="3138" class="Keyword">open</a> <a id="3143" href="Amethyst.Network.Base.html#969" class="Module">Layer</a> <a id="3149" href="Amethyst.Network.As.Schmitty.html#3060" class="Bound">l</a> <a id="3151" class="Keyword">using</a> <a id="3157" class="Symbol">(</a><a id="3158" href="Amethyst.Network.Base.html#1030" class="Field">activation</a><a id="3168" class="Symbol">;</a> <a id="3170" href="Amethyst.Network.Base.html#1058" class="Field">weights</a><a id="3177" class="Symbol">;</a> <a id="3179" href="Amethyst.Network.Base.html#1102" class="Field">biases</a><a id="3185" class="Symbol">)</a>
    <a id="3191" href="Amethyst.Network.As.Schmitty.html#3191" class="Function">biases′</a>  <a id="3200" class="Symbol">=</a> <a id="3202" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="3210" href="Amethyst.LinearAlgebra.As.Schmitty.html#1209" class="Function">toReal</a> <a id="3217" href="Amethyst.Network.Base.html#1102" class="Function">biases</a>
    <a id="3228" href="Amethyst.Network.As.Schmitty.html#3228" class="Function">weights′</a> <a id="3237" class="Symbol">=</a> <a id="3239" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="3247" class="Symbol">(</a><a id="3248" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="3256" href="Amethyst.LinearAlgebra.As.Schmitty.html#1209" class="Function">toReal</a><a id="3262" class="Symbol">)</a> <a id="3264" href="Amethyst.Network.Base.html#1058" class="Function">weights</a>

<a id="3273" class="Comment">-- |Convert networks to SMT terms.</a>
<a id="3308" class="Comment">--</a>
<a id="3311" class="Comment">--  Takes a network description and an environment of SMT terms describing the</a>
<a id="3390" class="Comment">--  network inputs, and returns an environment of SMT terms describing the network</a>
<a id="3473" class="Comment">--  outputs.</a>
<a id="reflectNetwork"></a><a id="3486" href="Amethyst.Network.As.Schmitty.html#3486" class="Function">reflectNetwork</a> <a id="3501" class="Symbol">:</a> <a id="3503" class="Symbol">∀</a> <a id="3505" class="Symbol">{</a><a id="3506" href="Amethyst.Network.As.Schmitty.html#3506" class="Bound">n</a><a id="3507" class="Symbol">}</a> <a id="3509" class="Symbol">{</a><a id="3510" href="Amethyst.Network.As.Schmitty.html#3510" class="Bound">xs</a> <a id="3513" class="Symbol">:</a> <a id="3515" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3519" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3521" href="Amethyst.Network.As.Schmitty.html#3506" class="Bound">n</a><a id="3522" class="Symbol">}</a> <a id="3524" class="Symbol">→</a> <a id="3526" href="Amethyst.Network.Base.html#1287" class="Datatype">Network</a> <a id="3534" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="3540" href="Amethyst.Network.As.Schmitty.html#3510" class="Bound">xs</a> <a id="3543" class="Symbol">→</a> <a id="3545" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3549" class="Symbol">(</a><a id="3550" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="3555" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a><a id="3556" class="Symbol">)</a> <a id="3558" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="3560" href="Amethyst.Network.As.Schmitty.html#3510" class="Bound">xs</a> <a id="3563" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a> <a id="3566" class="Symbol">→</a> <a id="3568" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3572" class="Symbol">(</a><a id="3573" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="3578" href="Amethyst.Network.As.Schmitty.html#1694" class="Generalizable">Γ</a><a id="3579" class="Symbol">)</a> <a id="3581" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="3583" href="Amethyst.Network.As.Schmitty.html#3510" class="Bound">xs</a> <a id="3586" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a>
<a id="3589" href="Amethyst.Network.As.Schmitty.html#3486" class="Function">reflectNetwork</a> <a id="3604" href="Amethyst.Network.Base.html#1353" class="InductiveConstructor">[]</a>      <a id="3612" class="Symbol">=</a> <a id="3614" href="Function.Base.html#615" class="Function">id</a>
<a id="3617" href="Amethyst.Network.As.Schmitty.html#3486" class="Function">reflectNetwork</a> <a id="3632" class="Symbol">(</a><a id="3633" href="Amethyst.Network.As.Schmitty.html#3633" class="Bound">l</a> <a id="3635" href="Amethyst.Network.Base.html#1388" class="InductiveConstructor Operator">∷</a> <a id="3637" href="Amethyst.Network.As.Schmitty.html#3637" class="Bound">n</a><a id="3638" class="Symbol">)</a> <a id="3640" class="Symbol">=</a> <a id="3642" href="Amethyst.Network.As.Schmitty.html#3486" class="Function">reflectNetwork</a> <a id="3657" href="Amethyst.Network.As.Schmitty.html#3637" class="Bound">n</a> <a id="3659" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3661" href="Amethyst.Network.As.Schmitty.html#2960" class="Function">reflectLayer</a> <a id="3674" href="Amethyst.Network.As.Schmitty.html#3633" class="Bound">l</a>

<a id="3677" class="Keyword">private</a>
  <a id="3687" class="Comment">-- |The reverse-append of two reversed lists is equivalent to the append of the lists.</a>
  <a id="3776" class="Comment">--</a>
  <a id="3781" class="Comment">--  NOTE: The variable contexts for a Script are in reversed order, so we pass</a>
  <a id="3862" class="Comment">--        the reversed input/output contexts to `declare-consts` to ensure</a>
  <a id="3939" class="Comment">--        that we end up with *doubly* reversed contexts in the Script.</a>
  <a id="4013" class="Comment">--        We use this lemma to show that the doubly reversed contexts are</a>
  <a id="4089" class="Comment">--        equivalent to the original input/output context.</a>
  <a id="4150" class="Comment">--</a>
  <a id="4155" class="Comment">--  NOTE: Perhaps this lemma should be submitted to Data.List.Properties?</a>
  <a id="4231" class="Comment">--</a>
  <a id="ʳ++-reverse"></a><a id="4236" href="Amethyst.Network.As.Schmitty.html#4236" class="Function">ʳ++-reverse</a> <a id="4248" class="Symbol">:</a> <a id="4250" class="Symbol">∀</a> <a id="4252" class="Symbol">{</a><a id="4253" href="Amethyst.Network.As.Schmitty.html#4253" class="Bound">a</a><a id="4254" class="Symbol">}</a> <a id="4256" class="Symbol">{</a><a id="4257" href="Amethyst.Network.As.Schmitty.html#4257" class="Bound">A</a> <a id="4259" class="Symbol">:</a> <a id="4261" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4265" href="Amethyst.Network.As.Schmitty.html#4253" class="Bound">a</a><a id="4266" class="Symbol">}</a> <a id="4268" class="Symbol">(</a><a id="4269" href="Amethyst.Network.As.Schmitty.html#4269" class="Bound">xs</a> <a id="4272" href="Amethyst.Network.As.Schmitty.html#4272" class="Bound">ys</a> <a id="4275" class="Symbol">:</a> <a id="4277" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4282" href="Amethyst.Network.As.Schmitty.html#4257" class="Bound">A</a><a id="4283" class="Symbol">)</a> <a id="4285" class="Symbol">→</a> <a id="4287" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4300" href="Amethyst.Network.As.Schmitty.html#4269" class="Bound">xs</a> <a id="4303" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4307" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4320" href="Amethyst.Network.As.Schmitty.html#4272" class="Bound">ys</a>  <a id="4324" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4328" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4331" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4333" href="Amethyst.Network.As.Schmitty.html#4269" class="Bound">xs</a> <a id="4336" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4339" href="Amethyst.Network.As.Schmitty.html#4272" class="Bound">ys</a>
  <a id="4344" href="Amethyst.Network.As.Schmitty.html#4236" class="Function">ʳ++-reverse</a> <a id="4356" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a> <a id="4359" href="Amethyst.Network.As.Schmitty.html#4359" class="Bound">ys</a> <a id="4362" class="Symbol">=</a>
    <a id="4368" href="Relation.Binary.PropositionalEquality.Core.html#2745" class="Function Operator">begin</a>
      <a id="4380" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4393" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a> <a id="4396" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4400" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4413" href="Amethyst.Network.As.Schmitty.html#4359" class="Bound">ys</a> <a id="4416" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4420" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4427" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4430" href="Data.List.Properties.html#30377" class="Function">List.ʳ++-defn</a> <a id="4444" class="Symbol">(</a><a id="4445" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4458" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a><a id="4460" class="Symbol">)</a> <a id="4462" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4470" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4483" class="Symbol">(</a><a id="4484" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4497" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a><a id="4499" class="Symbol">)</a> <a id="4501" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4504" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4517" href="Amethyst.Network.As.Schmitty.html#4359" class="Bound">ys</a>  <a id="4521" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4525" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4532" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4535" href="Data.List.Properties.html#33859" class="Function">List.reverse-involutive</a> <a id="4559" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a> <a id="4562" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4565" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4573" class="Symbol">(</a><a id="4574" href="Data.List.Base.html#1763" class="Function Operator">_++</a> <a id="4578" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4591" href="Amethyst.Network.As.Schmitty.html#4359" class="Bound">ys</a> <a id="4594" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4598" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4600" class="Symbol">)</a> <a id="4602" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4610" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a> <a id="4613" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4616" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4629" href="Amethyst.Network.As.Schmitty.html#4359" class="Bound">ys</a> <a id="4632" href="Data.List.Base.html#9558" class="Function Operator">ʳ++</a> <a id="4636" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4643" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4646" href="Data.List.Properties.html#30377" class="Function">List.ʳ++-defn</a> <a id="4660" class="Symbol">(</a><a id="4661" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4674" href="Amethyst.Network.As.Schmitty.html#4359" class="Bound">ys</a><a id="4676" class="Symbol">)</a> <a id="4678" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4681" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4689" class="Symbol">(</a><a id="4690" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a> <a id="4693" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4696" class="Symbol">)</a> <a id="4698" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4706" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a> <a id="4709" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4712" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4725" class="Symbol">(</a><a id="4726" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="4739" href="Amethyst.Network.As.Schmitty.html#4359" class="Bound">ys</a><a id="4741" class="Symbol">)</a> <a id="4743" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4746" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4753" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4756" href="Data.List.Properties.html#33859" class="Function">List.reverse-involutive</a> <a id="4780" href="Amethyst.Network.As.Schmitty.html#4359" class="Bound">ys</a> <a id="4783" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4786" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4794" class="Symbol">((</a><a id="4796" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a> <a id="4799" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4802" class="Symbol">)</a> <a id="4804" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4806" class="Symbol">(</a><a id="4807" href="Data.List.Base.html#1763" class="Function Operator">_++</a> <a id="4811" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4813" class="Symbol">))</a> <a id="4816" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4824" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a> <a id="4827" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4830" href="Amethyst.Network.As.Schmitty.html#4359" class="Bound">ys</a> <a id="4833" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4836" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="4843" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">≡⟨</a> <a id="4846" href="Data.List.Properties.html#5554" class="Function">List.++-identityʳ</a> <a id="4864" href="Amethyst.Network.As.Schmitty.html#4359" class="Bound">ys</a> <a id="4867" href="Function.Base.html#2210" class="Function Operator">|&gt;</a> <a id="4870" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">Eq.cong</a> <a id="4878" class="Symbol">(</a><a id="4879" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a> <a id="4882" href="Data.List.Base.html#1763" class="Function Operator">++_</a><a id="4885" class="Symbol">)</a> <a id="4887" href="Relation.Binary.PropositionalEquality.Core.html#2862" class="Function">⟩</a>
      <a id="4895" href="Amethyst.Network.As.Schmitty.html#4356" class="Bound">xs</a> <a id="4898" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="4901" href="Amethyst.Network.As.Schmitty.html#4359" class="Bound">ys</a>
    <a id="4908" href="Relation.Binary.PropositionalEquality.Core.html#3044" class="Function Operator">∎</a>

<a id="4911" class="Comment">-- |Convert a networks to an SMT script, and allow the caller to append further commands.</a>
<a id="withReflectedNetworkAsScript"></a><a id="5001" href="Amethyst.Network.As.Schmitty.html#5001" class="Function">withReflectedNetworkAsScript</a>
  <a id="5032" class="Symbol">:</a> <a id="5034" class="Symbol">∀</a> <a id="5036" class="Symbol">{</a><a id="5037" href="Amethyst.Network.As.Schmitty.html#5037" class="Bound">Γ</a> <a id="5039" href="Amethyst.Network.As.Schmitty.html#5039" class="Bound">Ξ</a><a id="5040" class="Symbol">}</a> <a id="5042" class="Symbol">{</a><a id="5043" href="Amethyst.Network.As.Schmitty.html#5043" class="Bound">ls</a> <a id="5046" class="Symbol">:</a> <a id="5048" href="Amethyst.Network.Base.html#1130" class="Function">LayerSpec</a> <a id="5058" href="Amethyst.Network.As.Schmitty.html#2742" class="Generalizable">layers</a><a id="5064" class="Symbol">}</a>
  <a id="5068" class="Symbol">→</a> <a id="5070" href="Amethyst.Network.Base.html#1287" class="Datatype">Network</a> <a id="5078" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="5084" href="Amethyst.Network.As.Schmitty.html#5043" class="Bound">ls</a>
  <a id="5089" class="Symbol">→</a> <a id="5091" class="Symbol">(</a> <a id="5093" class="Symbol">(</a><a id="5094" href="Amethyst.Network.As.Schmitty.html#5094" class="Bound">iv</a> <a id="5097" class="Symbol">:</a> <a id="5099" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5103" class="Symbol">(</a><a id="5104" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="5109" class="Symbol">(</a><a id="5110" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5116" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="5118" href="Amethyst.Network.As.Schmitty.html#5043" class="Bound">ls</a> <a id="5121" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a> <a id="5124" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="5127" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5133" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="5135" href="Amethyst.Network.As.Schmitty.html#5043" class="Bound">ls</a> <a id="5138" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a><a id="5140" class="Symbol">))</a> <a id="5143" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="5145" href="Amethyst.Network.As.Schmitty.html#5043" class="Bound">ls</a> <a id="5148" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a><a id="5150" class="Symbol">)</a>
    <a id="5156" class="Symbol">→</a> <a id="5158" class="Symbol">(</a><a id="5159" href="Amethyst.Network.As.Schmitty.html#5159" class="Bound">ov</a> <a id="5162" class="Symbol">:</a> <a id="5164" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5168" class="Symbol">(</a><a id="5169" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="5174" class="Symbol">(</a><a id="5175" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5181" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="5183" href="Amethyst.Network.As.Schmitty.html#5043" class="Bound">ls</a> <a id="5186" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a> <a id="5189" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="5192" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5198" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="5200" href="Amethyst.Network.As.Schmitty.html#5043" class="Bound">ls</a> <a id="5203" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a><a id="5205" class="Symbol">))</a> <a id="5208" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="5210" href="Amethyst.Network.As.Schmitty.html#5043" class="Bound">ls</a> <a id="5213" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a><a id="5215" class="Symbol">)</a>
    <a id="5221" class="Symbol">→</a> <a id="5223" class="Symbol">(</a><a id="5224" href="SMT.Script.Base.html#9293" class="Datatype">Script</a> <a id="5231" class="Symbol">(</a><a id="5232" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5238" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="5240" href="Amethyst.Network.As.Schmitty.html#5043" class="Bound">ls</a> <a id="5243" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a> <a id="5246" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="5249" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5255" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="5257" href="Amethyst.Network.As.Schmitty.html#5043" class="Bound">ls</a> <a id="5260" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a><a id="5262" class="Symbol">)</a> <a id="5264" href="Amethyst.Network.As.Schmitty.html#5037" class="Bound">Γ</a> <a id="5266" href="Amethyst.Network.As.Schmitty.html#5039" class="Bound">Ξ</a><a id="5267" class="Symbol">))</a>
  <a id="5272" class="Symbol">→</a> <a id="5274" href="SMT.Script.Base.html#9293" class="Datatype">Script</a> <a id="5281" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="5284" href="Amethyst.Network.As.Schmitty.html#5037" class="Bound">Γ</a> <a id="5286" href="Amethyst.Network.As.Schmitty.html#5039" class="Bound">Ξ</a>
<a id="5288" href="Amethyst.Network.As.Schmitty.html#5001" class="Function">withReflectedNetworkAsScript</a> <a id="5317" class="Symbol">{</a><a id="5318" class="Argument">ls</a> <a id="5321" class="Symbol">=</a> <a id="5323" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a><a id="5325" class="Symbol">}</a> <a id="5327" href="Amethyst.Network.As.Schmitty.html#5327" class="Bound">n</a> <a id="5329" href="Amethyst.Network.As.Schmitty.html#5329" class="Bound">constraints</a>
  <a id="5343" class="Symbol">=</a> <a id="5345" class="Symbol">(</a> <a id="5347" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a> <a id="5356" class="Symbol">(λ</a> <a id="5359" href="Amethyst.Network.As.Schmitty.html#5359" class="Bound">Γ</a> <a id="5361" class="Symbol">→</a> <a id="5363" href="SMT.Script.Base.html#9293" class="Datatype">Script</a> <a id="5370" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="5373" href="Amethyst.Network.As.Schmitty.html#5359" class="Bound">Γ</a> <a id="5375" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5377" class="Symbol">)</a> <a id="5379" class="Symbol">(</a><a id="5380" href="Amethyst.Network.As.Schmitty.html#4236" class="Function">ʳ++-reverse</a> <a id="5392" class="Symbol">(</a><a id="5393" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5399" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="5401" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="5404" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a><a id="5406" class="Symbol">)</a> <a id="5408" class="Symbol">(</a><a id="5409" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5415" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="5417" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="5420" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a><a id="5422" class="Symbol">))</a>
    <a id="5429" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5431" href="SMT.Script.Base.html#9920" class="Function">declare-consts</a> <a id="5446" class="Symbol">(</a><a id="5447" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="5460" class="Symbol">(</a><a id="5461" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5467" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="5469" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="5472" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a><a id="5474" class="Symbol">))</a>
    <a id="5481" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5483" href="SMT.Script.Base.html#9920" class="Function">declare-consts</a> <a id="5498" class="Symbol">(</a><a id="5499" href="Data.List.Base.html#9441" class="Function">List.reverse</a> <a id="5512" class="Symbol">(</a><a id="5513" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5519" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="5521" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="5524" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a><a id="5526" class="Symbol">))</a>
    <a id="5533" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5535" href="SMT.Script.Base.html#9064" class="InductiveConstructor">assert</a> <a id="5542" class="Symbol">(</a><a id="5543" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="5553" class="Symbol">_</a>
        <a id="5563" class="Symbol">(</a><a id="5564" href="SMT.Script.Base.html#2141" class="InductiveConstructor">app₂</a> <a id="5569" href="SMT.Theories.Core.Extensions.html#1293" class="Function">and</a><a id="5572" class="Symbol">)</a>
        <a id="5582" class="Symbol">(</a><a id="5583" href="SMT.Script.Base.html#2071" class="InductiveConstructor">app₀</a> <a id="5588" href="SMT.Theories.Core.Extensions.html#1020" class="Function">true</a><a id="5592" class="Symbol">)</a>
        <a id="5602" class="Symbol">(</a><a id="5603" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a>
          <a id="5625" class="Symbol">(</a><a id="5626" href="SMT.Script.Base.html#2141" class="InductiveConstructor">app₂</a> <a id="5631" href="SMT.Theories.Reals.Base.html#4232" class="InductiveConstructor">eq</a><a id="5633" class="Symbol">)</a>
          <a id="5645" class="Symbol">(</a><a id="5646" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a> <a id="5655" class="Symbol">(λ</a> <a id="5658" href="Amethyst.Network.As.Schmitty.html#5658" class="Bound">Γ</a> <a id="5660" class="Symbol">→</a> <a id="5662" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5666" class="Symbol">(</a><a id="5667" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="5672" href="Amethyst.Network.As.Schmitty.html#5658" class="Bound">Γ</a><a id="5673" class="Symbol">)</a> <a id="5675" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="5677" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="5680" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a><a id="5682" class="Symbol">)</a> <a id="5684" class="Symbol">(</a><a id="5685" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">Eq.sym</a> <a id="5692" class="Symbol">(</a><a id="5693" href="Amethyst.Network.As.Schmitty.html#4236" class="Function">ʳ++-reverse</a> <a id="5705" class="Symbol">(</a><a id="5706" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5712" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="5714" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="5717" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a><a id="5719" class="Symbol">)</a> <a id="5721" class="Symbol">(</a><a id="5722" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5728" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="5730" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="5733" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a><a id="5735" class="Symbol">)))</a> <a id="5739" href="Amethyst.Network.As.Schmitty.html#6012" class="Function">ov</a><a id="5741" class="Symbol">)</a>
          <a id="5753" class="Symbol">(</a><a id="5754" href="Amethyst.Network.As.Schmitty.html#3486" class="Function">reflectNetwork</a> <a id="5769" href="Amethyst.Network.As.Schmitty.html#5327" class="Bound">n</a>
            <a id="5783" class="Symbol">(</a><a id="5784" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">Eq.subst</a> <a id="5793" class="Symbol">(λ</a> <a id="5796" href="Amethyst.Network.As.Schmitty.html#5796" class="Bound">Γ</a> <a id="5798" class="Symbol">→</a> <a id="5800" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5804" class="Symbol">(</a><a id="5805" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="5810" href="Amethyst.Network.As.Schmitty.html#5796" class="Bound">Γ</a><a id="5811" class="Symbol">)</a> <a id="5813" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="5815" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="5818" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a><a id="5820" class="Symbol">)</a> <a id="5822" class="Symbol">(</a><a id="5823" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">Eq.sym</a> <a id="5830" class="Symbol">(</a><a id="5831" href="Amethyst.Network.As.Schmitty.html#4236" class="Function">ʳ++-reverse</a> <a id="5843" class="Symbol">(</a><a id="5844" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5850" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="5852" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="5855" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a><a id="5857" class="Symbol">)</a> <a id="5859" class="Symbol">(</a><a id="5860" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5866" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="5868" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="5871" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a><a id="5873" class="Symbol">)))</a> <a id="5877" href="Amethyst.Network.As.Schmitty.html#5929" class="Function">iv</a><a id="5879" class="Symbol">))))</a>
    <a id="5888" href="SMT.Script.Base.html#9378" class="InductiveConstructor Operator">∷</a> <a id="5890" href="SMT.Script.Base.html#9356" class="InductiveConstructor">[]</a>
    <a id="5897" class="Symbol">)</a> <a id="5899" href="SMT.Script.Base.html#9463" class="Function Operator">◆</a> <a id="5901" href="Amethyst.Network.As.Schmitty.html#5329" class="Bound">constraints</a> <a id="5913" href="Amethyst.Network.As.Schmitty.html#5929" class="Function">iv</a> <a id="5916" href="Amethyst.Network.As.Schmitty.html#6012" class="Function">ov</a>
  <a id="5921" class="Keyword">where</a>
  <a id="5929" href="Amethyst.Network.As.Schmitty.html#5929" class="Function">iv</a> <a id="5932" class="Symbol">=</a> <a id="5934" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="5942" class="Symbol">(</a><a id="5943" href="SMT.Script.Base.html#1579" class="InductiveConstructor">var</a> <a id="5947" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5949" href="SMT.Script.Base.html#3255" class="Function">injectVar</a> <a id="5959" class="Symbol">(</a><a id="5960" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="5966" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="5968" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="5971" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a><a id="5973" class="Symbol">)</a> <a id="5975" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5977" href="Amethyst.LinearAlgebra.As.Schmitty.html#1415" class="Function">Reals∋Real</a><a id="5987" class="Symbol">)</a> <a id="5989" class="Symbol">(</a><a id="5990" href="Data.Vec.Base.html#5972" class="Function">Vec.allFin</a> <a id="6001" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="6003" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="6006" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a><a id="6008" class="Symbol">)</a>
  <a id="6012" href="Amethyst.Network.As.Schmitty.html#6012" class="Function">ov</a> <a id="6015" class="Symbol">=</a> <a id="6017" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="6025" class="Symbol">(</a><a id="6026" href="SMT.Script.Base.html#1579" class="InductiveConstructor">var</a> <a id="6030" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6032" href="SMT.Script.Base.html#3410" class="Function">raiseVar</a>  <a id="6042" class="Symbol">(</a><a id="6043" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="6049" href="Amethyst.Network.Base.html#1169" class="Function Operator">∣</a> <a id="6051" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="6054" href="Amethyst.Network.Base.html#1169" class="Function Operator">₀∣</a><a id="6056" class="Symbol">)</a> <a id="6058" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6060" href="Amethyst.LinearAlgebra.As.Schmitty.html#1415" class="Function">Reals∋Real</a><a id="6070" class="Symbol">)</a> <a id="6072" class="Symbol">(</a><a id="6073" href="Data.Vec.Base.html#5972" class="Function">Vec.allFin</a> <a id="6084" href="Amethyst.Network.Base.html#1219" class="Function Operator">∣</a> <a id="6086" href="Amethyst.Network.As.Schmitty.html#5323" class="Bound">ls</a> <a id="6089" href="Amethyst.Network.Base.html#1219" class="Function Operator">ₙ∣</a><a id="6091" class="Symbol">)</a>
</pre></body></html>