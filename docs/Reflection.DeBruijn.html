<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.DeBruijn</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Weakening, strengthening and free variable check for reflected terms.</a>
<a id="179" class="Comment">------------------------------------------------------------------------</a>

<a id="253" class="Symbol">{-#</a> <a id="257" class="Keyword">OPTIONS</a> <a id="265" class="Pragma">--without-K</a> <a id="277" class="Pragma">--safe</a> <a id="284" class="Symbol">#-}</a>

<a id="289" class="Keyword">module</a> <a id="296" href="Reflection.DeBruijn.html" class="Module">Reflection.DeBruijn</a> <a id="316" class="Keyword">where</a>

<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="345" class="Keyword">using</a> <a id="351" class="Symbol">(</a><a id="352" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="356" class="Symbol">;</a> <a id="358" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="362" class="Symbol">;</a> <a id="364" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="369" class="Symbol">;</a> <a id="371" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a><a id="374" class="Symbol">;</a> <a id="376" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a><a id="389" class="Symbol">)</a>
<a id="391" class="Keyword">open</a> <a id="396" class="Keyword">import</a> <a id="403" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="412" class="Symbol">as</a> <a id="415" class="Module">Nat</a> <a id="419" class="Keyword">using</a> <a id="425" class="Symbol">(</a><a id="426" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="427" class="Symbol">;</a> <a id="429" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="433" class="Symbol">;</a> <a id="435" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="438" class="Symbol">;</a> <a id="440" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="443" class="Symbol">;</a> <a id="445" href="Data.Nat.Base.html#1238" class="Primitive Operator">_&lt;ᵇ_</a><a id="449" class="Symbol">;</a> <a id="451" href="Data.Nat.Base.html#1064" class="Primitive Operator">_≡ᵇ_</a><a id="455" class="Symbol">)</a>
<a id="457" class="Keyword">open</a> <a id="462" class="Keyword">import</a> <a id="469" href="Data.List.html" class="Module">Data.List</a> <a id="479" class="Keyword">using</a> <a id="485" class="Symbol">(</a><a id="486" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="490" class="Symbol">;</a> <a id="492" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="494" class="Symbol">;</a> <a id="496" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="499" class="Symbol">;</a> <a id="501" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="505" class="Symbol">)</a>
<a id="507" class="Keyword">open</a> <a id="512" class="Keyword">import</a> <a id="519" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="530" class="Keyword">using</a> <a id="536" class="Symbol">(</a><a id="537" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="542" class="Symbol">;</a> <a id="544" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="551" class="Symbol">;</a> <a id="553" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="557" class="Symbol">)</a>
<a id="559" class="Keyword">import</a> <a id="566" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="589" class="Symbol">as</a> <a id="592" class="Module">Maybe</a>
<a id="598" class="Keyword">import</a> <a id="605" href="Function.Identity.Categorical.html" class="Module">Function.Identity.Categorical</a> <a id="635" class="Symbol">as</a> <a id="638" class="Module">Identity</a>
<a id="647" class="Keyword">open</a> <a id="652" class="Keyword">import</a> <a id="659" href="Category.Applicative.html" class="Module">Category.Applicative</a> <a id="680" class="Keyword">using</a> <a id="686" class="Symbol">(</a><a id="687" href="Category.Applicative.html#494" class="Function">RawApplicative</a><a id="701" class="Symbol">)</a>

<a id="704" class="Keyword">open</a> <a id="709" class="Keyword">import</a> <a id="716" href="Reflection.html" class="Module">Reflection</a>
<a id="727" class="Keyword">open</a> <a id="732" class="Keyword">import</a> <a id="739" href="Reflection.Argument.Visibility.html" class="Module">Reflection.Argument.Visibility</a> <a id="770" class="Keyword">using</a> <a id="776" class="Symbol">(</a><a id="777" href="Agda.Builtin.Reflection.html#2738" class="Datatype">Visibility</a><a id="787" class="Symbol">)</a>
<a id="789" class="Keyword">import</a> <a id="796" href="Reflection.Traversal.html" class="Module">Reflection.Traversal</a> <a id="817" class="Symbol">as</a> <a id="820" class="Module">Traverse</a>

<a id="830" class="Keyword">private</a>
  <a id="840" class="Keyword">variable</a> <a id="849" href="Reflection.DeBruijn.html#849" class="Generalizable">A</a> <a id="851" class="Symbol">:</a> <a id="853" href="Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="858" class="Comment">------------------------------------------------------------------------</a>
<a id="931" class="Comment">-- Weakening</a>

<a id="945" class="Keyword">module</a> <a id="952" href="Reflection.DeBruijn.html#952" class="Module">_</a> <a id="954" class="Keyword">where</a>

  <a id="963" class="Keyword">open</a> <a id="968" href="Reflection.Traversal.html" class="Module">Traverse</a> <a id="977" href="Function.Identity.Categorical.html#559" class="Function">Identity.applicative</a>

  <a id="1001" class="Keyword">private</a>

    <a id="1014" href="Reflection.DeBruijn.html#1014" class="Function">wkVar</a> <a id="1020" class="Symbol">:</a> <a id="1022" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1024" class="Symbol">→</a> <a id="1026" href="Reflection.Traversal.html#937" class="Record">Cxt</a> <a id="1030" class="Symbol">→</a> <a id="1032" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1034" class="Symbol">→</a> <a id="1036" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1042" href="Reflection.DeBruijn.html#1014" class="Function">wkVar</a> <a id="1048" href="Reflection.DeBruijn.html#1048" class="Bound">by</a> <a id="1051" class="Symbol">(</a><a id="1052" href="Reflection.DeBruijn.html#1052" class="Bound">from</a> <a id="1057" href="Reflection.Traversal.html#967" class="InductiveConstructor Operator">,</a> <a id="1059" class="Symbol">_)</a> <a id="1062" href="Reflection.DeBruijn.html#1062" class="Bound">i</a> <a id="1064" class="Symbol">=</a> <a id="1066" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1069" href="Reflection.DeBruijn.html#1062" class="Bound">i</a> <a id="1071" href="Data.Nat.Base.html#1238" class="Primitive Operator">&lt;ᵇ</a> <a id="1074" href="Reflection.DeBruijn.html#1052" class="Bound">from</a> <a id="1079" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1084" href="Reflection.DeBruijn.html#1062" class="Bound">i</a> <a id="1086" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1091" href="Reflection.DeBruijn.html#1062" class="Bound">i</a> <a id="1093" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1095" href="Reflection.DeBruijn.html#1048" class="Bound">by</a>

    <a id="1103" href="Reflection.DeBruijn.html#1103" class="Function">actions</a> <a id="1111" class="Symbol">:</a> <a id="1113" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1115" class="Symbol">→</a> <a id="1117" href="Reflection.Traversal.html#1427" class="Record">Actions</a>
    <a id="1129" href="Reflection.DeBruijn.html#1103" class="Function">actions</a> <a id="1137" href="Reflection.DeBruijn.html#1137" class="Bound">k</a> <a id="1139" class="Symbol">=</a> <a id="1141" class="Keyword">record</a> <a id="1148" href="Reflection.Traversal.html#1584" class="Function">defaultActions</a> <a id="1163" class="Symbol">{</a> <a id="1165" href="Reflection.Traversal.html#1459" class="Field">onVar</a> <a id="1171" class="Symbol">=</a> <a id="1173" href="Reflection.DeBruijn.html#1014" class="Function">wkVar</a> <a id="1179" href="Reflection.DeBruijn.html#1137" class="Bound">k</a> <a id="1181" class="Symbol">}</a>

  <a id="1186" href="Reflection.DeBruijn.html#1186" class="Function">weakenFrom′</a> <a id="1198" class="Symbol">:</a> <a id="1200" class="Symbol">(</a><a id="1201" href="Reflection.Traversal.html#1427" class="Record">Actions</a> <a id="1209" class="Symbol">→</a> <a id="1211" href="Reflection.Traversal.html#937" class="Record">Cxt</a> <a id="1215" class="Symbol">→</a> <a id="1217" href="Reflection.DeBruijn.html#849" class="Generalizable">A</a> <a id="1219" class="Symbol">→</a> <a id="1221" href="Reflection.DeBruijn.html#849" class="Generalizable">A</a><a id="1222" class="Symbol">)</a> <a id="1224" class="Symbol">→</a> <a id="1226" class="Symbol">(</a><a id="1227" href="Reflection.DeBruijn.html#1227" class="Bound">from</a> <a id="1232" href="Reflection.DeBruijn.html#1232" class="Bound">by</a> <a id="1235" class="Symbol">:</a> <a id="1237" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1238" class="Symbol">)</a> <a id="1240" class="Symbol">→</a> <a id="1242" href="Reflection.DeBruijn.html#849" class="Generalizable">A</a> <a id="1244" class="Symbol">→</a> <a id="1246" href="Reflection.DeBruijn.html#849" class="Generalizable">A</a>
  <a id="1250" href="Reflection.DeBruijn.html#1186" class="Function">weakenFrom′</a> <a id="1262" href="Reflection.DeBruijn.html#1262" class="Bound">trav</a> <a id="1267" href="Reflection.DeBruijn.html#1267" class="Bound">from</a> <a id="1272" href="Reflection.DeBruijn.html#1272" class="Bound">by</a> <a id="1275" class="Symbol">=</a> <a id="1277" href="Reflection.DeBruijn.html#1262" class="Bound">trav</a> <a id="1282" class="Symbol">(</a><a id="1283" href="Reflection.DeBruijn.html#1103" class="Function">actions</a> <a id="1291" href="Reflection.DeBruijn.html#1272" class="Bound">by</a><a id="1293" class="Symbol">)</a> <a id="1295" class="Symbol">(</a><a id="1296" href="Reflection.DeBruijn.html#1267" class="Bound">from</a> <a id="1301" href="Reflection.Traversal.html#967" class="InductiveConstructor Operator">,</a> <a id="1303" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1305" class="Symbol">)</a> <a id="1307" class="Comment">-- not using the context part</a>

  <a id="1340" href="Reflection.DeBruijn.html#1340" class="Function">weakenFrom</a> <a id="1351" class="Symbol">:</a> <a id="1353" class="Symbol">(</a><a id="1354" href="Reflection.DeBruijn.html#1354" class="Bound">from</a> <a id="1359" href="Reflection.DeBruijn.html#1359" class="Bound">by</a> <a id="1362" class="Symbol">:</a> <a id="1364" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1365" class="Symbol">)</a> <a id="1367" class="Symbol">→</a> <a id="1369" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a> <a id="1374" class="Symbol">→</a> <a id="1376" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a>
  <a id="1383" href="Reflection.DeBruijn.html#1340" class="Function">weakenFrom</a> <a id="1394" class="Symbol">=</a> <a id="1396" href="Reflection.DeBruijn.html#1186" class="Function">weakenFrom′</a> <a id="1408" href="Reflection.Traversal.html#1929" class="Function">traverseTerm</a>

  <a id="1424" href="Reflection.DeBruijn.html#1424" class="Function">weaken</a> <a id="1431" class="Symbol">:</a> <a id="1433" class="Symbol">(</a><a id="1434" href="Reflection.DeBruijn.html#1434" class="Bound">by</a> <a id="1437" class="Symbol">:</a> <a id="1439" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1440" class="Symbol">)</a> <a id="1442" class="Symbol">→</a> <a id="1444" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a> <a id="1449" class="Symbol">→</a> <a id="1451" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a>
  <a id="1458" href="Reflection.DeBruijn.html#1424" class="Function">weaken</a> <a id="1465" class="Symbol">=</a> <a id="1467" href="Reflection.DeBruijn.html#1340" class="Function">weakenFrom</a> <a id="1478" class="Number">0</a>

  <a id="1483" href="Reflection.DeBruijn.html#1483" class="Function">weakenArgs</a> <a id="1494" class="Symbol">:</a> <a id="1496" class="Symbol">(</a><a id="1497" href="Reflection.DeBruijn.html#1497" class="Bound">by</a> <a id="1500" class="Symbol">:</a> <a id="1502" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1503" class="Symbol">)</a> <a id="1505" class="Symbol">→</a> <a id="1507" href="Reflection.Argument.html#1325" class="Function">Args</a> <a id="1512" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a> <a id="1517" class="Symbol">→</a> <a id="1519" href="Reflection.Argument.html#1325" class="Function">Args</a> <a id="1524" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a>
  <a id="1531" href="Reflection.DeBruijn.html#1483" class="Function">weakenArgs</a> <a id="1542" class="Symbol">=</a> <a id="1544" href="Reflection.DeBruijn.html#1186" class="Function">weakenFrom′</a> <a id="1556" href="Reflection.Traversal.html#2028" class="Function">traverseArgs</a> <a id="1569" class="Number">0</a>

  <a id="1574" href="Reflection.DeBruijn.html#1574" class="Function">weakenClauses</a> <a id="1588" class="Symbol">:</a> <a id="1590" class="Symbol">(</a><a id="1591" href="Reflection.DeBruijn.html#1591" class="Bound">by</a> <a id="1594" class="Symbol">:</a> <a id="1596" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1597" class="Symbol">)</a> <a id="1599" class="Symbol">→</a> <a id="1601" href="Reflection.Term.html#1534" class="Function">Clauses</a> <a id="1609" class="Symbol">→</a> <a id="1611" href="Reflection.Term.html#1534" class="Function">Clauses</a>
  <a id="1621" href="Reflection.DeBruijn.html#1574" class="Function">weakenClauses</a> <a id="1635" class="Symbol">=</a> <a id="1637" href="Reflection.DeBruijn.html#1186" class="Function">weakenFrom′</a> <a id="1649" href="Reflection.Traversal.html#2208" class="Function">traverseClauses</a> <a id="1665" class="Number">0</a>


<a id="1669" class="Comment">------------------------------------------------------------------------</a>
<a id="1742" class="Comment">-- η-expansion</a>

<a id="1758" class="Keyword">private</a>
  <a id="η"></a><a id="1768" href="Reflection.DeBruijn.html#1768" class="Function">η</a> <a id="1770" class="Symbol">:</a> <a id="1772" href="Agda.Builtin.Reflection.html#2738" class="Datatype">Visibility</a> <a id="1783" class="Symbol">→</a> <a id="1785" class="Symbol">(</a><a id="1786" href="Reflection.Argument.html#1325" class="Function">Args</a> <a id="1791" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a> <a id="1796" class="Symbol">→</a> <a id="1798" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a><a id="1802" class="Symbol">)</a> <a id="1804" class="Symbol">→</a> <a id="1806" href="Reflection.Argument.html#1325" class="Function">Args</a> <a id="1811" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a> <a id="1816" class="Symbol">→</a> <a id="1818" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a>
  <a id="1825" href="Reflection.DeBruijn.html#1768" class="Function">η</a> <a id="1827" href="Reflection.DeBruijn.html#1827" class="Bound">h</a> <a id="1829" href="Reflection.DeBruijn.html#1829" class="Bound">f</a> <a id="1831" href="Reflection.DeBruijn.html#1831" class="Bound">args</a> <a id="1836" class="Symbol">=</a> <a id="1838" href="Agda.Builtin.Reflection.html#4518" class="InductiveConstructor">lam</a> <a id="1842" href="Reflection.DeBruijn.html#1827" class="Bound">h</a> <a id="1844" class="Symbol">(</a><a id="1845" href="Agda.Builtin.Reflection.html#3538" class="InductiveConstructor">abs</a> <a id="1849" class="String">&quot;x&quot;</a> <a id="1853" class="Symbol">(</a><a id="1854" href="Reflection.DeBruijn.html#1829" class="Bound">f</a> <a id="1856" class="Symbol">(</a><a id="1857" href="Reflection.DeBruijn.html#1483" class="Function">weakenArgs</a> <a id="1868" class="Number">1</a> <a id="1870" href="Reflection.DeBruijn.html#1831" class="Bound">args</a> <a id="1875" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="1878" href="Agda.Builtin.Reflection.html#3291" class="InductiveConstructor">arg</a> <a id="1882" class="Symbol">(</a><a id="1883" href="Agda.Builtin.Reflection.html#3195" class="InductiveConstructor">arg-info</a> <a id="1892" href="Reflection.DeBruijn.html#1827" class="Bound">h</a> <a id="1894" href="Agda.Builtin.Reflection.html#3020" class="InductiveConstructor">relevant</a><a id="1902" class="Symbol">)</a> <a id="1904" class="Symbol">(</a><a id="1905" href="Agda.Builtin.Reflection.html#4348" class="InductiveConstructor">var</a> <a id="1909" class="Number">0</a> <a id="1911" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1913" class="Symbol">)</a> <a id="1915" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1917" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1919" class="Symbol">)))</a>

<a id="η-expand"></a><a id="1924" href="Reflection.DeBruijn.html#1924" class="Function">η-expand</a> <a id="1933" class="Symbol">:</a> <a id="1935" href="Agda.Builtin.Reflection.html#2738" class="Datatype">Visibility</a> <a id="1946" class="Symbol">→</a> <a id="1948" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a> <a id="1953" class="Symbol">→</a> <a id="1955" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a>
<a id="1960" href="Reflection.DeBruijn.html#1924" class="Function">η-expand</a> <a id="1969" href="Reflection.DeBruijn.html#1969" class="Bound">h</a> <a id="1971" class="Symbol">(</a><a id="1972" href="Agda.Builtin.Reflection.html#4348" class="InductiveConstructor">var</a> <a id="1976" href="Reflection.DeBruijn.html#1976" class="Bound">x</a>      <a id="1983" href="Reflection.DeBruijn.html#1983" class="Bound">args</a><a id="1987" class="Symbol">)</a> <a id="1989" class="Symbol">=</a> <a id="1991" href="Reflection.DeBruijn.html#1768" class="Function">η</a> <a id="1993" href="Reflection.DeBruijn.html#1969" class="Bound">h</a> <a id="1995" class="Symbol">(</a><a id="1996" href="Agda.Builtin.Reflection.html#4348" class="InductiveConstructor">var</a> <a id="2000" class="Symbol">(</a><a id="2001" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2005" href="Reflection.DeBruijn.html#1976" class="Bound">x</a><a id="2006" class="Symbol">))</a> <a id="2009" href="Reflection.DeBruijn.html#1983" class="Bound">args</a>
<a id="2014" href="Reflection.DeBruijn.html#1924" class="Function">η-expand</a> <a id="2023" href="Reflection.DeBruijn.html#2023" class="Bound">h</a> <a id="2025" class="Symbol">(</a><a id="2026" href="Agda.Builtin.Reflection.html#4404" class="InductiveConstructor">con</a> <a id="2030" href="Reflection.DeBruijn.html#2030" class="Bound">c</a>      <a id="2037" href="Reflection.DeBruijn.html#2037" class="Bound">args</a><a id="2041" class="Symbol">)</a> <a id="2043" class="Symbol">=</a> <a id="2045" href="Reflection.DeBruijn.html#1768" class="Function">η</a> <a id="2047" href="Reflection.DeBruijn.html#2023" class="Bound">h</a> <a id="2049" class="Symbol">(</a><a id="2050" href="Agda.Builtin.Reflection.html#4404" class="InductiveConstructor">con</a> <a id="2054" href="Reflection.DeBruijn.html#2030" class="Bound">c</a><a id="2055" class="Symbol">)</a> <a id="2057" href="Reflection.DeBruijn.html#2037" class="Bound">args</a>
<a id="2062" href="Reflection.DeBruijn.html#1924" class="Function">η-expand</a> <a id="2071" href="Reflection.DeBruijn.html#2071" class="Bound">h</a> <a id="2073" class="Symbol">(</a><a id="2074" href="Agda.Builtin.Reflection.html#4461" class="InductiveConstructor">def</a> <a id="2078" href="Reflection.DeBruijn.html#2078" class="Bound">f</a>      <a id="2085" href="Reflection.DeBruijn.html#2085" class="Bound">args</a><a id="2089" class="Symbol">)</a> <a id="2091" class="Symbol">=</a> <a id="2093" href="Reflection.DeBruijn.html#1768" class="Function">η</a> <a id="2095" href="Reflection.DeBruijn.html#2071" class="Bound">h</a> <a id="2097" class="Symbol">(</a><a id="2098" href="Agda.Builtin.Reflection.html#4461" class="InductiveConstructor">def</a> <a id="2102" href="Reflection.DeBruijn.html#2078" class="Bound">f</a><a id="2103" class="Symbol">)</a> <a id="2105" href="Reflection.DeBruijn.html#2085" class="Bound">args</a>
<a id="2110" href="Reflection.DeBruijn.html#1924" class="Function">η-expand</a> <a id="2119" href="Reflection.DeBruijn.html#2119" class="Bound">h</a> <a id="2121" class="Symbol">(</a><a id="2122" href="Agda.Builtin.Reflection.html#4571" class="InductiveConstructor">pat-lam</a> <a id="2130" href="Reflection.DeBruijn.html#2130" class="Bound">cs</a> <a id="2133" href="Reflection.DeBruijn.html#2133" class="Bound">args</a><a id="2137" class="Symbol">)</a> <a id="2139" class="Symbol">=</a> <a id="2141" href="Reflection.DeBruijn.html#1768" class="Function">η</a> <a id="2143" href="Reflection.DeBruijn.html#2119" class="Bound">h</a> <a id="2145" class="Symbol">(</a><a id="2146" href="Agda.Builtin.Reflection.html#4571" class="InductiveConstructor">pat-lam</a> <a id="2154" class="Symbol">(</a><a id="2155" href="Reflection.DeBruijn.html#1574" class="Function">weakenClauses</a> <a id="2169" class="Number">1</a> <a id="2171" href="Reflection.DeBruijn.html#2130" class="Bound">cs</a><a id="2173" class="Symbol">))</a> <a id="2176" href="Reflection.DeBruijn.html#2133" class="Bound">args</a>
<a id="2181" href="Reflection.DeBruijn.html#1924" class="Function">η-expand</a> <a id="2190" href="Reflection.DeBruijn.html#2190" class="Bound">h</a> <a id="2192" class="Symbol">(</a><a id="2193" href="Agda.Builtin.Reflection.html#4754" class="InductiveConstructor">meta</a> <a id="2198" href="Reflection.DeBruijn.html#2198" class="Bound">x</a>     <a id="2204" href="Reflection.DeBruijn.html#2204" class="Bound">args</a><a id="2208" class="Symbol">)</a> <a id="2210" class="Symbol">=</a> <a id="2212" href="Reflection.DeBruijn.html#1768" class="Function">η</a> <a id="2214" href="Reflection.DeBruijn.html#2190" class="Bound">h</a> <a id="2216" class="Symbol">(</a><a id="2217" href="Agda.Builtin.Reflection.html#4754" class="InductiveConstructor">meta</a> <a id="2222" href="Reflection.DeBruijn.html#2198" class="Bound">x</a><a id="2223" class="Symbol">)</a> <a id="2225" href="Reflection.DeBruijn.html#2204" class="Bound">args</a>
<a id="2230" href="Reflection.DeBruijn.html#1924" class="Function">η-expand</a> <a id="2239" href="Reflection.DeBruijn.html#2239" class="Bound">h</a> <a id="2241" href="Reflection.DeBruijn.html#2241" class="Bound">t</a><a id="2242" class="Symbol">@(</a><a id="2244" href="Agda.Builtin.Reflection.html#4518" class="InductiveConstructor">lam</a> <a id="2248" class="Symbol">_</a> <a id="2250" class="Symbol">_)</a>       <a id="2259" class="Symbol">=</a> <a id="2261" href="Reflection.DeBruijn.html#2241" class="Bound">t</a>
<a id="2263" href="Reflection.DeBruijn.html#1924" class="Function">η-expand</a> <a id="2272" href="Reflection.DeBruijn.html#2272" class="Bound">h</a> <a id="2274" href="Reflection.DeBruijn.html#2274" class="Bound">t</a><a id="2275" class="Symbol">@(</a><a id="2277" href="Agda.Builtin.Reflection.html#4636" class="InductiveConstructor">pi</a> <a id="2280" class="Symbol">_</a> <a id="2282" class="Symbol">_)</a>        <a id="2292" class="Symbol">=</a> <a id="2294" href="Reflection.DeBruijn.html#2274" class="Bound">t</a>
<a id="2296" href="Reflection.DeBruijn.html#1924" class="Function">η-expand</a> <a id="2305" href="Reflection.DeBruijn.html#2305" class="Bound">h</a> <a id="2307" href="Reflection.DeBruijn.html#2307" class="Bound">t</a><a id="2308" class="Symbol">@(</a><a id="2310" href="Reflection.Term.html#1396" class="InductiveConstructor">agda-sort</a> <a id="2320" class="Symbol">_)</a>   <a id="2325" class="Symbol">=</a> <a id="2327" href="Reflection.DeBruijn.html#2307" class="Bound">t</a>
<a id="2329" href="Reflection.DeBruijn.html#1924" class="Function">η-expand</a> <a id="2338" href="Reflection.DeBruijn.html#2338" class="Bound">h</a> <a id="2340" href="Reflection.DeBruijn.html#2340" class="Bound">t</a><a id="2341" class="Symbol">@(</a><a id="2343" href="Agda.Builtin.Reflection.html#4719" class="InductiveConstructor">lit</a> <a id="2347" class="Symbol">_)</a>         <a id="2358" class="Symbol">=</a> <a id="2360" href="Reflection.DeBruijn.html#2340" class="Bound">t</a>
<a id="2362" href="Reflection.DeBruijn.html#1924" class="Function">η-expand</a> <a id="2371" href="Reflection.DeBruijn.html#2371" class="Bound">h</a> <a id="2373" href="Reflection.DeBruijn.html#2373" class="Bound">t</a><a id="2374" class="Symbol">@</a><a id="2375" href="Agda.Builtin.Reflection.html#4804" class="InductiveConstructor">unknown</a>         <a id="2391" class="Symbol">=</a> <a id="2393" href="Reflection.DeBruijn.html#2373" class="Bound">t</a>


<a id="2397" class="Comment">------------------------------------------------------------------------</a>
<a id="2470" class="Comment">-- Strengthening</a>

<a id="2488" class="Keyword">module</a> <a id="2495" href="Reflection.DeBruijn.html#2495" class="Module">_</a> <a id="2497" class="Keyword">where</a>

  <a id="2506" class="Keyword">open</a> <a id="2511" href="Reflection.Traversal.html" class="Module">Traverse</a> <a id="2520" href="Data.Maybe.Categorical.html#646" class="Function">Maybe.applicative</a>

  <a id="2541" class="Keyword">private</a>
    <a id="2553" href="Reflection.DeBruijn.html#2553" class="Function">strVar</a> <a id="2560" class="Symbol">:</a> <a id="2562" href="Reflection.Traversal.html#937" class="Record">Cxt</a> <a id="2566" class="Symbol">→</a> <a id="2568" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2570" class="Symbol">→</a> <a id="2572" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2578" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2584" href="Reflection.DeBruijn.html#2553" class="Function">strVar</a> <a id="2591" class="Symbol">(</a><a id="2592" href="Reflection.DeBruijn.html#2592" class="Bound">k</a> <a id="2594" href="Reflection.Traversal.html#967" class="InductiveConstructor Operator">,</a> <a id="2596" href="Reflection.DeBruijn.html#2596" class="Bound">Γ</a><a id="2597" class="Symbol">)</a> <a id="2599" href="Reflection.DeBruijn.html#2599" class="Bound">i</a> <a id="2601" class="Keyword">with</a> <a id="2606" href="Data.Nat.Base.html#5047" class="Function">Nat.compare</a> <a id="2618" href="Reflection.DeBruijn.html#2599" class="Bound">i</a> <a id="2620" href="Reflection.DeBruijn.html#2592" class="Bound">k</a>
    <a id="2626" class="Symbol">...</a> <a id="2630" class="Symbol">|</a> <a id="2632" href="Data.Nat.Base.html#4925" class="InductiveConstructor">Nat.less</a> <a id="2641" class="Symbol">_</a> <a id="2643" class="Symbol">_</a>    <a id="2648" class="Symbol">=</a> <a id="2650" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2655" class="Bound">i</a>
    <a id="2661" class="Symbol">...</a> <a id="2665" class="Symbol">|</a> <a id="2667" href="Data.Nat.Base.html#4970" class="InductiveConstructor">Nat.equal</a> <a id="2677" class="Symbol">_</a>     <a id="2683" class="Symbol">=</a> <a id="2685" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
    <a id="2697" class="Symbol">...</a> <a id="2701" class="Symbol">|</a> <a id="2703" href="Data.Nat.Base.html#5003" class="InductiveConstructor">Nat.greater</a> <a id="2715" class="Symbol">_</a> <a id="2717" class="Symbol">_</a> <a id="2719" class="Symbol">=</a> <a id="2721" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2726" class="Symbol">(</a><a id="2727" href="Data.Nat.Base.html#2741" class="Function">Nat.pred</a> <a id="2736" class="Bound">i</a><a id="2737" class="Symbol">)</a>

    <a id="2744" href="Reflection.DeBruijn.html#2744" class="Function">actions</a> <a id="2752" class="Symbol">:</a> <a id="2754" href="Reflection.Traversal.html#1427" class="Record">Actions</a>
    <a id="2766" href="Reflection.DeBruijn.html#2744" class="Function">actions</a> <a id="2774" class="Symbol">=</a> <a id="2776" class="Keyword">record</a> <a id="2783" href="Reflection.Traversal.html#1584" class="Function">defaultActions</a> <a id="2798" class="Symbol">{</a> <a id="2800" href="Reflection.Traversal.html#1459" class="Field">onVar</a> <a id="2806" class="Symbol">=</a> <a id="2808" href="Reflection.DeBruijn.html#2553" class="Function">strVar</a> <a id="2815" class="Symbol">}</a>

  <a id="2820" href="Reflection.DeBruijn.html#2820" class="Function">strengthenFrom′</a> <a id="2836" class="Symbol">:</a> <a id="2838" class="Symbol">(</a><a id="2839" href="Reflection.Traversal.html#1427" class="Record">Actions</a> <a id="2847" class="Symbol">→</a> <a id="2849" href="Reflection.Traversal.html#937" class="Record">Cxt</a> <a id="2853" class="Symbol">→</a> <a id="2855" href="Reflection.DeBruijn.html#849" class="Generalizable">A</a> <a id="2857" class="Symbol">→</a> <a id="2859" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2865" href="Reflection.DeBruijn.html#849" class="Generalizable">A</a><a id="2866" class="Symbol">)</a> <a id="2868" class="Symbol">→</a> <a id="2870" class="Symbol">(</a><a id="2871" href="Reflection.DeBruijn.html#2871" class="Bound">from</a> <a id="2876" class="Symbol">:</a> <a id="2878" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="2879" class="Symbol">)</a> <a id="2881" class="Symbol">→</a> <a id="2883" href="Reflection.DeBruijn.html#849" class="Generalizable">A</a> <a id="2885" class="Symbol">→</a> <a id="2887" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2893" href="Reflection.DeBruijn.html#849" class="Generalizable">A</a>
  <a id="2897" href="Reflection.DeBruijn.html#2820" class="Function">strengthenFrom′</a> <a id="2913" href="Reflection.DeBruijn.html#2913" class="Bound">trav</a> <a id="2918" href="Reflection.DeBruijn.html#2918" class="Bound">from</a> <a id="2923" class="Symbol">=</a> <a id="2925" href="Reflection.DeBruijn.html#2913" class="Bound">trav</a> <a id="2930" href="Reflection.DeBruijn.html#2744" class="Function">actions</a> <a id="2938" class="Symbol">(</a><a id="2939" href="Reflection.DeBruijn.html#2918" class="Bound">from</a> <a id="2944" href="Reflection.Traversal.html#967" class="InductiveConstructor Operator">,</a> <a id="2946" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2948" class="Symbol">)</a> <a id="2950" class="Comment">-- not using the context part</a>

  <a id="2983" href="Reflection.DeBruijn.html#2983" class="Function">strengthenFrom</a> <a id="2998" class="Symbol">:</a> <a id="3000" class="Symbol">(</a><a id="3001" href="Reflection.DeBruijn.html#3001" class="Bound">from</a> <a id="3006" class="Symbol">:</a> <a id="3008" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="3009" class="Symbol">)</a> <a id="3011" class="Symbol">→</a> <a id="3013" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a> <a id="3018" class="Symbol">→</a> <a id="3020" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3026" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a>
  <a id="3033" href="Reflection.DeBruijn.html#2983" class="Function">strengthenFrom</a> <a id="3048" class="Symbol">=</a> <a id="3050" href="Reflection.DeBruijn.html#2820" class="Function">strengthenFrom′</a> <a id="3066" href="Reflection.Traversal.html#1929" class="Function">traverseTerm</a>

  <a id="3082" href="Reflection.DeBruijn.html#3082" class="Function">strengthen</a> <a id="3093" class="Symbol">:</a> <a id="3095" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a> <a id="3100" class="Symbol">→</a> <a id="3102" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3108" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a>
  <a id="3115" href="Reflection.DeBruijn.html#3082" class="Function">strengthen</a> <a id="3126" class="Symbol">=</a> <a id="3128" href="Reflection.DeBruijn.html#2983" class="Function">strengthenFrom</a> <a id="3143" class="Number">0</a>


<a id="3147" class="Comment">------------------------------------------------------------------------</a>
<a id="3220" class="Comment">-- Free variable check</a>

<a id="3244" class="Keyword">module</a> <a id="3251" href="Reflection.DeBruijn.html#3251" class="Module">_</a> <a id="3253" class="Keyword">where</a>

  <a id="3262" class="Keyword">private</a>
    <a id="3274" href="Reflection.DeBruijn.html#3274" class="Function">anyApplicative</a> <a id="3289" class="Symbol">:</a> <a id="3291" href="Category.Applicative.html#494" class="Function">RawApplicative</a> <a id="3306" class="Symbol">(λ</a> <a id="3309" href="Reflection.DeBruijn.html#3309" class="Bound">_</a> <a id="3311" class="Symbol">→</a> <a id="3313" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="3317" class="Symbol">)</a>
    <a id="3323" href="Reflection.DeBruijn.html#3274" class="Function">anyApplicative</a> <a id="3338" class="Symbol">.</a><a id="3339" href="Category.Applicative.Indexed.html#1003" class="Field">RawApplicative.pure</a> <a id="3359" class="Symbol">_</a> <a id="3361" class="Symbol">=</a> <a id="3363" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
    <a id="3373" href="Reflection.DeBruijn.html#3274" class="Function">anyApplicative</a> <a id="3388" class="Symbol">.</a><a id="3389" href="Category.Applicative.Indexed.html#1034" class="Field Operator">RawApplicative._⊛_</a>    <a id="3411" class="Symbol">=</a> <a id="3413" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a>

  <a id="3420" class="Keyword">open</a> <a id="3425" href="Reflection.Traversal.html" class="Module">Traverse</a> <a id="3434" href="Reflection.DeBruijn.html#3274" class="Function">anyApplicative</a>

  <a id="3452" class="Keyword">private</a>
    <a id="3464" href="Reflection.DeBruijn.html#3464" class="Function">fvVar</a> <a id="3470" class="Symbol">:</a> <a id="3472" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3474" class="Symbol">→</a> <a id="3476" href="Reflection.Traversal.html#937" class="Record">Cxt</a> <a id="3480" class="Symbol">→</a> <a id="3482" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3484" class="Symbol">→</a> <a id="3486" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="3495" href="Reflection.DeBruijn.html#3464" class="Function">fvVar</a> <a id="3501" href="Reflection.DeBruijn.html#3501" class="Bound">i</a> <a id="3503" class="Symbol">(</a><a id="3504" href="Reflection.DeBruijn.html#3504" class="Bound">n</a> <a id="3506" href="Reflection.Traversal.html#967" class="InductiveConstructor Operator">,</a> <a id="3508" class="Symbol">_)</a> <a id="3511" href="Reflection.DeBruijn.html#3511" class="Bound">x</a> <a id="3513" class="Symbol">=</a> <a id="3515" href="Reflection.DeBruijn.html#3501" class="Bound">i</a> <a id="3517" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="3519" href="Reflection.DeBruijn.html#3504" class="Bound">n</a> <a id="3521" href="Data.Nat.Base.html#1064" class="Primitive Operator">≡ᵇ</a> <a id="3524" href="Reflection.DeBruijn.html#3511" class="Bound">x</a>

    <a id="3531" href="Reflection.DeBruijn.html#3531" class="Function">actions</a> <a id="3539" class="Symbol">:</a> <a id="3541" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3543" class="Symbol">→</a> <a id="3545" href="Reflection.Traversal.html#1427" class="Record">Actions</a>
    <a id="3557" href="Reflection.DeBruijn.html#3531" class="Function">actions</a> <a id="3565" href="Reflection.DeBruijn.html#3565" class="Bound">i</a> <a id="3567" class="Symbol">=</a> <a id="3569" class="Keyword">record</a> <a id="3576" href="Reflection.Traversal.html#1584" class="Function">defaultActions</a> <a id="3591" class="Symbol">{</a> <a id="3593" href="Reflection.Traversal.html#1459" class="Field">onVar</a> <a id="3599" class="Symbol">=</a> <a id="3601" href="Reflection.DeBruijn.html#3464" class="Function">fvVar</a> <a id="3607" href="Reflection.DeBruijn.html#3565" class="Bound">i</a> <a id="3609" class="Symbol">}</a>

  <a id="3614" href="Reflection.DeBruijn.html#3614" class="Function Operator">_∈FV_</a> <a id="3620" class="Symbol">:</a> <a id="3622" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3624" class="Symbol">→</a> <a id="3626" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Term</a> <a id="3631" class="Symbol">→</a> <a id="3633" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="3640" href="Reflection.DeBruijn.html#3640" class="Bound">i</a> <a id="3642" href="Reflection.DeBruijn.html#3614" class="Function Operator">∈FV</a> <a id="3646" href="Reflection.DeBruijn.html#3646" class="Bound">t</a> <a id="3648" class="Symbol">=</a> <a id="3650" href="Reflection.Traversal.html#1929" class="Function">traverseTerm</a> <a id="3663" class="Symbol">(</a><a id="3664" href="Reflection.DeBruijn.html#3531" class="Function">actions</a> <a id="3672" href="Reflection.DeBruijn.html#3640" class="Bound">i</a><a id="3673" class="Symbol">)</a> <a id="3675" class="Symbol">(</a><a id="3676" class="Number">0</a> <a id="3678" href="Reflection.Traversal.html#967" class="InductiveConstructor Operator">,</a> <a id="3680" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3682" class="Symbol">)</a> <a id="3684" href="Reflection.DeBruijn.html#3646" class="Bound">t</a>
</pre></body></html>