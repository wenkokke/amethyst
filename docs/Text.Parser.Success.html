<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Text.Parser.Success</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--without-K</a> <a id="25" class="Pragma">--safe</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">module</a> <a id="44" href="Text.Parser.Success.html" class="Module">Text.Parser.Success</a> <a id="64" class="Keyword">where</a>

<a id="71" class="Keyword">open</a> <a id="76" class="Keyword">import</a> <a id="83" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="97" class="Keyword">hiding</a> <a id="104" class="Symbol">(</a><a id="105" href="Data.Nat.Base.html#3332" class="Function Operator">_^_</a><a id="108" class="Symbol">)</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="169" class="Keyword">hiding</a> <a id="176" class="Symbol">(</a><a id="177" href="Data.Char.Base.html#1182" class="Function Operator">_&lt;_</a><a id="180" class="Symbol">)</a>
<a id="182" class="Keyword">open</a> <a id="187" class="Keyword">import</a> <a id="194" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="210" class="Symbol">as</a> <a id="213" class="Module">Maybe</a> <a id="219" class="Keyword">hiding</a> <a id="226" class="Symbol">(</a><a id="227" href="Data.Maybe.Base.html#2020" class="Function">map</a><a id="230" class="Symbol">)</a>
<a id="232" class="Keyword">open</a> <a id="237" class="Keyword">import</a> <a id="244" href="Data.Product.html" class="Module">Data.Product</a> <a id="257" class="Keyword">hiding</a> <a id="264" class="Symbol">(</a><a id="265" href="Data.Product.html#2450" class="Function">map</a><a id="268" class="Symbol">)</a>
<a id="270" class="Keyword">open</a> <a id="275" class="Keyword">import</a> <a id="282" href="Data.List.Sized.Interface.html" class="Module">Data.List.Sized.Interface</a>
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Function.html" class="Module">Function</a>
<a id="329" class="Keyword">open</a> <a id="334" class="Keyword">import</a> <a id="341" href="Relation.Unary.html" class="Module">Relation.Unary</a>

<a id="357" class="Keyword">open</a> <a id="362" class="Keyword">import</a> <a id="369" href="Text.Parser.Types.html" class="Module">Text.Parser.Types</a>
<a id="387" class="Keyword">open</a> <a id="392" href="Text.Parser.Types.html#838" class="Module">Success</a>

<a id="401" class="Keyword">module</a> <a id="408" href="Text.Parser.Success.html#408" class="Module">_</a> <a id="410" class="Symbol">{</a><a id="411" href="Text.Parser.Success.html#411" class="Bound">A</a> <a id="413" href="Text.Parser.Success.html#413" class="Bound">B</a> <a id="415" class="Symbol">:</a> <a id="417" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="420" class="Symbol">}</a> <a id="422" class="Symbol">{</a><a id="423" href="Text.Parser.Success.html#423" class="Bound">Toks</a> <a id="428" class="Symbol">:</a> <a id="430" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="432" class="Symbol">→</a> <a id="434" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="437" class="Symbol">}</a> <a id="439" class="Keyword">where</a>

  <a id="448" href="Text.Parser.Success.html#448" class="Function">map</a> <a id="452" class="Symbol">:</a> <a id="454" class="Symbol">(</a><a id="455" href="Text.Parser.Success.html#411" class="Bound">A</a> <a id="457" class="Symbol">→</a> <a id="459" href="Text.Parser.Success.html#413" class="Bound">B</a><a id="460" class="Symbol">)</a> <a id="462" class="Symbol">→</a> <a id="464" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="467" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="475" href="Text.Parser.Success.html#423" class="Bound">Toks</a> <a id="480" href="Text.Parser.Success.html#411" class="Bound">A</a> <a id="482" href="Relation.Unary.html#4338" class="Function Operator">⇒</a> <a id="484" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="492" href="Text.Parser.Success.html#423" class="Bound">Toks</a> <a id="497" href="Text.Parser.Success.html#413" class="Bound">B</a> <a id="499" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="503" href="Text.Parser.Success.html#448" class="Function">map</a> <a id="507" href="Text.Parser.Success.html#507" class="Bound">f</a> <a id="509" class="Symbol">(</a><a id="510" href="Text.Parser.Success.html#510" class="Bound">a</a> <a id="512" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">^</a> <a id="514" href="Text.Parser.Success.html#514" class="Bound">m≤n</a> <a id="518" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">,</a> <a id="520" href="Text.Parser.Success.html#520" class="Bound">s</a><a id="521" class="Symbol">)</a> <a id="523" class="Symbol">=</a> <a id="525" href="Text.Parser.Success.html#507" class="Bound">f</a> <a id="527" href="Text.Parser.Success.html#510" class="Bound">a</a> <a id="529" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">^</a> <a id="531" href="Text.Parser.Success.html#514" class="Bound">m≤n</a> <a id="535" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">,</a> <a id="537" href="Text.Parser.Success.html#520" class="Bound">s</a>

  <a id="542" href="Text.Parser.Success.html#542" class="Function">guardM</a> <a id="549" class="Symbol">:</a> <a id="551" class="Symbol">(</a><a id="552" href="Text.Parser.Success.html#411" class="Bound">A</a> <a id="554" class="Symbol">→</a> <a id="556" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="562" href="Text.Parser.Success.html#413" class="Bound">B</a><a id="563" class="Symbol">)</a> <a id="565" class="Symbol">→</a> <a id="567" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="570" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="578" href="Text.Parser.Success.html#423" class="Bound">Toks</a> <a id="583" href="Text.Parser.Success.html#411" class="Bound">A</a> <a id="585" href="Relation.Unary.html#4338" class="Function Operator">⇒</a> <a id="587" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="593" href="Function.Base.html#3706" class="Function Operator">∘′</a> <a id="596" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="604" href="Text.Parser.Success.html#423" class="Bound">Toks</a> <a id="609" href="Text.Parser.Success.html#413" class="Bound">B</a> <a id="611" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="615" href="Text.Parser.Success.html#542" class="Function">guardM</a> <a id="622" href="Text.Parser.Success.html#622" class="Bound">f</a> <a id="624" class="Symbol">(</a><a id="625" href="Text.Parser.Success.html#625" class="Bound">a</a> <a id="627" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">^</a> <a id="629" href="Text.Parser.Success.html#629" class="Bound">m≤n</a> <a id="633" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">,</a> <a id="635" href="Text.Parser.Success.html#635" class="Bound">s</a><a id="636" class="Symbol">)</a> <a id="638" class="Symbol">=</a> <a id="640" href="Data.Maybe.Base.html#2020" class="Function">Maybe.map</a> <a id="650" class="Symbol">(</a><a id="651" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">_^</a> <a id="654" href="Text.Parser.Success.html#629" class="Bound">m≤n</a> <a id="658" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">,</a> <a id="660" href="Text.Parser.Success.html#635" class="Bound">s</a><a id="661" class="Symbol">)</a> <a id="663" class="Symbol">(</a><a id="664" href="Text.Parser.Success.html#622" class="Bound">f</a> <a id="666" href="Text.Parser.Success.html#625" class="Bound">a</a><a id="667" class="Symbol">)</a>

<a id="670" class="Keyword">module</a> <a id="677" href="Text.Parser.Success.html#677" class="Module">_</a> <a id="679" class="Symbol">{</a><a id="680" href="Text.Parser.Success.html#680" class="Bound">A</a> <a id="682" class="Symbol">:</a> <a id="684" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="687" class="Symbol">}</a> <a id="689" class="Symbol">{</a><a id="690" href="Text.Parser.Success.html#690" class="Bound">Toks</a> <a id="695" class="Symbol">:</a> <a id="697" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="699" class="Symbol">→</a> <a id="701" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="704" class="Symbol">}</a> <a id="706" class="Keyword">where</a>

  <a id="715" href="Text.Parser.Success.html#715" class="Function">≤-lift</a> <a id="722" class="Symbol">:</a> <a id="724" class="Symbol">{</a><a id="725" href="Text.Parser.Success.html#725" class="Bound">m</a> <a id="727" href="Text.Parser.Success.html#727" class="Bound">n</a> <a id="729" class="Symbol">:</a> <a id="731" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="732" class="Symbol">}</a> <a id="734" class="Symbol">→</a> <a id="736" class="Symbol">.(</a><a id="738" href="Text.Parser.Success.html#738" class="Bound">le</a> <a id="741" class="Symbol">:</a> <a id="743" href="Text.Parser.Success.html#725" class="Bound">m</a> <a id="745" href="Data.Nat.Base.html#1396" class="Datatype Operator">≤</a> <a id="747" href="Text.Parser.Success.html#727" class="Bound">n</a><a id="748" class="Symbol">)</a> <a id="750" class="Symbol">→</a> <a id="752" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="760" href="Text.Parser.Success.html#690" class="Bound">Toks</a> <a id="765" href="Text.Parser.Success.html#680" class="Bound">A</a> <a id="767" href="Text.Parser.Success.html#725" class="Bound">m</a> <a id="769" class="Symbol">→</a> <a id="771" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="779" href="Text.Parser.Success.html#690" class="Bound">Toks</a> <a id="784" href="Text.Parser.Success.html#680" class="Bound">A</a> <a id="786" href="Text.Parser.Success.html#727" class="Bound">n</a>
  <a id="790" href="Text.Parser.Success.html#715" class="Function">≤-lift</a> <a id="797" href="Text.Parser.Success.html#797" class="Bound">m≤n</a> <a id="801" class="Symbol">(</a><a id="802" href="Text.Parser.Success.html#802" class="Bound">a</a> <a id="804" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">^</a> <a id="806" href="Text.Parser.Success.html#806" class="Bound">p&lt;m</a> <a id="810" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">,</a> <a id="812" href="Text.Parser.Success.html#812" class="Bound">s</a><a id="813" class="Symbol">)</a> <a id="815" class="Symbol">=</a> <a id="817" href="Text.Parser.Success.html#802" class="Bound">a</a> <a id="819" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">^</a> <a id="821" href="Data.Nat.Properties.html#3947" class="Function">≤-trans</a> <a id="829" href="Text.Parser.Success.html#806" class="Bound">p&lt;m</a> <a id="833" href="Text.Parser.Success.html#797" class="Bound">m≤n</a> <a id="837" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">,</a> <a id="839" href="Text.Parser.Success.html#812" class="Bound">s</a>

  <a id="844" href="Text.Parser.Success.html#844" class="Function">&lt;-lift</a> <a id="851" class="Symbol">:</a> <a id="853" class="Symbol">{</a><a id="854" href="Text.Parser.Success.html#854" class="Bound">m</a> <a id="856" href="Text.Parser.Success.html#856" class="Bound">n</a> <a id="858" class="Symbol">:</a> <a id="860" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="861" class="Symbol">}</a> <a id="863" class="Symbol">→</a> <a id="865" class="Symbol">.(</a><a id="867" href="Text.Parser.Success.html#867" class="Bound">le</a> <a id="870" class="Symbol">:</a> <a id="872" href="Text.Parser.Success.html#854" class="Bound">m</a> <a id="874" href="Data.Nat.Base.html#1506" class="Function Operator">&lt;</a> <a id="876" href="Text.Parser.Success.html#856" class="Bound">n</a><a id="877" class="Symbol">)</a> <a id="879" class="Symbol">→</a> <a id="881" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="889" href="Text.Parser.Success.html#690" class="Bound">Toks</a> <a id="894" href="Text.Parser.Success.html#680" class="Bound">A</a> <a id="896" href="Text.Parser.Success.html#854" class="Bound">m</a> <a id="898" class="Symbol">→</a> <a id="900" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="908" href="Text.Parser.Success.html#690" class="Bound">Toks</a> <a id="913" href="Text.Parser.Success.html#680" class="Bound">A</a> <a id="915" href="Text.Parser.Success.html#856" class="Bound">n</a>
  <a id="919" href="Text.Parser.Success.html#844" class="Function">&lt;-lift</a> <a id="926" href="Text.Parser.Success.html#926" class="Bound">m&lt;n</a> <a id="930" class="Symbol">=</a> <a id="932" href="Text.Parser.Success.html#715" class="Function">≤-lift</a> <a id="939" class="Symbol">(</a><a id="940" href="Data.Nat.Properties.html#6631" class="Function">&lt;⇒≤</a> <a id="944" href="Text.Parser.Success.html#926" class="Bound">m&lt;n</a><a id="947" class="Symbol">)</a>

<a id="950" class="Keyword">module</a> <a id="957" href="Text.Parser.Success.html#957" class="Module">_</a> <a id="959" class="Symbol">{</a><a id="960" href="Text.Parser.Success.html#960" class="Bound">A</a> <a id="962" href="Text.Parser.Success.html#962" class="Bound">B</a> <a id="964" class="Symbol">:</a> <a id="966" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="969" class="Symbol">}</a> <a id="971" class="Symbol">{</a><a id="972" href="Text.Parser.Success.html#972" class="Bound">Toks</a> <a id="977" class="Symbol">:</a> <a id="979" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="981" class="Symbol">→</a> <a id="983" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="986" class="Symbol">}</a> <a id="988" class="Keyword">where</a>

  <a id="997" href="Text.Parser.Success.html#997" class="Function">and</a> <a id="1001" class="Symbol">:</a> <a id="1003" class="Symbol">{</a><a id="1004" href="Text.Parser.Success.html#1004" class="Bound">n</a> <a id="1006" class="Symbol">:</a> <a id="1008" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1009" class="Symbol">}</a> <a id="1011" class="Symbol">(</a><a id="1012" href="Text.Parser.Success.html#1012" class="Bound">p</a> <a id="1014" class="Symbol">:</a> <a id="1016" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="1024" href="Text.Parser.Success.html#972" class="Bound">Toks</a> <a id="1029" href="Text.Parser.Success.html#960" class="Bound">A</a> <a id="1031" href="Text.Parser.Success.html#1004" class="Bound">n</a><a id="1032" class="Symbol">)</a> <a id="1034" class="Symbol">→</a> <a id="1036" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="1044" href="Text.Parser.Success.html#972" class="Bound">Toks</a> <a id="1049" href="Text.Parser.Success.html#962" class="Bound">B</a> <a id="1051" class="Symbol">(</a><a id="1052" href="Text.Parser.Types.html#944" class="Field">size</a> <a id="1057" href="Text.Parser.Success.html#1012" class="Bound">p</a><a id="1058" class="Symbol">)</a> <a id="1060" class="Symbol">→</a>
        <a id="1070" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="1078" href="Text.Parser.Success.html#972" class="Bound">Toks</a> <a id="1083" class="Symbol">(</a><a id="1084" href="Text.Parser.Success.html#960" class="Bound">A</a> <a id="1086" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1088" href="Text.Parser.Success.html#962" class="Bound">B</a><a id="1089" class="Symbol">)</a> <a id="1091" href="Text.Parser.Success.html#1004" class="Bound">n</a>
  <a id="1095" href="Text.Parser.Success.html#997" class="Function">and</a> <a id="1099" class="Symbol">(</a><a id="1100" href="Text.Parser.Success.html#1100" class="Bound">a</a> <a id="1102" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">^</a> <a id="1104" href="Text.Parser.Success.html#1104" class="Bound">m&lt;n</a> <a id="1108" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">,</a> <a id="1110" href="Text.Parser.Success.html#1110" class="Bound">v</a><a id="1111" class="Symbol">)</a> <a id="1113" href="Text.Parser.Success.html#1113" class="Bound">q</a> <a id="1115" class="Symbol">=</a> <a id="1117" href="Text.Parser.Success.html#844" class="Function">&lt;-lift</a> <a id="1124" href="Text.Parser.Success.html#1104" class="Bound">m&lt;n</a> <a id="1128" class="Symbol">(</a><a id="1129" href="Text.Parser.Success.html#448" class="Function">map</a> <a id="1133" class="Symbol">(</a><a id="1134" href="Text.Parser.Success.html#1100" class="Bound">a</a> <a id="1136" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="1138" class="Symbol">)</a> <a id="1140" href="Text.Parser.Success.html#1113" class="Bound">q</a><a id="1141" class="Symbol">)</a>

<a id="1144" class="Keyword">module</a> <a id="1151" href="Text.Parser.Success.html#1151" class="Module">_</a> <a id="1153" class="Symbol">{</a><a id="1154" href="Text.Parser.Success.html#1154" class="Bound">Tok</a> <a id="1158" class="Symbol">:</a> <a id="1160" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1163" class="Symbol">}</a> <a id="1165" class="Symbol">{</a><a id="1166" href="Text.Parser.Success.html#1166" class="Bound">Toks</a> <a id="1171" class="Symbol">:</a> <a id="1173" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1175" class="Symbol">→</a> <a id="1177" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1180" class="Symbol">}</a> <a id="1182" class="Symbol">{{</a><a id="1184" href="Text.Parser.Success.html#1184" class="Bound">𝕊</a> <a id="1186" class="Symbol">:</a> <a id="1188" href="Data.List.Sized.Interface.html#353" class="Record">Sized</a> <a id="1194" href="Text.Parser.Success.html#1154" class="Bound">Tok</a> <a id="1198" href="Text.Parser.Success.html#1166" class="Bound">Toks</a><a id="1202" class="Symbol">}}</a> <a id="1205" class="Keyword">where</a>

  <a id="1214" href="Text.Parser.Success.html#1214" class="Function">view</a> <a id="1219" class="Symbol">:</a> <a id="1221" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1224" href="Text.Parser.Success.html#1166" class="Bound">Toks</a> <a id="1229" href="Relation.Unary.html#4338" class="Function Operator">⇒</a> <a id="1231" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1237" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1239" href="Text.Parser.Types.html#838" class="Record">Success</a> <a id="1247" href="Text.Parser.Success.html#1166" class="Bound">Toks</a> <a id="1252" href="Text.Parser.Success.html#1154" class="Bound">Tok</a> <a id="1256" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="1260" href="Text.Parser.Success.html#1214" class="Function">view</a> <a id="1265" class="Symbol">{</a><a id="1266" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1270" class="Symbol">}</a>   <a id="1274" href="Text.Parser.Success.html#1274" class="Bound">ts</a> <a id="1277" class="Symbol">=</a> <a id="1279" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
  <a id="1289" href="Text.Parser.Success.html#1214" class="Function">view</a> <a id="1294" class="Symbol">{</a><a id="1295" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1299" href="Text.Parser.Success.html#1299" class="Bound">n</a><a id="1300" class="Symbol">}</a>  <a id="1303" href="Text.Parser.Success.html#1303" class="Bound">ts</a> <a id="1306" class="Symbol">=</a> <a id="1308" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1313" class="Symbol">(</a><a id="1314" class="Keyword">let</a> <a id="1318" class="Symbol">(</a><a id="1319" href="Text.Parser.Success.html#1319" class="Bound">t</a> <a id="1321" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1323" href="Text.Parser.Success.html#1323" class="Bound">ts</a><a id="1325" class="Symbol">)</a> <a id="1327" class="Symbol">=</a> <a id="1329" href="Data.List.Sized.Interface.html#382" class="Field">Sized.view</a> <a id="1340" href="Text.Parser.Success.html#1184" class="Bound">𝕊</a> <a id="1342" href="Text.Parser.Success.html#1303" class="Bound">ts</a> <a id="1345" class="Keyword">in</a> <a id="1348" href="Text.Parser.Success.html#1319" class="Bound">t</a> <a id="1350" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">^</a> <a id="1352" href="Data.Nat.Properties.html#3764" class="Function">≤-refl</a> <a id="1359" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">,</a> <a id="1361" href="Text.Parser.Success.html#1323" class="Bound">ts</a><a id="1363" class="Symbol">)</a>
</pre></body></html>