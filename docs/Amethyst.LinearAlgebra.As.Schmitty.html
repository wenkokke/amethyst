<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.LinearAlgebra.As.Schmitty</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Amethyst.LinearAlgebra.As.Schmitty.html" class="Module">Amethyst.LinearAlgebra.As.Schmitty</a> <a id="43" class="Keyword">where</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Amethyst.LinearAlgebra.Base.html" class="Module">Amethyst.LinearAlgebra.Base</a>
<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="111" class="Symbol">as</a> <a id="114" class="Module">Fin</a> <a id="118" class="Keyword">using</a> <a id="124" class="Symbol">(</a><a id="125" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="128" class="Symbol">;</a> <a id="130" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a><a id="134" class="Symbol">;</a> <a id="136" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a><a id="139" class="Symbol">)</a>
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="Data.Float.html" class="Module">Data.Float</a> <a id="164" class="Symbol">as</a> <a id="167" class="Module">Float</a> <a id="173" class="Keyword">using</a> <a id="179" class="Symbol">(</a><a id="180" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="185" class="Symbol">)</a>
<a id="187" class="Keyword">open</a> <a id="192" class="Keyword">import</a> <a id="199" href="Data.List.html" class="Module">Data.List</a> <a id="209" class="Symbol">as</a> <a id="212" class="Module">List</a> <a id="217" class="Keyword">using</a> <a id="223" class="Symbol">(</a><a id="224" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="228" class="Symbol">)</a>
<a id="230" class="Keyword">open</a> <a id="235" class="Keyword">import</a> <a id="242" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="251" class="Symbol">as</a> <a id="254" class="Module">Nat</a> <a id="258" class="Keyword">using</a> <a id="264" class="Symbol">(</a><a id="265" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="266" class="Symbol">;</a> <a id="268" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="272" class="Symbol">;</a> <a id="274" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="277" class="Symbol">)</a>
<a id="279" class="Keyword">open</a> <a id="284" class="Keyword">import</a> <a id="291" href="Data.Product.html" class="Module">Data.Product</a> <a id="304" class="Symbol">as</a> <a id="307" class="Module">Prod</a> <a id="312" class="Keyword">using</a> <a id="318" class="Symbol">(</a><a id="319" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="322" class="Symbol">;</a> <a id="324" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="327" class="Symbol">;</a> <a id="329" href="Data.Product.html#3399" class="Function">uncurry</a><a id="336" class="Symbol">)</a>
<a id="338" class="Keyword">open</a> <a id="343" class="Keyword">import</a> <a id="350" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="359" class="Symbol">as</a> <a id="362" class="Module">Vec</a> <a id="366" class="Keyword">using</a> <a id="372" class="Symbol">(</a><a id="373" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="376" class="Symbol">;</a> <a id="378" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="380" class="Symbol">;</a> <a id="382" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="385" class="Symbol">)</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Function.html" class="Module">Function</a> <a id="408" class="Keyword">using</a> <a id="414" class="Symbol">(</a><a id="415" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="418" class="Symbol">;</a> <a id="420" href="Function.Base.html#615" class="Function">id</a><a id="422" class="Symbol">)</a>
<a id="424" class="Keyword">open</a> <a id="429" class="Keyword">import</a> <a id="436" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="474" class="Keyword">using</a> <a id="480" class="Symbol">(</a><a id="481" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="484" class="Symbol">;</a> <a id="486" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="490" class="Symbol">)</a>
<a id="492" class="Keyword">open</a> <a id="497" class="Keyword">import</a> <a id="504" href="SMT.Theories.Reals.html" class="Module">SMT.Theories.Reals</a> <a id="523" class="Symbol">as</a> <a id="526" class="Module">Reals</a> <a id="532" class="Keyword">public</a>
<a id="539" class="Keyword">open</a> <a id="544" class="Keyword">import</a> <a id="551" href="SMT.Script.html" class="Module">SMT.Script</a> <a id="562" href="SMT.Theories.Reals.html#6058" class="Function">Reals.theory</a> <a id="575" class="Keyword">public</a>

<a id="583" class="Comment">-- * Linear algebra</a>

<a id="604" class="Keyword">private</a>
  <a id="614" class="Keyword">variable</a>
    <a id="627" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a> <a id="629" class="Symbol">:</a> <a id="631" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a>
    <a id="640" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a> <a id="642" class="Symbol">:</a> <a id="644" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="647" class="Comment">-- |Real-valued SMT terms.</a>
<a id="Real"></a><a id="674" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="679" class="Symbol">:</a> <a id="681" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a> <a id="686" class="Symbol">→</a> <a id="688" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="692" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="697" href="Amethyst.LinearAlgebra.As.Schmitty.html#697" class="Bound">Γ</a> <a id="699" class="Symbol">=</a> <a id="701" href="SMT.Script.Base.html#1472" class="Datatype">Term</a> <a id="706" href="Amethyst.LinearAlgebra.As.Schmitty.html#697" class="Bound">Γ</a> <a id="708" href="SMT.Theories.Reals.html#1016" class="InductiveConstructor">REAL</a>

<a id="toReal"></a><a id="714" href="Amethyst.LinearAlgebra.As.Schmitty.html#714" class="Function">toReal</a> <a id="721" class="Symbol">:</a> <a id="723" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="729" class="Symbol">→</a> <a id="731" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="736" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a>
<a id="738" href="Amethyst.LinearAlgebra.As.Schmitty.html#714" class="Function">toReal</a> <a id="745" class="Symbol">=</a> <a id="747" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="751" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="753" href="SMT.Theories.Reals.html#3865" class="InductiveConstructor">float</a>

<a id="760" class="Comment">-- |Typing context with only sort REAL.</a>
<a id="Reals"></a><a id="800" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="806" class="Symbol">:</a> <a id="808" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="810" class="Symbol">→</a> <a id="812" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a>
<a id="817" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="823" href="Amethyst.LinearAlgebra.As.Schmitty.html#823" class="Bound">inputs</a> <a id="830" class="Symbol">=</a> <a id="832" href="Data.List.Base.html#4852" class="Function">List.replicate</a> <a id="847" href="Amethyst.LinearAlgebra.As.Schmitty.html#823" class="Bound">inputs</a> <a id="854" href="SMT.Theories.Reals.html#1016" class="InductiveConstructor">REAL</a>

<a id="860" class="Comment">-- |Turns out that all variables in a Reals have sort REAL?</a>
<a id="Reals∋Real"></a><a id="920" href="Amethyst.LinearAlgebra.As.Schmitty.html#920" class="Function">Reals∋Real</a> <a id="931" class="Symbol">:</a> <a id="933" class="Symbol">(</a><a id="934" href="Amethyst.LinearAlgebra.As.Schmitty.html#934" class="Bound">i</a> <a id="936" class="Symbol">:</a> <a id="938" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a> <a id="942" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a><a id="943" class="Symbol">)</a> <a id="945" class="Symbol">→</a> <a id="947" href="Amethyst.LinearAlgebra.As.Schmitty.html#800" class="Function">Reals</a> <a id="953" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a> <a id="955" href="SMT.Script.Base.html#1249" class="Function Operator">∋</a> <a id="957" href="SMT.Theories.Reals.html#1016" class="InductiveConstructor">REAL</a>
<a id="962" href="Amethyst.LinearAlgebra.As.Schmitty.html#920" class="Function">Reals∋Real</a> <a id="973" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a> <a id="978" class="Symbol">=</a> <a id="980" class="Symbol">(</a><a id="981" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a> <a id="986" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="988" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="992" class="Symbol">)</a>
<a id="994" href="Amethyst.LinearAlgebra.As.Schmitty.html#920" class="Function">Reals∋Real</a> <a id="1005" class="Symbol">(</a><a id="1006" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a> <a id="1010" href="Amethyst.LinearAlgebra.As.Schmitty.html#1010" class="Bound">i</a><a id="1011" class="Symbol">)</a> <a id="1013" class="Symbol">=</a> <a id="1015" href="Data.Product.html#2450" class="Function">Prod.map</a> <a id="1024" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a> <a id="1028" href="Function.Base.html#615" class="Function">id</a> <a id="1031" class="Symbol">(</a><a id="1032" href="Amethyst.LinearAlgebra.As.Schmitty.html#920" class="Function">Reals∋Real</a> <a id="1043" href="Amethyst.LinearAlgebra.As.Schmitty.html#1010" class="Bound">i</a><a id="1044" class="Symbol">)</a>


<a id="1048" class="Comment">-- ** Vectors</a>

<a id="1063" class="Comment">-- |Sum.</a>
<a id="sum"></a><a id="1072" href="Amethyst.LinearAlgebra.As.Schmitty.html#1072" class="Function">sum</a> <a id="1076" class="Symbol">:</a> <a id="1078" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1082" class="Symbol">(</a><a id="1083" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1088" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1089" class="Symbol">)</a> <a id="1091" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a> <a id="1093" class="Symbol">→</a> <a id="1095" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1100" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a>
<a id="1102" href="Amethyst.LinearAlgebra.As.Schmitty.html#1072" class="Function">sum</a> <a id="1106" class="Symbol">=</a> <a id="1108" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="1118" class="Symbol">_</a> <a id="1120" class="Symbol">(</a><a id="1121" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1126" href="SMT.Theories.Reals.html#4560" class="InductiveConstructor">add</a><a id="1129" class="Symbol">)</a> <a id="1131" class="Symbol">(</a><a id="1132" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="1136" class="Symbol">(</a><a id="1137" href="SMT.Theories.Reals.html#3838" class="InductiveConstructor">nat</a> <a id="1141" class="Number">0</a><a id="1142" class="Symbol">))</a>

<a id="1146" class="Comment">-- |Pointwise addition.</a>
<a id="_⊕_"></a><a id="1170" href="Amethyst.LinearAlgebra.As.Schmitty.html#1170" class="Function Operator">_⊕_</a> <a id="1174" class="Symbol">:</a> <a id="1176" class="Symbol">(</a><a id="1177" href="Amethyst.LinearAlgebra.As.Schmitty.html#1177" class="Bound">xs</a> <a id="1180" href="Amethyst.LinearAlgebra.As.Schmitty.html#1180" class="Bound">ys</a> <a id="1183" class="Symbol">:</a> <a id="1185" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1189" class="Symbol">(</a><a id="1190" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1195" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1196" class="Symbol">)</a> <a id="1198" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a><a id="1199" class="Symbol">)</a> <a id="1201" class="Symbol">→</a> <a id="1203" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1207" class="Symbol">(</a><a id="1208" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1213" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1214" class="Symbol">)</a> <a id="1216" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a>
<a id="1218" href="Amethyst.LinearAlgebra.As.Schmitty.html#1170" class="Function Operator">_⊕_</a> <a id="1222" class="Symbol">=</a> <a id="1224" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="1236" class="Symbol">(</a><a id="1237" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1242" href="SMT.Theories.Reals.html#4560" class="InductiveConstructor">add</a><a id="1245" class="Symbol">)</a>

<a id="1248" class="Comment">-- |Pointwise multiplication.</a>
<a id="_⊛_"></a><a id="1278" href="Amethyst.LinearAlgebra.As.Schmitty.html#1278" class="Function Operator">_⊛_</a> <a id="1282" class="Symbol">:</a> <a id="1284" class="Symbol">(</a><a id="1285" href="Amethyst.LinearAlgebra.As.Schmitty.html#1285" class="Bound">xs</a> <a id="1288" href="Amethyst.LinearAlgebra.As.Schmitty.html#1288" class="Bound">ys</a> <a id="1291" class="Symbol">:</a> <a id="1293" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1297" class="Symbol">(</a><a id="1298" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1303" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1304" class="Symbol">)</a> <a id="1306" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a><a id="1307" class="Symbol">)</a> <a id="1309" class="Symbol">→</a> <a id="1311" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1315" class="Symbol">(</a><a id="1316" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1321" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1322" class="Symbol">)</a> <a id="1324" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a>
<a id="1326" href="Amethyst.LinearAlgebra.As.Schmitty.html#1278" class="Function Operator">_⊛_</a> <a id="1330" class="Symbol">=</a> <a id="1332" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="1344" class="Symbol">(</a><a id="1345" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1350" href="SMT.Theories.Reals.html#4591" class="InductiveConstructor">mul</a><a id="1353" class="Symbol">)</a>

<a id="1356" class="Comment">-- |Dot product.</a>
<a id="_·_"></a><a id="1373" href="Amethyst.LinearAlgebra.As.Schmitty.html#1373" class="Function Operator">_·_</a> <a id="1377" class="Symbol">:</a> <a id="1379" class="Symbol">(</a><a id="1380" href="Amethyst.LinearAlgebra.As.Schmitty.html#1380" class="Bound">xs</a> <a id="1383" href="Amethyst.LinearAlgebra.As.Schmitty.html#1383" class="Bound">ys</a> <a id="1386" class="Symbol">:</a> <a id="1388" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1392" class="Symbol">(</a><a id="1393" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1398" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1399" class="Symbol">)</a> <a id="1401" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a><a id="1402" class="Symbol">)</a> <a id="1404" class="Symbol">→</a> <a id="1406" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1411" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a>
<a id="1413" href="Amethyst.LinearAlgebra.As.Schmitty.html#1373" class="Function Operator">_·_</a> <a id="1417" href="Amethyst.LinearAlgebra.As.Schmitty.html#1417" class="Bound">xs</a> <a id="1420" href="Amethyst.LinearAlgebra.As.Schmitty.html#1420" class="Bound">ys</a> <a id="1423" class="Symbol">=</a> <a id="1425" href="Amethyst.LinearAlgebra.As.Schmitty.html#1072" class="Function">sum</a> <a id="1429" class="Symbol">(</a><a id="1430" href="Amethyst.LinearAlgebra.As.Schmitty.html#1417" class="Bound">xs</a> <a id="1433" href="Amethyst.LinearAlgebra.As.Schmitty.html#1170" class="Function Operator">⊕</a> <a id="1435" href="Amethyst.LinearAlgebra.As.Schmitty.html#1420" class="Bound">ys</a><a id="1437" class="Symbol">)</a>

<a id="1440" class="Comment">-- |Vector scaling.</a>
<a id="scale"></a><a id="1460" href="Amethyst.LinearAlgebra.As.Schmitty.html#1460" class="Function">scale</a> <a id="1466" class="Symbol">:</a> <a id="1468" class="Symbol">(</a><a id="1469" href="Amethyst.LinearAlgebra.As.Schmitty.html#1469" class="Bound">x</a> <a id="1471" class="Symbol">:</a> <a id="1473" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1478" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1479" class="Symbol">)</a> <a id="1481" class="Symbol">(</a><a id="1482" href="Amethyst.LinearAlgebra.As.Schmitty.html#1482" class="Bound">ys</a> <a id="1485" class="Symbol">:</a> <a id="1487" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1491" class="Symbol">(</a><a id="1492" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1497" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1498" class="Symbol">)</a> <a id="1500" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a><a id="1501" class="Symbol">)</a> <a id="1503" class="Symbol">→</a> <a id="1505" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1509" class="Symbol">(</a><a id="1510" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1515" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1516" class="Symbol">)</a> <a id="1518" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a>
<a id="1520" href="Amethyst.LinearAlgebra.As.Schmitty.html#1460" class="Function">scale</a> <a id="1526" href="Amethyst.LinearAlgebra.As.Schmitty.html#1526" class="Bound">x</a> <a id="1528" class="Symbol">=</a> <a id="1530" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1538" class="Symbol">(</a><a id="1539" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1544" href="SMT.Theories.Reals.html#4591" class="InductiveConstructor">mul</a> <a id="1548" href="Amethyst.LinearAlgebra.As.Schmitty.html#1526" class="Bound">x</a><a id="1549" class="Symbol">)</a>

<a id="1552" class="Comment">-- |Vector normalisation.</a>
<a id="normalise"></a><a id="1578" href="Amethyst.LinearAlgebra.As.Schmitty.html#1578" class="Function">normalise</a> <a id="1588" class="Symbol">:</a> <a id="1590" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1594" class="Symbol">(</a><a id="1595" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1600" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1601" class="Symbol">)</a> <a id="1603" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a> <a id="1605" class="Symbol">→</a> <a id="1607" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1611" class="Symbol">(</a><a id="1612" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1617" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1618" class="Symbol">)</a> <a id="1620" href="Amethyst.LinearAlgebra.As.Schmitty.html#640" class="Generalizable">n</a>
<a id="1622" href="Amethyst.LinearAlgebra.As.Schmitty.html#1578" class="Function">normalise</a> <a id="1632" href="Amethyst.LinearAlgebra.As.Schmitty.html#1632" class="Bound">xs</a> <a id="1635" class="Symbol">=</a> <a id="1637" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="1645" class="Symbol">(λ</a> <a id="1648" href="Amethyst.LinearAlgebra.As.Schmitty.html#1648" class="Bound">x</a> <a id="1650" class="Symbol">→</a> <a id="1652" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1657" href="SMT.Theories.Reals.html#4622" class="InductiveConstructor">div</a> <a id="1661" href="Amethyst.LinearAlgebra.As.Schmitty.html#1648" class="Bound">x</a> <a id="1663" class="Symbol">(</a><a id="1664" href="Amethyst.LinearAlgebra.As.Schmitty.html#1072" class="Function">sum</a> <a id="1668" href="Amethyst.LinearAlgebra.As.Schmitty.html#1632" class="Bound">xs</a><a id="1670" class="Symbol">))</a> <a id="1673" href="Amethyst.LinearAlgebra.As.Schmitty.html#1632" class="Bound">xs</a>


<a id="1678" class="Comment">-- ** Matrices</a>

<a id="1694" class="Keyword">private</a>
  <a id="1704" class="Keyword">variable</a>
    <a id="1717" href="Amethyst.LinearAlgebra.As.Schmitty.html#1717" class="Generalizable">i</a> <a id="1719" class="Symbol">:</a> <a id="1721" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1727" href="Amethyst.LinearAlgebra.As.Schmitty.html#1727" class="Generalizable">j</a> <a id="1729" class="Symbol">:</a> <a id="1731" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1737" href="Amethyst.LinearAlgebra.As.Schmitty.html#1737" class="Generalizable">k</a> <a id="1739" class="Symbol">:</a> <a id="1741" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1747" href="Amethyst.LinearAlgebra.As.Schmitty.html#1747" class="Generalizable">rows</a> <a id="1752" class="Symbol">:</a> <a id="1754" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1760" href="Amethyst.LinearAlgebra.As.Schmitty.html#1760" class="Generalizable">cols</a> <a id="1765" class="Symbol">:</a> <a id="1767" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="_v⊡m_"></a><a id="1770" href="Amethyst.LinearAlgebra.As.Schmitty.html#1770" class="Function Operator">_v⊡m_</a> <a id="1776" class="Symbol">:</a> <a id="1778" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1782" class="Symbol">(</a><a id="1783" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1788" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1789" class="Symbol">)</a> <a id="1791" href="Amethyst.LinearAlgebra.As.Schmitty.html#1727" class="Generalizable">j</a> <a id="1793" class="Symbol">→</a> <a id="1795" href="Amethyst.LinearAlgebra.Base.html#122" class="Function">Mat</a> <a id="1799" class="Symbol">(</a><a id="1800" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1805" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1806" class="Symbol">)</a> <a id="1808" href="Amethyst.LinearAlgebra.As.Schmitty.html#1727" class="Generalizable">j</a> <a id="1810" href="Amethyst.LinearAlgebra.As.Schmitty.html#1737" class="Generalizable">k</a> <a id="1812" class="Symbol">→</a> <a id="1814" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1818" class="Symbol">(</a><a id="1819" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1824" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1825" class="Symbol">)</a> <a id="1827" href="Amethyst.LinearAlgebra.As.Schmitty.html#1737" class="Generalizable">k</a>
<a id="1829" href="Amethyst.LinearAlgebra.As.Schmitty.html#1829" class="Bound">xs</a> <a id="1832" href="Amethyst.LinearAlgebra.As.Schmitty.html#1770" class="Function Operator">v⊡m</a> <a id="1836" href="Amethyst.LinearAlgebra.As.Schmitty.html#1836" class="Bound">yss</a> <a id="1840" class="Symbol">=</a> <a id="1842" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="1852" class="Symbol">_</a> <a id="1854" class="Symbol">(</a><a id="1855" href="Amethyst.LinearAlgebra.As.Schmitty.html#1170" class="Function Operator">_⊕_</a> <a id="1859" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1861" href="Data.Product.html#3399" class="Function">uncurry</a> <a id="1869" href="Amethyst.LinearAlgebra.As.Schmitty.html#1460" class="Function">scale</a><a id="1874" class="Symbol">)</a> <a id="1876" class="Symbol">(</a><a id="1877" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="1891" class="Symbol">(</a><a id="1892" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="1896" class="Symbol">(</a><a id="1897" href="SMT.Theories.Reals.html#3838" class="InductiveConstructor">nat</a> <a id="1901" class="Number">0</a><a id="1902" class="Symbol">)))</a> <a id="1906" class="Symbol">(</a><a id="1907" href="Data.Vec.Base.html#3858" class="Function">Vec.zip</a> <a id="1915" href="Amethyst.LinearAlgebra.As.Schmitty.html#1829" class="Bound">xs</a> <a id="1918" href="Amethyst.LinearAlgebra.As.Schmitty.html#1836" class="Bound">yss</a><a id="1921" class="Symbol">)</a>

<a id="1924" class="Comment">-- |Matrix multiplcation.</a>
<a id="_⊡_"></a><a id="1950" href="Amethyst.LinearAlgebra.As.Schmitty.html#1950" class="Function Operator">_⊡_</a> <a id="1954" class="Symbol">:</a> <a id="1956" href="Amethyst.LinearAlgebra.Base.html#122" class="Function">Mat</a> <a id="1960" class="Symbol">(</a><a id="1961" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1966" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1967" class="Symbol">)</a> <a id="1969" href="Amethyst.LinearAlgebra.As.Schmitty.html#1717" class="Generalizable">i</a> <a id="1971" href="Amethyst.LinearAlgebra.As.Schmitty.html#1727" class="Generalizable">j</a> <a id="1973" class="Symbol">→</a> <a id="1975" href="Amethyst.LinearAlgebra.Base.html#122" class="Function">Mat</a> <a id="1979" class="Symbol">(</a><a id="1980" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="1985" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="1986" class="Symbol">)</a> <a id="1988" href="Amethyst.LinearAlgebra.As.Schmitty.html#1727" class="Generalizable">j</a> <a id="1990" href="Amethyst.LinearAlgebra.As.Schmitty.html#1737" class="Generalizable">k</a> <a id="1992" class="Symbol">→</a> <a id="1994" href="Amethyst.LinearAlgebra.Base.html#122" class="Function">Mat</a> <a id="1998" class="Symbol">(</a><a id="1999" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="2004" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="2005" class="Symbol">)</a> <a id="2007" href="Amethyst.LinearAlgebra.As.Schmitty.html#1717" class="Generalizable">i</a> <a id="2009" href="Amethyst.LinearAlgebra.As.Schmitty.html#1737" class="Generalizable">k</a>
<a id="2011" href="Amethyst.LinearAlgebra.As.Schmitty.html#2011" class="Bound">xss</a> <a id="2015" href="Amethyst.LinearAlgebra.As.Schmitty.html#1950" class="Function Operator">⊡</a> <a id="2017" href="Amethyst.LinearAlgebra.As.Schmitty.html#2017" class="Bound">yss</a> <a id="2021" class="Symbol">=</a> <a id="2023" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2031" class="Symbol">(</a><a id="2032" href="Amethyst.LinearAlgebra.As.Schmitty.html#1770" class="Function Operator">_v⊡m</a> <a id="2037" href="Amethyst.LinearAlgebra.As.Schmitty.html#2017" class="Bound">yss</a><a id="2040" class="Symbol">)</a> <a id="2042" href="Amethyst.LinearAlgebra.As.Schmitty.html#2011" class="Bound">xss</a>

<a id="2047" class="Comment">-- |Matrix-vector multiplication.</a>
<a id="_m⊡v_"></a><a id="2081" href="Amethyst.LinearAlgebra.As.Schmitty.html#2081" class="Function Operator">_m⊡v_</a> <a id="2087" class="Symbol">:</a> <a id="2089" href="Amethyst.LinearAlgebra.Base.html#122" class="Function">Mat</a> <a id="2093" class="Symbol">(</a><a id="2094" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="2099" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="2100" class="Symbol">)</a> <a id="2102" href="Amethyst.LinearAlgebra.As.Schmitty.html#1717" class="Generalizable">i</a> <a id="2104" href="Amethyst.LinearAlgebra.As.Schmitty.html#1727" class="Generalizable">j</a> <a id="2106" class="Symbol">→</a> <a id="2108" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2112" class="Symbol">(</a><a id="2113" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="2118" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="2119" class="Symbol">)</a> <a id="2121" href="Amethyst.LinearAlgebra.As.Schmitty.html#1727" class="Generalizable">j</a> <a id="2123" class="Symbol">→</a> <a id="2125" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2129" class="Symbol">(</a><a id="2130" href="Amethyst.LinearAlgebra.As.Schmitty.html#674" class="Function">Real</a> <a id="2135" href="Amethyst.LinearAlgebra.As.Schmitty.html#627" class="Generalizable">Γ</a><a id="2136" class="Symbol">)</a> <a id="2138" href="Amethyst.LinearAlgebra.As.Schmitty.html#1717" class="Generalizable">i</a>
<a id="2140" href="Amethyst.LinearAlgebra.As.Schmitty.html#2140" class="Bound">xss</a> <a id="2144" href="Amethyst.LinearAlgebra.As.Schmitty.html#2081" class="Function Operator">m⊡v</a> <a id="2148" href="Amethyst.LinearAlgebra.As.Schmitty.html#2148" class="Bound">ys</a> <a id="2151" class="Symbol">=</a> <a id="2153" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2161" href="Data.Vec.Base.html#1455" class="Function">Vec.head</a> <a id="2170" class="Symbol">(</a><a id="2171" href="Amethyst.LinearAlgebra.As.Schmitty.html#2140" class="Bound">xss</a> <a id="2175" href="Amethyst.LinearAlgebra.As.Schmitty.html#1950" class="Function Operator">⊡</a> <a id="2177" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2185" href="Data.Vec.Base.html#5711" class="Function Operator">Vec.[_]</a> <a id="2193" href="Amethyst.LinearAlgebra.As.Schmitty.html#2148" class="Bound">ys</a><a id="2195" class="Symbol">)</a>
</pre></body></html>