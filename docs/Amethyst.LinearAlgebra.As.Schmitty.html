<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.LinearAlgebra.As.Schmitty</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst: Neural Network Verification in Agda</a>
<a id="131" class="Comment">--</a>
<a id="134" class="Comment">-- This module exports the basic operations for linear algebra over Schmitty</a>
<a id="211" class="Comment">-- terms.</a>
<a id="221" class="Comment">--</a>
<a id="224" class="Comment">-- Exports:</a>
<a id="236" class="Comment">--</a>
<a id="239" class="Comment">--   - Real</a>
<a id="251" class="Comment">--   - toReal</a>
<a id="265" class="Comment">--   - Reals</a>
<a id="278" class="Comment">--   - Reals∋Real</a>
<a id="296" class="Comment">--   - sum</a>
<a id="307" class="Comment">--   - _⊕_</a>
<a id="318" class="Comment">--   - _⊛_</a>
<a id="329" class="Comment">--   - _·_</a>
<a id="340" class="Comment">--   - scale</a>
<a id="353" class="Comment">--   - normalise</a>
<a id="370" class="Comment">--   - _v⊡m_</a>
<a id="383" class="Comment">--   - _⊡_</a>
<a id="394" class="Comment">--   - _m⊡v_</a>
<a id="407" class="Comment">--</a>
<a id="410" class="Comment">--------------------------------------------------------------------------------</a>
<a id="491" class="Keyword">module</a> <a id="498" href="Amethyst.LinearAlgebra.As.Schmitty.html" class="Module">Amethyst.LinearAlgebra.As.Schmitty</a> <a id="533" class="Keyword">where</a>

<a id="540" class="Keyword">open</a> <a id="545" class="Keyword">import</a> <a id="552" href="Amethyst.LinearAlgebra.Base.html" class="Module">Amethyst.LinearAlgebra.Base</a>
<a id="580" class="Keyword">open</a> <a id="585" class="Keyword">import</a> <a id="592" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="601" class="Symbol">as</a> <a id="604" class="Module">Fin</a> <a id="608" class="Keyword">using</a> <a id="614" class="Symbol">(</a><a id="615" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="618" class="Symbol">;</a> <a id="620" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a><a id="624" class="Symbol">;</a> <a id="626" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a><a id="629" class="Symbol">)</a>
<a id="631" class="Keyword">open</a> <a id="636" class="Keyword">import</a> <a id="643" href="Data.Float.html" class="Module">Data.Float</a> <a id="654" class="Symbol">as</a> <a id="657" class="Module">Float</a> <a id="663" class="Keyword">using</a> <a id="669" class="Symbol">(</a><a id="670" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="675" class="Symbol">)</a>
<a id="677" class="Keyword">open</a> <a id="682" class="Keyword">import</a> <a id="689" href="Data.List.html" class="Module">Data.List</a> <a id="699" class="Symbol">as</a> <a id="702" class="Module">List</a> <a id="707" class="Keyword">using</a> <a id="713" class="Symbol">(</a><a id="714" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="718" class="Symbol">)</a>
<a id="720" class="Keyword">open</a> <a id="725" class="Keyword">import</a> <a id="732" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="761" class="Keyword">using</a> <a id="767" class="Symbol">(</a><a id="768" href="Data.List.Relation.Unary.Any.html#1111" class="Datatype">Any</a><a id="771" class="Symbol">;</a> <a id="773" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a><a id="777" class="Symbol">;</a> <a id="779" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a><a id="784" class="Symbol">)</a>
<a id="786" class="Keyword">open</a> <a id="791" class="Keyword">import</a> <a id="798" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="807" class="Symbol">as</a> <a id="810" class="Module">Nat</a> <a id="814" class="Keyword">using</a> <a id="820" class="Symbol">(</a><a id="821" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="822" class="Symbol">;</a> <a id="824" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="828" class="Symbol">;</a> <a id="830" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="833" class="Symbol">)</a>
<a id="835" class="Keyword">open</a> <a id="840" class="Keyword">import</a> <a id="847" href="Data.Product.html" class="Module">Data.Product</a> <a id="860" class="Symbol">as</a> <a id="863" class="Module">Prod</a> <a id="868" class="Keyword">using</a> <a id="874" class="Symbol">(</a><a id="875" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="878" class="Symbol">;</a> <a id="880" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="883" class="Symbol">;</a> <a id="885" href="Data.Product.html#3422" class="Function">uncurry</a><a id="892" class="Symbol">)</a>
<a id="894" class="Keyword">open</a> <a id="899" class="Keyword">import</a> <a id="906" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="915" class="Symbol">as</a> <a id="918" class="Module">Vec</a> <a id="922" class="Keyword">using</a> <a id="928" class="Symbol">(</a><a id="929" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="932" class="Symbol">;</a> <a id="934" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="936" class="Symbol">;</a> <a id="938" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="941" class="Symbol">)</a>
<a id="943" class="Keyword">open</a> <a id="948" class="Keyword">import</a> <a id="955" href="Function.html" class="Module">Function</a> <a id="964" class="Keyword">using</a> <a id="970" class="Symbol">(</a><a id="971" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="974" class="Symbol">;</a> <a id="976" href="Function.Base.html#615" class="Function">id</a><a id="978" class="Symbol">)</a>
<a id="980" class="Keyword">open</a> <a id="985" class="Keyword">import</a> <a id="992" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1030" class="Keyword">using</a> <a id="1036" class="Symbol">(</a><a id="1037" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="1040" class="Symbol">;</a> <a id="1042" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1046" class="Symbol">)</a>
<a id="1048" class="Keyword">open</a> <a id="1053" class="Keyword">import</a> <a id="1060" href="SMT.Theories.Reals.html" class="Module">SMT.Theories.Reals</a> <a id="1079" class="Symbol">as</a> <a id="1082" class="Module">Reals</a> <a id="1088" class="Keyword">public</a>
<a id="1095" class="Keyword">open</a> <a id="1100" class="Keyword">import</a> <a id="1107" href="SMT.Script.html" class="Module">SMT.Script</a> <a id="1118" href="SMT.Theories.Reals.Reflection.html#4067" class="Function">Reals.reflectable</a> <a id="1136" class="Keyword">public</a>

<a id="1144" class="Comment">-- * Linear algebra</a>

<a id="1165" class="Keyword">private</a>
  <a id="1175" class="Keyword">variable</a>
    <a id="1188" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a> <a id="1190" class="Symbol">:</a> <a id="1192" href="SMT.Script.Base.html#2510" class="Function">Ctxt</a>
    <a id="1201" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a> <a id="1203" class="Symbol">:</a> <a id="1205" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1208" class="Comment">-- |Real-valued SMT terms.</a>
<a id="Real"></a><a id="1235" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1240" class="Symbol">:</a> <a id="1242" href="SMT.Script.Base.html#2510" class="Function">Ctxt</a> <a id="1247" class="Symbol">→</a> <a id="1249" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1253" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1258" href="Amethyst.LinearAlgebra.As.Schmitty.html#1258" class="Bound">Γ</a> <a id="1260" class="Symbol">=</a> <a id="1262" href="SMT.Script.Base.html#3252" class="Datatype">Term</a> <a id="1267" href="Amethyst.LinearAlgebra.As.Schmitty.html#1258" class="Bound">Γ</a> <a id="1269" href="SMT.Theories.Reals.Base.html#1252" class="InductiveConstructor">REAL</a>

<a id="toReal"></a><a id="1275" href="Amethyst.LinearAlgebra.As.Schmitty.html#1275" class="Function">toReal</a> <a id="1282" class="Symbol">:</a> <a id="1284" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1290" class="Symbol">→</a> <a id="1292" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1297" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a>
<a id="1299" href="Amethyst.LinearAlgebra.As.Schmitty.html#1275" class="Function">toReal</a> <a id="1306" class="Symbol">=</a> <a id="1308" href="SMT.Script.Base.html#3347" class="InductiveConstructor">`lit</a> <a id="1313" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1315" href="SMT.Theories.Reals.Base.html#3952" class="InductiveConstructor">float</a>

<a id="1322" class="Comment">-- |Typing context with only sort REAL.</a>
<a id="Reals"></a><a id="1362" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="1368" class="Symbol">:</a> <a id="1370" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1372" class="Symbol">→</a> <a id="1374" href="SMT.Script.Base.html#2510" class="Function">Ctxt</a>
<a id="1379" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="1385" href="Amethyst.LinearAlgebra.As.Schmitty.html#1385" class="Bound">inputs</a> <a id="1392" class="Symbol">=</a> <a id="1394" href="Data.List.Base.html#4852" class="Function">List.replicate</a> <a id="1409" href="Amethyst.LinearAlgebra.As.Schmitty.html#1385" class="Bound">inputs</a> <a id="1416" href="SMT.Theories.Reals.Base.html#1252" class="InductiveConstructor">REAL</a>

<a id="1422" class="Comment">-- |Turns out that all variables in a Reals have sort REAL?</a>
<a id="Reals∋Real"></a><a id="1482" href="Amethyst.LinearAlgebra.As.Schmitty.html#1482" class="Function">Reals∋Real</a> <a id="1493" class="Symbol">:</a> <a id="1495" class="Symbol">(</a><a id="1496" href="Amethyst.LinearAlgebra.As.Schmitty.html#1496" class="Bound">i</a> <a id="1498" class="Symbol">:</a> <a id="1500" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a> <a id="1504" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a><a id="1505" class="Symbol">)</a> <a id="1507" class="Symbol">→</a> <a id="1509" href="Amethyst.LinearAlgebra.As.Schmitty.html#1362" class="Function">Reals</a> <a id="1515" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a> <a id="1517" href="SMT.Script.Base.html#2733" class="Function Operator">∋</a> <a id="1519" href="SMT.Theories.Reals.Base.html#1252" class="InductiveConstructor">REAL</a>
<a id="1524" href="Amethyst.LinearAlgebra.As.Schmitty.html#1482" class="Function">Reals∋Real</a> <a id="1535" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a> <a id="1540" class="Symbol">=</a> <a id="1542" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="1547" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1552" href="Amethyst.LinearAlgebra.As.Schmitty.html#1482" class="Function">Reals∋Real</a> <a id="1563" class="Symbol">(</a><a id="1564" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a> <a id="1568" href="Amethyst.LinearAlgebra.As.Schmitty.html#1568" class="Bound">i</a><a id="1569" class="Symbol">)</a> <a id="1571" class="Symbol">=</a> <a id="1573" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a> <a id="1579" class="Symbol">(</a><a id="1580" href="Amethyst.LinearAlgebra.As.Schmitty.html#1482" class="Function">Reals∋Real</a> <a id="1591" href="Amethyst.LinearAlgebra.As.Schmitty.html#1568" class="Bound">i</a><a id="1592" class="Symbol">)</a>


<a id="1596" class="Comment">-- ** Vectors</a>

<a id="1611" class="Comment">-- |Sum.</a>
<a id="sum"></a><a id="1620" href="Amethyst.LinearAlgebra.As.Schmitty.html#1620" class="Function">sum</a> <a id="1624" class="Symbol">:</a> <a id="1626" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1630" class="Symbol">(</a><a id="1631" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1636" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="1637" class="Symbol">)</a> <a id="1639" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a> <a id="1641" class="Symbol">→</a> <a id="1643" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1648" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a>
<a id="1650" href="Amethyst.LinearAlgebra.As.Schmitty.html#1620" class="Function">sum</a> <a id="1654" class="Symbol">=</a> <a id="1656" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="1666" class="Symbol">_</a> <a id="1668" class="Symbol">(</a><a id="1669" href="SMT.Script.Base.html#3991" class="InductiveConstructor">`app₂</a> <a id="1675" href="SMT.Theories.Reals.Base.html#4676" class="InductiveConstructor">add</a><a id="1678" class="Symbol">)</a> <a id="1680" class="Symbol">(</a><a id="1681" href="SMT.Script.Base.html#3347" class="InductiveConstructor">`lit</a> <a id="1686" class="Symbol">(</a><a id="1687" href="SMT.Theories.Reals.Base.html#3925" class="InductiveConstructor">nat</a> <a id="1691" class="Number">0</a><a id="1692" class="Symbol">))</a>

<a id="1696" class="Comment">-- |Pointwise addition.</a>
<a id="_⊕_"></a><a id="1720" href="Amethyst.LinearAlgebra.As.Schmitty.html#1720" class="Function Operator">_⊕_</a> <a id="1724" class="Symbol">:</a> <a id="1726" class="Symbol">(</a><a id="1727" href="Amethyst.LinearAlgebra.As.Schmitty.html#1727" class="Bound">xs</a> <a id="1730" href="Amethyst.LinearAlgebra.As.Schmitty.html#1730" class="Bound">ys</a> <a id="1733" class="Symbol">:</a> <a id="1735" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1739" class="Symbol">(</a><a id="1740" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1745" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="1746" class="Symbol">)</a> <a id="1748" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a><a id="1749" class="Symbol">)</a> <a id="1751" class="Symbol">→</a> <a id="1753" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1757" class="Symbol">(</a><a id="1758" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1763" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="1764" class="Symbol">)</a> <a id="1766" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a>
<a id="1768" href="Amethyst.LinearAlgebra.As.Schmitty.html#1720" class="Function Operator">_⊕_</a> <a id="1772" class="Symbol">=</a> <a id="1774" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="1786" class="Symbol">(</a><a id="1787" href="SMT.Script.Base.html#3991" class="InductiveConstructor">`app₂</a> <a id="1793" href="SMT.Theories.Reals.Base.html#4676" class="InductiveConstructor">add</a><a id="1796" class="Symbol">)</a>

<a id="1799" class="Comment">-- |Pointwise multiplication.</a>
<a id="_⊛_"></a><a id="1829" href="Amethyst.LinearAlgebra.As.Schmitty.html#1829" class="Function Operator">_⊛_</a> <a id="1833" class="Symbol">:</a> <a id="1835" class="Symbol">(</a><a id="1836" href="Amethyst.LinearAlgebra.As.Schmitty.html#1836" class="Bound">xs</a> <a id="1839" href="Amethyst.LinearAlgebra.As.Schmitty.html#1839" class="Bound">ys</a> <a id="1842" class="Symbol">:</a> <a id="1844" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1848" class="Symbol">(</a><a id="1849" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1854" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="1855" class="Symbol">)</a> <a id="1857" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a><a id="1858" class="Symbol">)</a> <a id="1860" class="Symbol">→</a> <a id="1862" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1866" class="Symbol">(</a><a id="1867" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1872" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="1873" class="Symbol">)</a> <a id="1875" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a>
<a id="1877" href="Amethyst.LinearAlgebra.As.Schmitty.html#1829" class="Function Operator">_⊛_</a> <a id="1881" class="Symbol">=</a> <a id="1883" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="1895" class="Symbol">(</a><a id="1896" href="SMT.Script.Base.html#3991" class="InductiveConstructor">`app₂</a> <a id="1902" href="SMT.Theories.Reals.Base.html#4707" class="InductiveConstructor">mul</a><a id="1905" class="Symbol">)</a>

<a id="1908" class="Comment">-- |Dot product.</a>
<a id="_·_"></a><a id="1925" href="Amethyst.LinearAlgebra.As.Schmitty.html#1925" class="Function Operator">_·_</a> <a id="1929" class="Symbol">:</a> <a id="1931" class="Symbol">(</a><a id="1932" href="Amethyst.LinearAlgebra.As.Schmitty.html#1932" class="Bound">xs</a> <a id="1935" href="Amethyst.LinearAlgebra.As.Schmitty.html#1935" class="Bound">ys</a> <a id="1938" class="Symbol">:</a> <a id="1940" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1944" class="Symbol">(</a><a id="1945" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1950" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="1951" class="Symbol">)</a> <a id="1953" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a><a id="1954" class="Symbol">)</a> <a id="1956" class="Symbol">→</a> <a id="1958" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="1963" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a>
<a id="1965" href="Amethyst.LinearAlgebra.As.Schmitty.html#1925" class="Function Operator">_·_</a> <a id="1969" href="Amethyst.LinearAlgebra.As.Schmitty.html#1969" class="Bound">xs</a> <a id="1972" href="Amethyst.LinearAlgebra.As.Schmitty.html#1972" class="Bound">ys</a> <a id="1975" class="Symbol">=</a> <a id="1977" href="Amethyst.LinearAlgebra.As.Schmitty.html#1620" class="Function">sum</a> <a id="1981" class="Symbol">(</a><a id="1982" href="Amethyst.LinearAlgebra.As.Schmitty.html#1969" class="Bound">xs</a> <a id="1985" href="Amethyst.LinearAlgebra.As.Schmitty.html#1720" class="Function Operator">⊕</a> <a id="1987" href="Amethyst.LinearAlgebra.As.Schmitty.html#1972" class="Bound">ys</a><a id="1989" class="Symbol">)</a>

<a id="1992" class="Comment">-- |Vector scaling.</a>
<a id="scale"></a><a id="2012" href="Amethyst.LinearAlgebra.As.Schmitty.html#2012" class="Function">scale</a> <a id="2018" class="Symbol">:</a> <a id="2020" class="Symbol">(</a><a id="2021" href="Amethyst.LinearAlgebra.As.Schmitty.html#2021" class="Bound">x</a> <a id="2023" class="Symbol">:</a> <a id="2025" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2030" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2031" class="Symbol">)</a> <a id="2033" class="Symbol">(</a><a id="2034" href="Amethyst.LinearAlgebra.As.Schmitty.html#2034" class="Bound">ys</a> <a id="2037" class="Symbol">:</a> <a id="2039" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2043" class="Symbol">(</a><a id="2044" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2049" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2050" class="Symbol">)</a> <a id="2052" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a><a id="2053" class="Symbol">)</a> <a id="2055" class="Symbol">→</a> <a id="2057" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2061" class="Symbol">(</a><a id="2062" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2067" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2068" class="Symbol">)</a> <a id="2070" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a>
<a id="2072" href="Amethyst.LinearAlgebra.As.Schmitty.html#2012" class="Function">scale</a> <a id="2078" href="Amethyst.LinearAlgebra.As.Schmitty.html#2078" class="Bound">x</a> <a id="2080" class="Symbol">=</a> <a id="2082" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2090" class="Symbol">(</a><a id="2091" href="SMT.Script.Base.html#3991" class="InductiveConstructor">`app₂</a> <a id="2097" href="SMT.Theories.Reals.Base.html#4707" class="InductiveConstructor">mul</a> <a id="2101" href="Amethyst.LinearAlgebra.As.Schmitty.html#2078" class="Bound">x</a><a id="2102" class="Symbol">)</a>

<a id="2105" class="Comment">-- |Vector normalisation.</a>
<a id="normalise"></a><a id="2131" href="Amethyst.LinearAlgebra.As.Schmitty.html#2131" class="Function">normalise</a> <a id="2141" class="Symbol">:</a> <a id="2143" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2147" class="Symbol">(</a><a id="2148" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2153" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2154" class="Symbol">)</a> <a id="2156" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a> <a id="2158" class="Symbol">→</a> <a id="2160" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2164" class="Symbol">(</a><a id="2165" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2170" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2171" class="Symbol">)</a> <a id="2173" href="Amethyst.LinearAlgebra.As.Schmitty.html#1201" class="Generalizable">n</a>
<a id="2175" href="Amethyst.LinearAlgebra.As.Schmitty.html#2131" class="Function">normalise</a> <a id="2185" href="Amethyst.LinearAlgebra.As.Schmitty.html#2185" class="Bound">xs</a> <a id="2188" class="Symbol">=</a> <a id="2190" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2198" class="Symbol">(λ</a> <a id="2201" href="Amethyst.LinearAlgebra.As.Schmitty.html#2201" class="Bound">x</a> <a id="2203" class="Symbol">→</a> <a id="2205" href="SMT.Script.Base.html#3991" class="InductiveConstructor">`app₂</a> <a id="2211" href="SMT.Theories.Reals.Base.html#4738" class="InductiveConstructor">div</a> <a id="2215" href="Amethyst.LinearAlgebra.As.Schmitty.html#2201" class="Bound">x</a> <a id="2217" class="Symbol">(</a><a id="2218" href="Amethyst.LinearAlgebra.As.Schmitty.html#1620" class="Function">sum</a> <a id="2222" href="Amethyst.LinearAlgebra.As.Schmitty.html#2185" class="Bound">xs</a><a id="2224" class="Symbol">))</a> <a id="2227" href="Amethyst.LinearAlgebra.As.Schmitty.html#2185" class="Bound">xs</a>


<a id="2232" class="Comment">-- ** Matrices</a>

<a id="2248" class="Keyword">private</a>
  <a id="2258" class="Keyword">variable</a>
    <a id="2271" href="Amethyst.LinearAlgebra.As.Schmitty.html#2271" class="Generalizable">i</a> <a id="2273" class="Symbol">:</a> <a id="2275" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2281" href="Amethyst.LinearAlgebra.As.Schmitty.html#2281" class="Generalizable">j</a> <a id="2283" class="Symbol">:</a> <a id="2285" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2291" href="Amethyst.LinearAlgebra.As.Schmitty.html#2291" class="Generalizable">k</a> <a id="2293" class="Symbol">:</a> <a id="2295" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2301" href="Amethyst.LinearAlgebra.As.Schmitty.html#2301" class="Generalizable">rows</a> <a id="2306" class="Symbol">:</a> <a id="2308" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2314" href="Amethyst.LinearAlgebra.As.Schmitty.html#2314" class="Generalizable">cols</a> <a id="2319" class="Symbol">:</a> <a id="2321" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="_v⊡m_"></a><a id="2324" href="Amethyst.LinearAlgebra.As.Schmitty.html#2324" class="Function Operator">_v⊡m_</a> <a id="2330" class="Symbol">:</a> <a id="2332" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2336" class="Symbol">(</a><a id="2337" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2342" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2343" class="Symbol">)</a> <a id="2345" href="Amethyst.LinearAlgebra.As.Schmitty.html#2281" class="Generalizable">j</a> <a id="2347" class="Symbol">→</a> <a id="2349" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2353" class="Symbol">(</a><a id="2354" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2359" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2360" class="Symbol">)</a> <a id="2362" href="Amethyst.LinearAlgebra.As.Schmitty.html#2281" class="Generalizable">j</a> <a id="2364" href="Amethyst.LinearAlgebra.As.Schmitty.html#2291" class="Generalizable">k</a> <a id="2366" class="Symbol">→</a> <a id="2368" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2372" class="Symbol">(</a><a id="2373" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2378" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2379" class="Symbol">)</a> <a id="2381" href="Amethyst.LinearAlgebra.As.Schmitty.html#2291" class="Generalizable">k</a>
<a id="2383" href="Amethyst.LinearAlgebra.As.Schmitty.html#2383" class="Bound">xs</a> <a id="2386" href="Amethyst.LinearAlgebra.As.Schmitty.html#2324" class="Function Operator">v⊡m</a> <a id="2390" href="Amethyst.LinearAlgebra.As.Schmitty.html#2390" class="Bound">yss</a> <a id="2394" class="Symbol">=</a> <a id="2396" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="2406" class="Symbol">_</a> <a id="2408" class="Symbol">(</a><a id="2409" href="Amethyst.LinearAlgebra.As.Schmitty.html#1720" class="Function Operator">_⊕_</a> <a id="2413" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2415" href="Data.Product.html#3422" class="Function">uncurry</a> <a id="2423" href="Amethyst.LinearAlgebra.As.Schmitty.html#2012" class="Function">scale</a><a id="2428" class="Symbol">)</a> <a id="2430" class="Symbol">(</a><a id="2431" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="2445" class="Symbol">(</a><a id="2446" href="SMT.Script.Base.html#3347" class="InductiveConstructor">`lit</a> <a id="2451" class="Symbol">(</a><a id="2452" href="SMT.Theories.Reals.Base.html#3925" class="InductiveConstructor">nat</a> <a id="2456" class="Number">0</a><a id="2457" class="Symbol">)))</a> <a id="2461" class="Symbol">(</a><a id="2462" href="Data.Vec.Base.html#3858" class="Function">Vec.zip</a> <a id="2470" href="Amethyst.LinearAlgebra.As.Schmitty.html#2383" class="Bound">xs</a> <a id="2473" href="Amethyst.LinearAlgebra.As.Schmitty.html#2390" class="Bound">yss</a><a id="2476" class="Symbol">)</a>

<a id="2479" class="Comment">-- |Matrix multiplcation.</a>
<a id="_⊡_"></a><a id="2505" href="Amethyst.LinearAlgebra.As.Schmitty.html#2505" class="Function Operator">_⊡_</a> <a id="2509" class="Symbol">:</a> <a id="2511" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2515" class="Symbol">(</a><a id="2516" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2521" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2522" class="Symbol">)</a> <a id="2524" href="Amethyst.LinearAlgebra.As.Schmitty.html#2271" class="Generalizable">i</a> <a id="2526" href="Amethyst.LinearAlgebra.As.Schmitty.html#2281" class="Generalizable">j</a> <a id="2528" class="Symbol">→</a> <a id="2530" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2534" class="Symbol">(</a><a id="2535" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2540" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2541" class="Symbol">)</a> <a id="2543" href="Amethyst.LinearAlgebra.As.Schmitty.html#2281" class="Generalizable">j</a> <a id="2545" href="Amethyst.LinearAlgebra.As.Schmitty.html#2291" class="Generalizable">k</a> <a id="2547" class="Symbol">→</a> <a id="2549" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2553" class="Symbol">(</a><a id="2554" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2559" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2560" class="Symbol">)</a> <a id="2562" href="Amethyst.LinearAlgebra.As.Schmitty.html#2271" class="Generalizable">i</a> <a id="2564" href="Amethyst.LinearAlgebra.As.Schmitty.html#2291" class="Generalizable">k</a>
<a id="2566" href="Amethyst.LinearAlgebra.As.Schmitty.html#2566" class="Bound">xss</a> <a id="2570" href="Amethyst.LinearAlgebra.As.Schmitty.html#2505" class="Function Operator">⊡</a> <a id="2572" href="Amethyst.LinearAlgebra.As.Schmitty.html#2572" class="Bound">yss</a> <a id="2576" class="Symbol">=</a> <a id="2578" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2586" class="Symbol">(</a><a id="2587" href="Amethyst.LinearAlgebra.As.Schmitty.html#2324" class="Function Operator">_v⊡m</a> <a id="2592" href="Amethyst.LinearAlgebra.As.Schmitty.html#2572" class="Bound">yss</a><a id="2595" class="Symbol">)</a> <a id="2597" href="Amethyst.LinearAlgebra.As.Schmitty.html#2566" class="Bound">xss</a>

<a id="2602" class="Comment">-- |Matrix-vector multiplication.</a>
<a id="_m⊡v_"></a><a id="2636" href="Amethyst.LinearAlgebra.As.Schmitty.html#2636" class="Function Operator">_m⊡v_</a> <a id="2642" class="Symbol">:</a> <a id="2644" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2648" class="Symbol">(</a><a id="2649" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2654" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2655" class="Symbol">)</a> <a id="2657" href="Amethyst.LinearAlgebra.As.Schmitty.html#2271" class="Generalizable">i</a> <a id="2659" href="Amethyst.LinearAlgebra.As.Schmitty.html#2281" class="Generalizable">j</a> <a id="2661" class="Symbol">→</a> <a id="2663" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2667" class="Symbol">(</a><a id="2668" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2673" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2674" class="Symbol">)</a> <a id="2676" href="Amethyst.LinearAlgebra.As.Schmitty.html#2281" class="Generalizable">j</a> <a id="2678" class="Symbol">→</a> <a id="2680" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2684" class="Symbol">(</a><a id="2685" href="Amethyst.LinearAlgebra.As.Schmitty.html#1235" class="Function">Real</a> <a id="2690" href="Amethyst.LinearAlgebra.As.Schmitty.html#1188" class="Generalizable">Γ</a><a id="2691" class="Symbol">)</a> <a id="2693" href="Amethyst.LinearAlgebra.As.Schmitty.html#2271" class="Generalizable">i</a>
<a id="2695" href="Amethyst.LinearAlgebra.As.Schmitty.html#2695" class="Bound">xss</a> <a id="2699" href="Amethyst.LinearAlgebra.As.Schmitty.html#2636" class="Function Operator">m⊡v</a> <a id="2703" href="Amethyst.LinearAlgebra.As.Schmitty.html#2703" class="Bound">ys</a> <a id="2706" class="Symbol">=</a> <a id="2708" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2716" href="Data.Vec.Base.html#1455" class="Function">Vec.head</a> <a id="2725" class="Symbol">(</a><a id="2726" href="Amethyst.LinearAlgebra.As.Schmitty.html#2695" class="Bound">xss</a> <a id="2730" href="Amethyst.LinearAlgebra.As.Schmitty.html#2505" class="Function Operator">⊡</a> <a id="2732" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2740" href="Data.Vec.Base.html#5711" class="Function Operator">Vec.[_]</a> <a id="2748" href="Amethyst.LinearAlgebra.As.Schmitty.html#2703" class="Bound">ys</a><a id="2750" class="Symbol">)</a>
</pre></body></html>