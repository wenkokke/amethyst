<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.LinearAlgebra.As.Schmitty</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst: Neural Network Verification in Agda</a>
<a id="131" class="Comment">--</a>
<a id="134" class="Comment">-- This module exports the basic operations for linear algebra over Schmitty</a>
<a id="211" class="Comment">-- terms.</a>
<a id="221" class="Comment">--</a>
<a id="224" class="Comment">-- Exports:</a>
<a id="236" class="Comment">--</a>
<a id="239" class="Comment">--   - Real</a>
<a id="251" class="Comment">--   - toReal</a>
<a id="265" class="Comment">--   - Reals</a>
<a id="278" class="Comment">--   - Reals∋Real</a>
<a id="296" class="Comment">--   - sum</a>
<a id="307" class="Comment">--   - _⊕_</a>
<a id="318" class="Comment">--   - _⊛_</a>
<a id="329" class="Comment">--   - _·_</a>
<a id="340" class="Comment">--   - scale</a>
<a id="353" class="Comment">--   - normalise</a>
<a id="370" class="Comment">--   - _v⊡m_</a>
<a id="383" class="Comment">--   - _⊡_</a>
<a id="394" class="Comment">--   - _m⊡v_</a>
<a id="407" class="Comment">--</a>
<a id="410" class="Comment">--------------------------------------------------------------------------------</a>
<a id="491" class="Keyword">module</a> <a id="498" href="Amethyst.LinearAlgebra.As.Schmitty.html" class="Module">Amethyst.LinearAlgebra.As.Schmitty</a> <a id="533" class="Keyword">where</a>

<a id="540" class="Keyword">open</a> <a id="545" class="Keyword">import</a> <a id="552" href="Amethyst.LinearAlgebra.Base.html" class="Module">Amethyst.LinearAlgebra.Base</a>
<a id="580" class="Keyword">open</a> <a id="585" class="Keyword">import</a> <a id="592" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="601" class="Symbol">as</a> <a id="604" class="Module">Fin</a> <a id="608" class="Keyword">using</a> <a id="614" class="Symbol">(</a><a id="615" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="618" class="Symbol">;</a> <a id="620" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a><a id="624" class="Symbol">;</a> <a id="626" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a><a id="629" class="Symbol">)</a>
<a id="631" class="Keyword">open</a> <a id="636" class="Keyword">import</a> <a id="643" href="Data.Float.html" class="Module">Data.Float</a> <a id="654" class="Symbol">as</a> <a id="657" class="Module">Float</a> <a id="663" class="Keyword">using</a> <a id="669" class="Symbol">(</a><a id="670" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="675" class="Symbol">)</a>
<a id="677" class="Keyword">open</a> <a id="682" class="Keyword">import</a> <a id="689" href="Data.List.html" class="Module">Data.List</a> <a id="699" class="Symbol">as</a> <a id="702" class="Module">List</a> <a id="707" class="Keyword">using</a> <a id="713" class="Symbol">(</a><a id="714" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="718" class="Symbol">)</a>
<a id="720" class="Keyword">open</a> <a id="725" class="Keyword">import</a> <a id="732" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="741" class="Symbol">as</a> <a id="744" class="Module">Nat</a> <a id="748" class="Keyword">using</a> <a id="754" class="Symbol">(</a><a id="755" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="756" class="Symbol">;</a> <a id="758" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="762" class="Symbol">;</a> <a id="764" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="767" class="Symbol">)</a>
<a id="769" class="Keyword">open</a> <a id="774" class="Keyword">import</a> <a id="781" href="Data.Product.html" class="Module">Data.Product</a> <a id="794" class="Symbol">as</a> <a id="797" class="Module">Prod</a> <a id="802" class="Keyword">using</a> <a id="808" class="Symbol">(</a><a id="809" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="812" class="Symbol">;</a> <a id="814" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="817" class="Symbol">;</a> <a id="819" href="Data.Product.html#3386" class="Function">uncurry</a><a id="826" class="Symbol">)</a>
<a id="828" class="Keyword">open</a> <a id="833" class="Keyword">import</a> <a id="840" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="849" class="Symbol">as</a> <a id="852" class="Module">Vec</a> <a id="856" class="Keyword">using</a> <a id="862" class="Symbol">(</a><a id="863" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="866" class="Symbol">;</a> <a id="868" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="870" class="Symbol">;</a> <a id="872" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="875" class="Symbol">)</a>
<a id="877" class="Keyword">open</a> <a id="882" class="Keyword">import</a> <a id="889" href="Function.html" class="Module">Function</a> <a id="898" class="Keyword">using</a> <a id="904" class="Symbol">(</a><a id="905" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="908" class="Symbol">;</a> <a id="910" href="Function.Base.html#615" class="Function">id</a><a id="912" class="Symbol">)</a>
<a id="914" class="Keyword">open</a> <a id="919" class="Keyword">import</a> <a id="926" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="964" class="Keyword">using</a> <a id="970" class="Symbol">(</a><a id="971" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="974" class="Symbol">;</a> <a id="976" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="980" class="Symbol">)</a>
<a id="982" class="Keyword">open</a> <a id="987" class="Keyword">import</a> <a id="994" href="SMT.Theories.Reals.html" class="Module">SMT.Theories.Reals</a> <a id="1013" class="Symbol">as</a> <a id="1016" class="Module">Reals</a> <a id="1022" class="Keyword">public</a>
<a id="1029" class="Keyword">open</a> <a id="1034" class="Keyword">import</a> <a id="1041" href="SMT.Script.html" class="Module">SMT.Script</a> <a id="1052" href="SMT.Theories.Reals.Reflection.html#3771" class="Function">Reals.reflectable</a> <a id="1070" class="Keyword">public</a>

<a id="1078" class="Comment">-- * Linear algebra</a>

<a id="1099" class="Keyword">private</a>
  <a id="1109" class="Keyword">variable</a>
    <a id="1122" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a> <a id="1124" class="Symbol">:</a> <a id="1126" href="SMT.Script.Base.html#1088" class="Function">Ctxt</a>
    <a id="1135" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a> <a id="1137" class="Symbol">:</a> <a id="1139" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1142" class="Comment">-- |Real-valued SMT terms.</a>
<a id="Real"></a><a id="1169" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1174" class="Symbol">:</a> <a id="1176" href="SMT.Script.Base.html#1088" class="Function">Ctxt</a> <a id="1181" class="Symbol">→</a> <a id="1183" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1187" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1192" href="Amethyst.LinearAlgebra.As.Schmitty.html#1192" class="Bound">Γ</a> <a id="1194" class="Symbol">=</a> <a id="1196" href="SMT.Script.Base.html#1534" class="Datatype">Term</a> <a id="1201" href="Amethyst.LinearAlgebra.As.Schmitty.html#1192" class="Bound">Γ</a> <a id="1203" href="SMT.Theories.Reals.Base.html#978" class="InductiveConstructor">REAL</a>

<a id="toReal"></a><a id="1209" href="Amethyst.LinearAlgebra.As.Schmitty.html#1209" class="Function">toReal</a> <a id="1216" class="Symbol">:</a> <a id="1218" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1224" class="Symbol">→</a> <a id="1226" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1231" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a>
<a id="1233" href="Amethyst.LinearAlgebra.As.Schmitty.html#1209" class="Function">toReal</a> <a id="1240" class="Symbol">=</a> <a id="1242" href="SMT.Script.Base.html#1621" class="InductiveConstructor">lit</a> <a id="1246" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1248" href="SMT.Theories.Reals.Base.html#3678" class="InductiveConstructor">float</a>

<a id="1255" class="Comment">-- |Typing context with only sort REAL.</a>
<a id="Reals"></a><a id="1295" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="1301" class="Symbol">:</a> <a id="1303" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1305" class="Symbol">→</a> <a id="1307" href="SMT.Script.Base.html#1088" class="Function">Ctxt</a>
<a id="1312" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="1318" href="Amethyst.LinearAlgebra.As.Schmitty.html#1318" class="Bound">inputs</a> <a id="1325" class="Symbol">=</a> <a id="1327" href="Data.List.Base.html#4852" class="Function">List.replicate</a> <a id="1342" href="Amethyst.LinearAlgebra.As.Schmitty.html#1318" class="Bound">inputs</a> <a id="1349" href="SMT.Theories.Reals.Base.html#978" class="InductiveConstructor">REAL</a>

<a id="1355" class="Comment">-- |Turns out that all variables in a Reals have sort REAL?</a>
<a id="Reals∋Real"></a><a id="1415" href="Amethyst.LinearAlgebra.As.Schmitty.html#1415" class="Function">Reals∋Real</a> <a id="1426" class="Symbol">:</a> <a id="1428" class="Symbol">(</a><a id="1429" href="Amethyst.LinearAlgebra.As.Schmitty.html#1429" class="Bound">i</a> <a id="1431" class="Symbol">:</a> <a id="1433" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a> <a id="1437" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a><a id="1438" class="Symbol">)</a> <a id="1440" class="Symbol">→</a> <a id="1442" href="Amethyst.LinearAlgebra.As.Schmitty.html#1295" class="Function">Reals</a> <a id="1448" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a> <a id="1450" href="SMT.Script.Base.html#1311" class="Function Operator">∋</a> <a id="1452" href="SMT.Theories.Reals.Base.html#978" class="InductiveConstructor">REAL</a>
<a id="1457" href="Amethyst.LinearAlgebra.As.Schmitty.html#1415" class="Function">Reals∋Real</a> <a id="1468" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a> <a id="1473" class="Symbol">=</a> <a id="1475" class="Symbol">(</a><a id="1476" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a> <a id="1481" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1483" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1487" class="Symbol">)</a>
<a id="1489" href="Amethyst.LinearAlgebra.As.Schmitty.html#1415" class="Function">Reals∋Real</a> <a id="1500" class="Symbol">(</a><a id="1501" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a> <a id="1505" href="Amethyst.LinearAlgebra.As.Schmitty.html#1505" class="Bound">i</a><a id="1506" class="Symbol">)</a> <a id="1508" class="Symbol">=</a> <a id="1510" href="Data.Product.html#2450" class="Function">Prod.map</a> <a id="1519" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a> <a id="1523" href="Function.Base.html#615" class="Function">id</a> <a id="1526" class="Symbol">(</a><a id="1527" href="Amethyst.LinearAlgebra.As.Schmitty.html#1415" class="Function">Reals∋Real</a> <a id="1538" href="Amethyst.LinearAlgebra.As.Schmitty.html#1505" class="Bound">i</a><a id="1539" class="Symbol">)</a>


<a id="1543" class="Comment">-- ** Vectors</a>

<a id="1558" class="Comment">-- |Sum.</a>
<a id="sum"></a><a id="1567" href="Amethyst.LinearAlgebra.As.Schmitty.html#1567" class="Function">sum</a> <a id="1571" class="Symbol">:</a> <a id="1573" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1577" class="Symbol">(</a><a id="1578" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1583" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="1584" class="Symbol">)</a> <a id="1586" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a> <a id="1588" class="Symbol">→</a> <a id="1590" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1595" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a>
<a id="1597" href="Amethyst.LinearAlgebra.As.Schmitty.html#1567" class="Function">sum</a> <a id="1601" class="Symbol">=</a> <a id="1603" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="1613" class="Symbol">_</a> <a id="1615" class="Symbol">(</a><a id="1616" href="SMT.Script.Base.html#2141" class="InductiveConstructor">app₂</a> <a id="1621" href="SMT.Theories.Reals.Base.html#4402" class="InductiveConstructor">add</a><a id="1624" class="Symbol">)</a> <a id="1626" class="Symbol">(</a><a id="1627" href="SMT.Script.Base.html#1621" class="InductiveConstructor">lit</a> <a id="1631" class="Symbol">(</a><a id="1632" href="SMT.Theories.Reals.Base.html#3651" class="InductiveConstructor">nat</a> <a id="1636" class="Number">0</a><a id="1637" class="Symbol">))</a>

<a id="1641" class="Comment">-- |Pointwise addition.</a>
<a id="_⊕_"></a><a id="1665" href="Amethyst.LinearAlgebra.As.Schmitty.html#1665" class="Function Operator">_⊕_</a> <a id="1669" class="Symbol">:</a> <a id="1671" class="Symbol">(</a><a id="1672" href="Amethyst.LinearAlgebra.As.Schmitty.html#1672" class="Bound">xs</a> <a id="1675" href="Amethyst.LinearAlgebra.As.Schmitty.html#1675" class="Bound">ys</a> <a id="1678" class="Symbol">:</a> <a id="1680" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1684" class="Symbol">(</a><a id="1685" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1690" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="1691" class="Symbol">)</a> <a id="1693" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a><a id="1694" class="Symbol">)</a> <a id="1696" class="Symbol">→</a> <a id="1698" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1702" class="Symbol">(</a><a id="1703" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1708" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="1709" class="Symbol">)</a> <a id="1711" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a>
<a id="1713" href="Amethyst.LinearAlgebra.As.Schmitty.html#1665" class="Function Operator">_⊕_</a> <a id="1717" class="Symbol">=</a> <a id="1719" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="1731" class="Symbol">(</a><a id="1732" href="SMT.Script.Base.html#2141" class="InductiveConstructor">app₂</a> <a id="1737" href="SMT.Theories.Reals.Base.html#4402" class="InductiveConstructor">add</a><a id="1740" class="Symbol">)</a>

<a id="1743" class="Comment">-- |Pointwise multiplication.</a>
<a id="_⊛_"></a><a id="1773" href="Amethyst.LinearAlgebra.As.Schmitty.html#1773" class="Function Operator">_⊛_</a> <a id="1777" class="Symbol">:</a> <a id="1779" class="Symbol">(</a><a id="1780" href="Amethyst.LinearAlgebra.As.Schmitty.html#1780" class="Bound">xs</a> <a id="1783" href="Amethyst.LinearAlgebra.As.Schmitty.html#1783" class="Bound">ys</a> <a id="1786" class="Symbol">:</a> <a id="1788" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1792" class="Symbol">(</a><a id="1793" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1798" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="1799" class="Symbol">)</a> <a id="1801" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a><a id="1802" class="Symbol">)</a> <a id="1804" class="Symbol">→</a> <a id="1806" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1810" class="Symbol">(</a><a id="1811" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1816" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="1817" class="Symbol">)</a> <a id="1819" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a>
<a id="1821" href="Amethyst.LinearAlgebra.As.Schmitty.html#1773" class="Function Operator">_⊛_</a> <a id="1825" class="Symbol">=</a> <a id="1827" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="1839" class="Symbol">(</a><a id="1840" href="SMT.Script.Base.html#2141" class="InductiveConstructor">app₂</a> <a id="1845" href="SMT.Theories.Reals.Base.html#4433" class="InductiveConstructor">mul</a><a id="1848" class="Symbol">)</a>

<a id="1851" class="Comment">-- |Dot product.</a>
<a id="_·_"></a><a id="1868" href="Amethyst.LinearAlgebra.As.Schmitty.html#1868" class="Function Operator">_·_</a> <a id="1872" class="Symbol">:</a> <a id="1874" class="Symbol">(</a><a id="1875" href="Amethyst.LinearAlgebra.As.Schmitty.html#1875" class="Bound">xs</a> <a id="1878" href="Amethyst.LinearAlgebra.As.Schmitty.html#1878" class="Bound">ys</a> <a id="1881" class="Symbol">:</a> <a id="1883" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1887" class="Symbol">(</a><a id="1888" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1893" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="1894" class="Symbol">)</a> <a id="1896" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a><a id="1897" class="Symbol">)</a> <a id="1899" class="Symbol">→</a> <a id="1901" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1906" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a>
<a id="1908" href="Amethyst.LinearAlgebra.As.Schmitty.html#1868" class="Function Operator">_·_</a> <a id="1912" href="Amethyst.LinearAlgebra.As.Schmitty.html#1912" class="Bound">xs</a> <a id="1915" href="Amethyst.LinearAlgebra.As.Schmitty.html#1915" class="Bound">ys</a> <a id="1918" class="Symbol">=</a> <a id="1920" href="Amethyst.LinearAlgebra.As.Schmitty.html#1567" class="Function">sum</a> <a id="1924" class="Symbol">(</a><a id="1925" href="Amethyst.LinearAlgebra.As.Schmitty.html#1912" class="Bound">xs</a> <a id="1928" href="Amethyst.LinearAlgebra.As.Schmitty.html#1665" class="Function Operator">⊕</a> <a id="1930" href="Amethyst.LinearAlgebra.As.Schmitty.html#1915" class="Bound">ys</a><a id="1932" class="Symbol">)</a>

<a id="1935" class="Comment">-- |Vector scaling.</a>
<a id="scale"></a><a id="1955" href="Amethyst.LinearAlgebra.As.Schmitty.html#1955" class="Function">scale</a> <a id="1961" class="Symbol">:</a> <a id="1963" class="Symbol">(</a><a id="1964" href="Amethyst.LinearAlgebra.As.Schmitty.html#1964" class="Bound">x</a> <a id="1966" class="Symbol">:</a> <a id="1968" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1973" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="1974" class="Symbol">)</a> <a id="1976" class="Symbol">(</a><a id="1977" href="Amethyst.LinearAlgebra.As.Schmitty.html#1977" class="Bound">ys</a> <a id="1980" class="Symbol">:</a> <a id="1982" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1986" class="Symbol">(</a><a id="1987" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="1992" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="1993" class="Symbol">)</a> <a id="1995" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a><a id="1996" class="Symbol">)</a> <a id="1998" class="Symbol">→</a> <a id="2000" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2004" class="Symbol">(</a><a id="2005" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2010" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2011" class="Symbol">)</a> <a id="2013" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a>
<a id="2015" href="Amethyst.LinearAlgebra.As.Schmitty.html#1955" class="Function">scale</a> <a id="2021" href="Amethyst.LinearAlgebra.As.Schmitty.html#2021" class="Bound">x</a> <a id="2023" class="Symbol">=</a> <a id="2025" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2033" class="Symbol">(</a><a id="2034" href="SMT.Script.Base.html#2141" class="InductiveConstructor">app₂</a> <a id="2039" href="SMT.Theories.Reals.Base.html#4433" class="InductiveConstructor">mul</a> <a id="2043" href="Amethyst.LinearAlgebra.As.Schmitty.html#2021" class="Bound">x</a><a id="2044" class="Symbol">)</a>

<a id="2047" class="Comment">-- |Vector normalisation.</a>
<a id="normalise"></a><a id="2073" href="Amethyst.LinearAlgebra.As.Schmitty.html#2073" class="Function">normalise</a> <a id="2083" class="Symbol">:</a> <a id="2085" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2089" class="Symbol">(</a><a id="2090" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2095" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2096" class="Symbol">)</a> <a id="2098" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a> <a id="2100" class="Symbol">→</a> <a id="2102" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2106" class="Symbol">(</a><a id="2107" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2112" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2113" class="Symbol">)</a> <a id="2115" href="Amethyst.LinearAlgebra.As.Schmitty.html#1135" class="Generalizable">n</a>
<a id="2117" href="Amethyst.LinearAlgebra.As.Schmitty.html#2073" class="Function">normalise</a> <a id="2127" href="Amethyst.LinearAlgebra.As.Schmitty.html#2127" class="Bound">xs</a> <a id="2130" class="Symbol">=</a> <a id="2132" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2140" class="Symbol">(λ</a> <a id="2143" href="Amethyst.LinearAlgebra.As.Schmitty.html#2143" class="Bound">x</a> <a id="2145" class="Symbol">→</a> <a id="2147" href="SMT.Script.Base.html#2141" class="InductiveConstructor">app₂</a> <a id="2152" href="SMT.Theories.Reals.Base.html#4464" class="InductiveConstructor">div</a> <a id="2156" href="Amethyst.LinearAlgebra.As.Schmitty.html#2143" class="Bound">x</a> <a id="2158" class="Symbol">(</a><a id="2159" href="Amethyst.LinearAlgebra.As.Schmitty.html#1567" class="Function">sum</a> <a id="2163" href="Amethyst.LinearAlgebra.As.Schmitty.html#2127" class="Bound">xs</a><a id="2165" class="Symbol">))</a> <a id="2168" href="Amethyst.LinearAlgebra.As.Schmitty.html#2127" class="Bound">xs</a>


<a id="2173" class="Comment">-- ** Matrices</a>

<a id="2189" class="Keyword">private</a>
  <a id="2199" class="Keyword">variable</a>
    <a id="2212" href="Amethyst.LinearAlgebra.As.Schmitty.html#2212" class="Generalizable">i</a> <a id="2214" class="Symbol">:</a> <a id="2216" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2222" href="Amethyst.LinearAlgebra.As.Schmitty.html#2222" class="Generalizable">j</a> <a id="2224" class="Symbol">:</a> <a id="2226" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2232" href="Amethyst.LinearAlgebra.As.Schmitty.html#2232" class="Generalizable">k</a> <a id="2234" class="Symbol">:</a> <a id="2236" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2242" href="Amethyst.LinearAlgebra.As.Schmitty.html#2242" class="Generalizable">rows</a> <a id="2247" class="Symbol">:</a> <a id="2249" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2255" href="Amethyst.LinearAlgebra.As.Schmitty.html#2255" class="Generalizable">cols</a> <a id="2260" class="Symbol">:</a> <a id="2262" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="_v⊡m_"></a><a id="2265" href="Amethyst.LinearAlgebra.As.Schmitty.html#2265" class="Function Operator">_v⊡m_</a> <a id="2271" class="Symbol">:</a> <a id="2273" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2277" class="Symbol">(</a><a id="2278" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2283" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2284" class="Symbol">)</a> <a id="2286" href="Amethyst.LinearAlgebra.As.Schmitty.html#2222" class="Generalizable">j</a> <a id="2288" class="Symbol">→</a> <a id="2290" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2294" class="Symbol">(</a><a id="2295" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2300" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2301" class="Symbol">)</a> <a id="2303" href="Amethyst.LinearAlgebra.As.Schmitty.html#2222" class="Generalizable">j</a> <a id="2305" href="Amethyst.LinearAlgebra.As.Schmitty.html#2232" class="Generalizable">k</a> <a id="2307" class="Symbol">→</a> <a id="2309" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2313" class="Symbol">(</a><a id="2314" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2319" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2320" class="Symbol">)</a> <a id="2322" href="Amethyst.LinearAlgebra.As.Schmitty.html#2232" class="Generalizable">k</a>
<a id="2324" href="Amethyst.LinearAlgebra.As.Schmitty.html#2324" class="Bound">xs</a> <a id="2327" href="Amethyst.LinearAlgebra.As.Schmitty.html#2265" class="Function Operator">v⊡m</a> <a id="2331" href="Amethyst.LinearAlgebra.As.Schmitty.html#2331" class="Bound">yss</a> <a id="2335" class="Symbol">=</a> <a id="2337" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="2347" class="Symbol">_</a> <a id="2349" class="Symbol">(</a><a id="2350" href="Amethyst.LinearAlgebra.As.Schmitty.html#1665" class="Function Operator">_⊕_</a> <a id="2354" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2356" href="Data.Product.html#3386" class="Function">uncurry</a> <a id="2364" href="Amethyst.LinearAlgebra.As.Schmitty.html#1955" class="Function">scale</a><a id="2369" class="Symbol">)</a> <a id="2371" class="Symbol">(</a><a id="2372" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="2386" class="Symbol">(</a><a id="2387" href="SMT.Script.Base.html#1621" class="InductiveConstructor">lit</a> <a id="2391" class="Symbol">(</a><a id="2392" href="SMT.Theories.Reals.Base.html#3651" class="InductiveConstructor">nat</a> <a id="2396" class="Number">0</a><a id="2397" class="Symbol">)))</a> <a id="2401" class="Symbol">(</a><a id="2402" href="Data.Vec.Base.html#3858" class="Function">Vec.zip</a> <a id="2410" href="Amethyst.LinearAlgebra.As.Schmitty.html#2324" class="Bound">xs</a> <a id="2413" href="Amethyst.LinearAlgebra.As.Schmitty.html#2331" class="Bound">yss</a><a id="2416" class="Symbol">)</a>

<a id="2419" class="Comment">-- |Matrix multiplcation.</a>
<a id="_⊡_"></a><a id="2445" href="Amethyst.LinearAlgebra.As.Schmitty.html#2445" class="Function Operator">_⊡_</a> <a id="2449" class="Symbol">:</a> <a id="2451" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2455" class="Symbol">(</a><a id="2456" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2461" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2462" class="Symbol">)</a> <a id="2464" href="Amethyst.LinearAlgebra.As.Schmitty.html#2212" class="Generalizable">i</a> <a id="2466" href="Amethyst.LinearAlgebra.As.Schmitty.html#2222" class="Generalizable">j</a> <a id="2468" class="Symbol">→</a> <a id="2470" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2474" class="Symbol">(</a><a id="2475" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2480" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2481" class="Symbol">)</a> <a id="2483" href="Amethyst.LinearAlgebra.As.Schmitty.html#2222" class="Generalizable">j</a> <a id="2485" href="Amethyst.LinearAlgebra.As.Schmitty.html#2232" class="Generalizable">k</a> <a id="2487" class="Symbol">→</a> <a id="2489" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2493" class="Symbol">(</a><a id="2494" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2499" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2500" class="Symbol">)</a> <a id="2502" href="Amethyst.LinearAlgebra.As.Schmitty.html#2212" class="Generalizable">i</a> <a id="2504" href="Amethyst.LinearAlgebra.As.Schmitty.html#2232" class="Generalizable">k</a>
<a id="2506" href="Amethyst.LinearAlgebra.As.Schmitty.html#2506" class="Bound">xss</a> <a id="2510" href="Amethyst.LinearAlgebra.As.Schmitty.html#2445" class="Function Operator">⊡</a> <a id="2512" href="Amethyst.LinearAlgebra.As.Schmitty.html#2512" class="Bound">yss</a> <a id="2516" class="Symbol">=</a> <a id="2518" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2526" class="Symbol">(</a><a id="2527" href="Amethyst.LinearAlgebra.As.Schmitty.html#2265" class="Function Operator">_v⊡m</a> <a id="2532" href="Amethyst.LinearAlgebra.As.Schmitty.html#2512" class="Bound">yss</a><a id="2535" class="Symbol">)</a> <a id="2537" href="Amethyst.LinearAlgebra.As.Schmitty.html#2506" class="Bound">xss</a>

<a id="2542" class="Comment">-- |Matrix-vector multiplication.</a>
<a id="_m⊡v_"></a><a id="2576" href="Amethyst.LinearAlgebra.As.Schmitty.html#2576" class="Function Operator">_m⊡v_</a> <a id="2582" class="Symbol">:</a> <a id="2584" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2588" class="Symbol">(</a><a id="2589" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2594" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2595" class="Symbol">)</a> <a id="2597" href="Amethyst.LinearAlgebra.As.Schmitty.html#2212" class="Generalizable">i</a> <a id="2599" href="Amethyst.LinearAlgebra.As.Schmitty.html#2222" class="Generalizable">j</a> <a id="2601" class="Symbol">→</a> <a id="2603" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2607" class="Symbol">(</a><a id="2608" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2613" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2614" class="Symbol">)</a> <a id="2616" href="Amethyst.LinearAlgebra.As.Schmitty.html#2222" class="Generalizable">j</a> <a id="2618" class="Symbol">→</a> <a id="2620" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2624" class="Symbol">(</a><a id="2625" href="Amethyst.LinearAlgebra.As.Schmitty.html#1169" class="Function">Real</a> <a id="2630" href="Amethyst.LinearAlgebra.As.Schmitty.html#1122" class="Generalizable">Γ</a><a id="2631" class="Symbol">)</a> <a id="2633" href="Amethyst.LinearAlgebra.As.Schmitty.html#2212" class="Generalizable">i</a>
<a id="2635" href="Amethyst.LinearAlgebra.As.Schmitty.html#2635" class="Bound">xss</a> <a id="2639" href="Amethyst.LinearAlgebra.As.Schmitty.html#2576" class="Function Operator">m⊡v</a> <a id="2643" href="Amethyst.LinearAlgebra.As.Schmitty.html#2643" class="Bound">ys</a> <a id="2646" class="Symbol">=</a> <a id="2648" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2656" href="Data.Vec.Base.html#1455" class="Function">Vec.head</a> <a id="2665" class="Symbol">(</a><a id="2666" href="Amethyst.LinearAlgebra.As.Schmitty.html#2635" class="Bound">xss</a> <a id="2670" href="Amethyst.LinearAlgebra.As.Schmitty.html#2445" class="Function Operator">⊡</a> <a id="2672" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2680" href="Data.Vec.Base.html#5711" class="Function Operator">Vec.[_]</a> <a id="2688" href="Amethyst.LinearAlgebra.As.Schmitty.html#2643" class="Bound">ys</a><a id="2690" class="Symbol">)</a>
</pre></body></html>