<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.LinearAlgebra.As.Schmitty</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst: Neural Network Verification in Agda</a>
<a id="131" class="Comment">--</a>
<a id="134" class="Comment">-- This module exports the basic operations for linear algebra over Schmitty</a>
<a id="211" class="Comment">-- terms.</a>
<a id="221" class="Comment">--</a>
<a id="224" class="Comment">-- Exports:</a>
<a id="236" class="Comment">--</a>
<a id="239" class="Comment">--   - Real</a>
<a id="251" class="Comment">--   - toReal</a>
<a id="265" class="Comment">--   - Reals</a>
<a id="278" class="Comment">--   - Reals∋Real</a>
<a id="296" class="Comment">--   - sum</a>
<a id="307" class="Comment">--   - _⊕_</a>
<a id="318" class="Comment">--   - _⊛_</a>
<a id="329" class="Comment">--   - _·_</a>
<a id="340" class="Comment">--   - scale</a>
<a id="353" class="Comment">--   - normalise</a>
<a id="370" class="Comment">--   - _v⊡m_</a>
<a id="383" class="Comment">--   - _⊡_</a>
<a id="394" class="Comment">--   - _m⊡v_</a>
<a id="407" class="Comment">--</a>
<a id="410" class="Comment">--------------------------------------------------------------------------------</a>
<a id="491" class="Keyword">module</a> <a id="498" href="Amethyst.LinearAlgebra.As.Schmitty.html" class="Module">Amethyst.LinearAlgebra.As.Schmitty</a> <a id="533" class="Keyword">where</a>

<a id="540" class="Keyword">open</a> <a id="545" class="Keyword">import</a> <a id="552" href="Amethyst.LinearAlgebra.Base.html" class="Module">Amethyst.LinearAlgebra.Base</a>
<a id="580" class="Keyword">open</a> <a id="585" class="Keyword">import</a> <a id="592" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="601" class="Symbol">as</a> <a id="604" class="Module">Fin</a> <a id="608" class="Keyword">using</a> <a id="614" class="Symbol">(</a><a id="615" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="618" class="Symbol">;</a> <a id="620" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a><a id="624" class="Symbol">;</a> <a id="626" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a><a id="629" class="Symbol">)</a>
<a id="631" class="Keyword">open</a> <a id="636" class="Keyword">import</a> <a id="643" href="Data.Float.html" class="Module">Data.Float</a> <a id="654" class="Symbol">as</a> <a id="657" class="Module">Float</a> <a id="663" class="Keyword">using</a> <a id="669" class="Symbol">(</a><a id="670" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="675" class="Symbol">)</a>
<a id="677" class="Keyword">open</a> <a id="682" class="Keyword">import</a> <a id="689" href="Data.List.html" class="Module">Data.List</a> <a id="699" class="Symbol">as</a> <a id="702" class="Module">List</a> <a id="707" class="Keyword">using</a> <a id="713" class="Symbol">(</a><a id="714" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="718" class="Symbol">)</a>
<a id="720" class="Keyword">open</a> <a id="725" class="Keyword">import</a> <a id="732" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="741" class="Symbol">as</a> <a id="744" class="Module">Nat</a> <a id="748" class="Keyword">using</a> <a id="754" class="Symbol">(</a><a id="755" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="756" class="Symbol">;</a> <a id="758" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="762" class="Symbol">;</a> <a id="764" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="767" class="Symbol">)</a>
<a id="769" class="Keyword">open</a> <a id="774" class="Keyword">import</a> <a id="781" href="Data.Product.html" class="Module">Data.Product</a> <a id="794" class="Symbol">as</a> <a id="797" class="Module">Prod</a> <a id="802" class="Keyword">using</a> <a id="808" class="Symbol">(</a><a id="809" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="812" class="Symbol">;</a> <a id="814" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="817" class="Symbol">;</a> <a id="819" href="Data.Product.html#3399" class="Function">uncurry</a><a id="826" class="Symbol">)</a>
<a id="828" class="Keyword">open</a> <a id="833" class="Keyword">import</a> <a id="840" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="849" class="Symbol">as</a> <a id="852" class="Module">Vec</a> <a id="856" class="Keyword">using</a> <a id="862" class="Symbol">(</a><a id="863" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="866" class="Symbol">;</a> <a id="868" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="870" class="Symbol">;</a> <a id="872" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="875" class="Symbol">)</a>
<a id="877" class="Keyword">open</a> <a id="882" class="Keyword">import</a> <a id="889" href="Function.html" class="Module">Function</a> <a id="898" class="Keyword">using</a> <a id="904" class="Symbol">(</a><a id="905" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="908" class="Symbol">;</a> <a id="910" href="Function.Base.html#615" class="Function">id</a><a id="912" class="Symbol">)</a>
<a id="914" class="Keyword">open</a> <a id="919" class="Keyword">import</a> <a id="926" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="964" class="Keyword">using</a> <a id="970" class="Symbol">(</a><a id="971" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="974" class="Symbol">;</a> <a id="976" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="980" class="Symbol">)</a>
<a id="982" class="Keyword">open</a> <a id="987" class="Keyword">import</a> <a id="994" href="SMT.Theories.Reals.html" class="Module">SMT.Theories.Reals</a> <a id="1013" class="Symbol">as</a> <a id="1016" class="Module">Reals</a> <a id="1022" class="Keyword">public</a>
<a id="1029" class="Keyword">open</a> <a id="1034" class="Keyword">import</a> <a id="1041" href="SMT.Script.html" class="Module">SMT.Script</a> <a id="1052" href="SMT.Theories.Reals.html#8232" class="Function">Reals.theory</a> <a id="1065" class="Keyword">public</a>

<a id="1073" class="Comment">-- * Linear algebra</a>

<a id="1094" class="Keyword">private</a>
  <a id="1104" class="Keyword">variable</a>
    <a id="1117" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a> <a id="1119" class="Symbol">:</a> <a id="1121" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a>
    <a id="1130" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a> <a id="1132" class="Symbol">:</a> <a id="1134" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1137" class="Comment">-- |Real-valued SMT terms.</a>
<a id="Real"></a><a id="1164" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1169" class="Symbol">:</a> <a id="1171" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a> <a id="1176" class="Symbol">→</a> <a id="1178" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1182" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1187" href="Amethyst.LinearAlgebra.As.Schmitty.html#1187" class="Bound">Γ</a> <a id="1189" class="Symbol">=</a> <a id="1191" href="SMT.Script.Base.html#1472" class="Datatype">Term</a> <a id="1196" href="Amethyst.LinearAlgebra.As.Schmitty.html#1187" class="Bound">Γ</a> <a id="1198" href="SMT.Theories.Reals.html#1045" class="InductiveConstructor">REAL</a>

<a id="toReal"></a><a id="1204" href="Amethyst.LinearAlgebra.As.Schmitty.html#1204" class="Function">toReal</a> <a id="1211" class="Symbol">:</a> <a id="1213" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="1219" class="Symbol">→</a> <a id="1221" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1226" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a>
<a id="1228" href="Amethyst.LinearAlgebra.As.Schmitty.html#1204" class="Function">toReal</a> <a id="1235" class="Symbol">=</a> <a id="1237" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="1241" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1243" href="SMT.Theories.Reals.html#3796" class="InductiveConstructor">float</a>

<a id="1250" class="Comment">-- |Typing context with only sort REAL.</a>
<a id="Reals"></a><a id="1290" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="1296" class="Symbol">:</a> <a id="1298" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1300" class="Symbol">→</a> <a id="1302" href="SMT.Script.Base.html#1026" class="Function">Ctxt</a>
<a id="1307" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="1313" href="Amethyst.LinearAlgebra.As.Schmitty.html#1313" class="Bound">inputs</a> <a id="1320" class="Symbol">=</a> <a id="1322" href="Data.List.Base.html#4852" class="Function">List.replicate</a> <a id="1337" href="Amethyst.LinearAlgebra.As.Schmitty.html#1313" class="Bound">inputs</a> <a id="1344" href="SMT.Theories.Reals.html#1045" class="InductiveConstructor">REAL</a>

<a id="1350" class="Comment">-- |Turns out that all variables in a Reals have sort REAL?</a>
<a id="Reals∋Real"></a><a id="1410" href="Amethyst.LinearAlgebra.As.Schmitty.html#1410" class="Function">Reals∋Real</a> <a id="1421" class="Symbol">:</a> <a id="1423" class="Symbol">(</a><a id="1424" href="Amethyst.LinearAlgebra.As.Schmitty.html#1424" class="Bound">i</a> <a id="1426" class="Symbol">:</a> <a id="1428" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a> <a id="1432" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a><a id="1433" class="Symbol">)</a> <a id="1435" class="Symbol">→</a> <a id="1437" href="Amethyst.LinearAlgebra.As.Schmitty.html#1290" class="Function">Reals</a> <a id="1443" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a> <a id="1445" href="SMT.Script.Base.html#1249" class="Function Operator">∋</a> <a id="1447" href="SMT.Theories.Reals.html#1045" class="InductiveConstructor">REAL</a>
<a id="1452" href="Amethyst.LinearAlgebra.As.Schmitty.html#1410" class="Function">Reals∋Real</a> <a id="1463" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a> <a id="1468" class="Symbol">=</a> <a id="1470" class="Symbol">(</a><a id="1471" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a> <a id="1476" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1478" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1482" class="Symbol">)</a>
<a id="1484" href="Amethyst.LinearAlgebra.As.Schmitty.html#1410" class="Function">Reals∋Real</a> <a id="1495" class="Symbol">(</a><a id="1496" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a> <a id="1500" href="Amethyst.LinearAlgebra.As.Schmitty.html#1500" class="Bound">i</a><a id="1501" class="Symbol">)</a> <a id="1503" class="Symbol">=</a> <a id="1505" href="Data.Product.html#2450" class="Function">Prod.map</a> <a id="1514" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a> <a id="1518" href="Function.Base.html#615" class="Function">id</a> <a id="1521" class="Symbol">(</a><a id="1522" href="Amethyst.LinearAlgebra.As.Schmitty.html#1410" class="Function">Reals∋Real</a> <a id="1533" href="Amethyst.LinearAlgebra.As.Schmitty.html#1500" class="Bound">i</a><a id="1534" class="Symbol">)</a>


<a id="1538" class="Comment">-- ** Vectors</a>

<a id="1553" class="Comment">-- |Sum.</a>
<a id="sum"></a><a id="1562" href="Amethyst.LinearAlgebra.As.Schmitty.html#1562" class="Function">sum</a> <a id="1566" class="Symbol">:</a> <a id="1568" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1572" class="Symbol">(</a><a id="1573" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1578" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="1579" class="Symbol">)</a> <a id="1581" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a> <a id="1583" class="Symbol">→</a> <a id="1585" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1590" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a>
<a id="1592" href="Amethyst.LinearAlgebra.As.Schmitty.html#1562" class="Function">sum</a> <a id="1596" class="Symbol">=</a> <a id="1598" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="1608" class="Symbol">_</a> <a id="1610" class="Symbol">(</a><a id="1611" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1616" href="SMT.Theories.Reals.html#4785" class="InductiveConstructor">add</a><a id="1619" class="Symbol">)</a> <a id="1621" class="Symbol">(</a><a id="1622" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="1626" class="Symbol">(</a><a id="1627" href="SMT.Theories.Reals.html#3769" class="InductiveConstructor">nat</a> <a id="1631" class="Number">0</a><a id="1632" class="Symbol">))</a>

<a id="1636" class="Comment">-- |Pointwise addition.</a>
<a id="_⊕_"></a><a id="1660" href="Amethyst.LinearAlgebra.As.Schmitty.html#1660" class="Function Operator">_⊕_</a> <a id="1664" class="Symbol">:</a> <a id="1666" class="Symbol">(</a><a id="1667" href="Amethyst.LinearAlgebra.As.Schmitty.html#1667" class="Bound">xs</a> <a id="1670" href="Amethyst.LinearAlgebra.As.Schmitty.html#1670" class="Bound">ys</a> <a id="1673" class="Symbol">:</a> <a id="1675" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1679" class="Symbol">(</a><a id="1680" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1685" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="1686" class="Symbol">)</a> <a id="1688" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a><a id="1689" class="Symbol">)</a> <a id="1691" class="Symbol">→</a> <a id="1693" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1697" class="Symbol">(</a><a id="1698" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1703" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="1704" class="Symbol">)</a> <a id="1706" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a>
<a id="1708" href="Amethyst.LinearAlgebra.As.Schmitty.html#1660" class="Function Operator">_⊕_</a> <a id="1712" class="Symbol">=</a> <a id="1714" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="1726" class="Symbol">(</a><a id="1727" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1732" href="SMT.Theories.Reals.html#4785" class="InductiveConstructor">add</a><a id="1735" class="Symbol">)</a>

<a id="1738" class="Comment">-- |Pointwise multiplication.</a>
<a id="_⊛_"></a><a id="1768" href="Amethyst.LinearAlgebra.As.Schmitty.html#1768" class="Function Operator">_⊛_</a> <a id="1772" class="Symbol">:</a> <a id="1774" class="Symbol">(</a><a id="1775" href="Amethyst.LinearAlgebra.As.Schmitty.html#1775" class="Bound">xs</a> <a id="1778" href="Amethyst.LinearAlgebra.As.Schmitty.html#1778" class="Bound">ys</a> <a id="1781" class="Symbol">:</a> <a id="1783" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1787" class="Symbol">(</a><a id="1788" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1793" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="1794" class="Symbol">)</a> <a id="1796" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a><a id="1797" class="Symbol">)</a> <a id="1799" class="Symbol">→</a> <a id="1801" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1805" class="Symbol">(</a><a id="1806" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1811" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="1812" class="Symbol">)</a> <a id="1814" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a>
<a id="1816" href="Amethyst.LinearAlgebra.As.Schmitty.html#1768" class="Function Operator">_⊛_</a> <a id="1820" class="Symbol">=</a> <a id="1822" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="1834" class="Symbol">(</a><a id="1835" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="1840" href="SMT.Theories.Reals.html#4816" class="InductiveConstructor">mul</a><a id="1843" class="Symbol">)</a>

<a id="1846" class="Comment">-- |Dot product.</a>
<a id="_·_"></a><a id="1863" href="Amethyst.LinearAlgebra.As.Schmitty.html#1863" class="Function Operator">_·_</a> <a id="1867" class="Symbol">:</a> <a id="1869" class="Symbol">(</a><a id="1870" href="Amethyst.LinearAlgebra.As.Schmitty.html#1870" class="Bound">xs</a> <a id="1873" href="Amethyst.LinearAlgebra.As.Schmitty.html#1873" class="Bound">ys</a> <a id="1876" class="Symbol">:</a> <a id="1878" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1882" class="Symbol">(</a><a id="1883" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1888" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="1889" class="Symbol">)</a> <a id="1891" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a><a id="1892" class="Symbol">)</a> <a id="1894" class="Symbol">→</a> <a id="1896" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1901" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a>
<a id="1903" href="Amethyst.LinearAlgebra.As.Schmitty.html#1863" class="Function Operator">_·_</a> <a id="1907" href="Amethyst.LinearAlgebra.As.Schmitty.html#1907" class="Bound">xs</a> <a id="1910" href="Amethyst.LinearAlgebra.As.Schmitty.html#1910" class="Bound">ys</a> <a id="1913" class="Symbol">=</a> <a id="1915" href="Amethyst.LinearAlgebra.As.Schmitty.html#1562" class="Function">sum</a> <a id="1919" class="Symbol">(</a><a id="1920" href="Amethyst.LinearAlgebra.As.Schmitty.html#1907" class="Bound">xs</a> <a id="1923" href="Amethyst.LinearAlgebra.As.Schmitty.html#1660" class="Function Operator">⊕</a> <a id="1925" href="Amethyst.LinearAlgebra.As.Schmitty.html#1910" class="Bound">ys</a><a id="1927" class="Symbol">)</a>

<a id="1930" class="Comment">-- |Vector scaling.</a>
<a id="scale"></a><a id="1950" href="Amethyst.LinearAlgebra.As.Schmitty.html#1950" class="Function">scale</a> <a id="1956" class="Symbol">:</a> <a id="1958" class="Symbol">(</a><a id="1959" href="Amethyst.LinearAlgebra.As.Schmitty.html#1959" class="Bound">x</a> <a id="1961" class="Symbol">:</a> <a id="1963" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1968" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="1969" class="Symbol">)</a> <a id="1971" class="Symbol">(</a><a id="1972" href="Amethyst.LinearAlgebra.As.Schmitty.html#1972" class="Bound">ys</a> <a id="1975" class="Symbol">:</a> <a id="1977" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1981" class="Symbol">(</a><a id="1982" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="1987" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="1988" class="Symbol">)</a> <a id="1990" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a><a id="1991" class="Symbol">)</a> <a id="1993" class="Symbol">→</a> <a id="1995" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1999" class="Symbol">(</a><a id="2000" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2005" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2006" class="Symbol">)</a> <a id="2008" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a>
<a id="2010" href="Amethyst.LinearAlgebra.As.Schmitty.html#1950" class="Function">scale</a> <a id="2016" href="Amethyst.LinearAlgebra.As.Schmitty.html#2016" class="Bound">x</a> <a id="2018" class="Symbol">=</a> <a id="2020" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2028" class="Symbol">(</a><a id="2029" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="2034" href="SMT.Theories.Reals.html#4816" class="InductiveConstructor">mul</a> <a id="2038" href="Amethyst.LinearAlgebra.As.Schmitty.html#2016" class="Bound">x</a><a id="2039" class="Symbol">)</a>

<a id="2042" class="Comment">-- |Vector normalisation.</a>
<a id="normalise"></a><a id="2068" href="Amethyst.LinearAlgebra.As.Schmitty.html#2068" class="Function">normalise</a> <a id="2078" class="Symbol">:</a> <a id="2080" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2084" class="Symbol">(</a><a id="2085" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2090" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2091" class="Symbol">)</a> <a id="2093" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a> <a id="2095" class="Symbol">→</a> <a id="2097" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2101" class="Symbol">(</a><a id="2102" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2107" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2108" class="Symbol">)</a> <a id="2110" href="Amethyst.LinearAlgebra.As.Schmitty.html#1130" class="Generalizable">n</a>
<a id="2112" href="Amethyst.LinearAlgebra.As.Schmitty.html#2068" class="Function">normalise</a> <a id="2122" href="Amethyst.LinearAlgebra.As.Schmitty.html#2122" class="Bound">xs</a> <a id="2125" class="Symbol">=</a> <a id="2127" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2135" class="Symbol">(λ</a> <a id="2138" href="Amethyst.LinearAlgebra.As.Schmitty.html#2138" class="Bound">x</a> <a id="2140" class="Symbol">→</a> <a id="2142" href="SMT.Script.Base.html#1934" class="InductiveConstructor">app₂</a> <a id="2147" href="SMT.Theories.Reals.html#4847" class="InductiveConstructor">div</a> <a id="2151" href="Amethyst.LinearAlgebra.As.Schmitty.html#2138" class="Bound">x</a> <a id="2153" class="Symbol">(</a><a id="2154" href="Amethyst.LinearAlgebra.As.Schmitty.html#1562" class="Function">sum</a> <a id="2158" href="Amethyst.LinearAlgebra.As.Schmitty.html#2122" class="Bound">xs</a><a id="2160" class="Symbol">))</a> <a id="2163" href="Amethyst.LinearAlgebra.As.Schmitty.html#2122" class="Bound">xs</a>


<a id="2168" class="Comment">-- ** Matrices</a>

<a id="2184" class="Keyword">private</a>
  <a id="2194" class="Keyword">variable</a>
    <a id="2207" href="Amethyst.LinearAlgebra.As.Schmitty.html#2207" class="Generalizable">i</a> <a id="2209" class="Symbol">:</a> <a id="2211" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2217" href="Amethyst.LinearAlgebra.As.Schmitty.html#2217" class="Generalizable">j</a> <a id="2219" class="Symbol">:</a> <a id="2221" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2227" href="Amethyst.LinearAlgebra.As.Schmitty.html#2227" class="Generalizable">k</a> <a id="2229" class="Symbol">:</a> <a id="2231" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2237" href="Amethyst.LinearAlgebra.As.Schmitty.html#2237" class="Generalizable">rows</a> <a id="2242" class="Symbol">:</a> <a id="2244" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2250" href="Amethyst.LinearAlgebra.As.Schmitty.html#2250" class="Generalizable">cols</a> <a id="2255" class="Symbol">:</a> <a id="2257" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="_v⊡m_"></a><a id="2260" href="Amethyst.LinearAlgebra.As.Schmitty.html#2260" class="Function Operator">_v⊡m_</a> <a id="2266" class="Symbol">:</a> <a id="2268" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2272" class="Symbol">(</a><a id="2273" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2278" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2279" class="Symbol">)</a> <a id="2281" href="Amethyst.LinearAlgebra.As.Schmitty.html#2217" class="Generalizable">j</a> <a id="2283" class="Symbol">→</a> <a id="2285" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2289" class="Symbol">(</a><a id="2290" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2295" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2296" class="Symbol">)</a> <a id="2298" href="Amethyst.LinearAlgebra.As.Schmitty.html#2217" class="Generalizable">j</a> <a id="2300" href="Amethyst.LinearAlgebra.As.Schmitty.html#2227" class="Generalizable">k</a> <a id="2302" class="Symbol">→</a> <a id="2304" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2308" class="Symbol">(</a><a id="2309" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2314" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2315" class="Symbol">)</a> <a id="2317" href="Amethyst.LinearAlgebra.As.Schmitty.html#2227" class="Generalizable">k</a>
<a id="2319" href="Amethyst.LinearAlgebra.As.Schmitty.html#2319" class="Bound">xs</a> <a id="2322" href="Amethyst.LinearAlgebra.As.Schmitty.html#2260" class="Function Operator">v⊡m</a> <a id="2326" href="Amethyst.LinearAlgebra.As.Schmitty.html#2326" class="Bound">yss</a> <a id="2330" class="Symbol">=</a> <a id="2332" href="Data.Vec.Base.html#4716" class="Function">Vec.foldr</a> <a id="2342" class="Symbol">_</a> <a id="2344" class="Symbol">(</a><a id="2345" href="Amethyst.LinearAlgebra.As.Schmitty.html#1660" class="Function Operator">_⊕_</a> <a id="2349" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2351" href="Data.Product.html#3399" class="Function">uncurry</a> <a id="2359" href="Amethyst.LinearAlgebra.As.Schmitty.html#1950" class="Function">scale</a><a id="2364" class="Symbol">)</a> <a id="2366" class="Symbol">(</a><a id="2367" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="2381" class="Symbol">(</a><a id="2382" href="SMT.Script.Base.html#1559" class="InductiveConstructor">lit</a> <a id="2386" class="Symbol">(</a><a id="2387" href="SMT.Theories.Reals.html#3769" class="InductiveConstructor">nat</a> <a id="2391" class="Number">0</a><a id="2392" class="Symbol">)))</a> <a id="2396" class="Symbol">(</a><a id="2397" href="Data.Vec.Base.html#3858" class="Function">Vec.zip</a> <a id="2405" href="Amethyst.LinearAlgebra.As.Schmitty.html#2319" class="Bound">xs</a> <a id="2408" href="Amethyst.LinearAlgebra.As.Schmitty.html#2326" class="Bound">yss</a><a id="2411" class="Symbol">)</a>

<a id="2414" class="Comment">-- |Matrix multiplcation.</a>
<a id="_⊡_"></a><a id="2440" href="Amethyst.LinearAlgebra.As.Schmitty.html#2440" class="Function Operator">_⊡_</a> <a id="2444" class="Symbol">:</a> <a id="2446" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2450" class="Symbol">(</a><a id="2451" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2456" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2457" class="Symbol">)</a> <a id="2459" href="Amethyst.LinearAlgebra.As.Schmitty.html#2207" class="Generalizable">i</a> <a id="2461" href="Amethyst.LinearAlgebra.As.Schmitty.html#2217" class="Generalizable">j</a> <a id="2463" class="Symbol">→</a> <a id="2465" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2469" class="Symbol">(</a><a id="2470" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2475" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2476" class="Symbol">)</a> <a id="2478" href="Amethyst.LinearAlgebra.As.Schmitty.html#2217" class="Generalizable">j</a> <a id="2480" href="Amethyst.LinearAlgebra.As.Schmitty.html#2227" class="Generalizable">k</a> <a id="2482" class="Symbol">→</a> <a id="2484" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2488" class="Symbol">(</a><a id="2489" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2494" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2495" class="Symbol">)</a> <a id="2497" href="Amethyst.LinearAlgebra.As.Schmitty.html#2207" class="Generalizable">i</a> <a id="2499" href="Amethyst.LinearAlgebra.As.Schmitty.html#2227" class="Generalizable">k</a>
<a id="2501" href="Amethyst.LinearAlgebra.As.Schmitty.html#2501" class="Bound">xss</a> <a id="2505" href="Amethyst.LinearAlgebra.As.Schmitty.html#2440" class="Function Operator">⊡</a> <a id="2507" href="Amethyst.LinearAlgebra.As.Schmitty.html#2507" class="Bound">yss</a> <a id="2511" class="Symbol">=</a> <a id="2513" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2521" class="Symbol">(</a><a id="2522" href="Amethyst.LinearAlgebra.As.Schmitty.html#2260" class="Function Operator">_v⊡m</a> <a id="2527" href="Amethyst.LinearAlgebra.As.Schmitty.html#2507" class="Bound">yss</a><a id="2530" class="Symbol">)</a> <a id="2532" href="Amethyst.LinearAlgebra.As.Schmitty.html#2501" class="Bound">xss</a>

<a id="2537" class="Comment">-- |Matrix-vector multiplication.</a>
<a id="_m⊡v_"></a><a id="2571" href="Amethyst.LinearAlgebra.As.Schmitty.html#2571" class="Function Operator">_m⊡v_</a> <a id="2577" class="Symbol">:</a> <a id="2579" href="Amethyst.LinearAlgebra.Base.html#569" class="Function">Mat</a> <a id="2583" class="Symbol">(</a><a id="2584" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2589" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2590" class="Symbol">)</a> <a id="2592" href="Amethyst.LinearAlgebra.As.Schmitty.html#2207" class="Generalizable">i</a> <a id="2594" href="Amethyst.LinearAlgebra.As.Schmitty.html#2217" class="Generalizable">j</a> <a id="2596" class="Symbol">→</a> <a id="2598" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2602" class="Symbol">(</a><a id="2603" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2608" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2609" class="Symbol">)</a> <a id="2611" href="Amethyst.LinearAlgebra.As.Schmitty.html#2217" class="Generalizable">j</a> <a id="2613" class="Symbol">→</a> <a id="2615" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="2619" class="Symbol">(</a><a id="2620" href="Amethyst.LinearAlgebra.As.Schmitty.html#1164" class="Function">Real</a> <a id="2625" href="Amethyst.LinearAlgebra.As.Schmitty.html#1117" class="Generalizable">Γ</a><a id="2626" class="Symbol">)</a> <a id="2628" href="Amethyst.LinearAlgebra.As.Schmitty.html#2207" class="Generalizable">i</a>
<a id="2630" href="Amethyst.LinearAlgebra.As.Schmitty.html#2630" class="Bound">xss</a> <a id="2634" href="Amethyst.LinearAlgebra.As.Schmitty.html#2571" class="Function Operator">m⊡v</a> <a id="2638" href="Amethyst.LinearAlgebra.As.Schmitty.html#2638" class="Bound">ys</a> <a id="2641" class="Symbol">=</a> <a id="2643" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2651" href="Data.Vec.Base.html#1455" class="Function">Vec.head</a> <a id="2660" class="Symbol">(</a><a id="2661" href="Amethyst.LinearAlgebra.As.Schmitty.html#2630" class="Bound">xss</a> <a id="2665" href="Amethyst.LinearAlgebra.As.Schmitty.html#2440" class="Function Operator">⊡</a> <a id="2667" href="Data.Vec.Base.html#2541" class="Function">Vec.map</a> <a id="2675" href="Data.Vec.Base.html#5711" class="Function Operator">Vec.[_]</a> <a id="2683" href="Amethyst.LinearAlgebra.As.Schmitty.html#2638" class="Bound">ys</a><a id="2685" class="Symbol">)</a>
</pre></body></html>