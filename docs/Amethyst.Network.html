<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Amethyst.Network</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Amethyst.Network.html" class="Module">Amethyst.Network</a> <a id="25" class="Keyword">where</a>

<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="53" class="Symbol">as</a> <a id="56" class="Module">Fin</a> <a id="60" class="Keyword">using</a> <a id="66" class="Symbol">(</a><a id="67" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="70" class="Symbol">)</a>
<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Data.Float.html" class="Module">Data.Float</a> <a id="95" class="Symbol">as</a> <a id="98" class="Module">Float</a> <a id="104" class="Keyword">using</a> <a id="110" class="Symbol">(</a><a id="111" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="116" class="Symbol">)</a>
<a id="118" class="Keyword">open</a> <a id="123" class="Keyword">import</a> <a id="130" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="139" class="Symbol">as</a> <a id="142" class="Module">Nat</a> <a id="146" class="Keyword">using</a> <a id="152" class="Symbol">(</a><a id="153" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="154" class="Symbol">;</a> <a id="156" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="159" class="Symbol">;</a> <a id="161" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="165" class="Symbol">)</a>
<a id="167" class="Keyword">open</a> <a id="172" class="Keyword">import</a> <a id="179" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="188" class="Symbol">as</a> <a id="191" class="Module">Vec</a> <a id="195" class="Keyword">using</a> <a id="201" class="Symbol">(</a><a id="202" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="205" class="Symbol">)</a>
<a id="207" class="Keyword">open</a> <a id="212" class="Keyword">import</a> <a id="219" href="Function.html" class="Module">Function</a> <a id="228" class="Keyword">using</a> <a id="234" class="Symbol">(</a><a id="235" href="Function.Base.html#615" class="Function">id</a><a id="237" class="Symbol">)</a>

<a id="240" class="Keyword">private</a>
  <a id="250" class="Keyword">variable</a>
    <a id="263" href="Amethyst.Network.html#263" class="Generalizable">A</a> <a id="265" class="Symbol">:</a> <a id="267" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="275" href="Amethyst.Network.html#275" class="Generalizable">n</a> <a id="277" class="Symbol">:</a> <a id="279" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="285" href="Amethyst.Network.html#285" class="Generalizable">inputs</a>  <a id="293" class="Symbol">:</a> <a id="295" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="301" href="Amethyst.Network.html#301" class="Generalizable">hidden</a>  <a id="309" class="Symbol">:</a> <a id="311" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="317" href="Amethyst.Network.html#317" class="Generalizable">outputs</a> <a id="325" class="Symbol">:</a> <a id="327" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="333" href="Amethyst.Network.html#333" class="Generalizable">layers</a>  <a id="341" class="Symbol">:</a> <a id="343" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="346" class="Keyword">data</a> <a id="Activation"></a><a id="351" href="Amethyst.Network.html#351" class="Datatype">Activation</a> <a id="362" class="Symbol">:</a> <a id="364" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="368" class="Keyword">where</a>
  <a id="Activation.linear"></a><a id="376" href="Amethyst.Network.html#376" class="InductiveConstructor">linear</a>  <a id="384" class="Symbol">:</a> <a id="386" href="Amethyst.Network.html#351" class="Datatype">Activation</a>
  <a id="Activation.relu"></a><a id="399" href="Amethyst.Network.html#399" class="InductiveConstructor">relu</a>    <a id="407" class="Symbol">:</a> <a id="409" href="Amethyst.Network.html#351" class="Datatype">Activation</a>
  <a id="Activation.sigmoid"></a><a id="422" href="Amethyst.Network.html#422" class="InductiveConstructor">sigmoid</a> <a id="430" class="Symbol">:</a> <a id="432" href="Amethyst.Network.html#351" class="Datatype">Activation</a>
  <a id="Activation.softmax"></a><a id="445" href="Amethyst.Network.html#445" class="InductiveConstructor">softmax</a> <a id="453" class="Symbol">:</a> <a id="455" href="Amethyst.Network.html#351" class="Datatype">Activation</a>
  <a id="Activation.tanh"></a><a id="468" href="Amethyst.Network.html#468" class="InductiveConstructor">tanh</a>    <a id="476" class="Symbol">:</a> <a id="478" href="Amethyst.Network.html#351" class="Datatype">Activation</a>

<a id="490" class="Keyword">record</a> <a id="Layer"></a><a id="497" href="Amethyst.Network.html#497" class="Record">Layer</a> <a id="503" class="Symbol">(</a><a id="504" href="Amethyst.Network.html#504" class="Bound">A</a> <a id="506" class="Symbol">:</a> <a id="508" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="511" class="Symbol">)</a> <a id="513" class="Symbol">(</a><a id="514" href="Amethyst.Network.html#514" class="Bound">inputs</a> <a id="521" href="Amethyst.Network.html#521" class="Bound">outputs</a> <a id="529" class="Symbol">:</a> <a id="531" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="532" class="Symbol">)</a> <a id="534" class="Symbol">:</a> <a id="536" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="540" class="Keyword">where</a>
  <a id="548" class="Keyword">field</a>
    <a id="Layer.weights"></a><a id="558" href="Amethyst.Network.html#558" class="Field">weights</a>    <a id="569" class="Symbol">:</a> <a id="571" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="575" class="Symbol">(</a><a id="576" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="580" href="Amethyst.Network.html#504" class="Bound">A</a> <a id="582" href="Amethyst.Network.html#521" class="Bound">outputs</a><a id="589" class="Symbol">)</a> <a id="591" href="Amethyst.Network.html#514" class="Bound">inputs</a>
    <a id="Layer.biases"></a><a id="602" href="Amethyst.Network.html#602" class="Field">biases</a>     <a id="613" class="Symbol">:</a> <a id="615" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="619" href="Amethyst.Network.html#504" class="Bound">A</a> <a id="621" href="Amethyst.Network.html#521" class="Bound">outputs</a>
    <a id="Layer.activation"></a><a id="633" href="Amethyst.Network.html#633" class="Field">activation</a> <a id="644" class="Symbol">:</a> <a id="646" href="Amethyst.Network.html#351" class="Datatype">Activation</a>

<a id="658" class="Keyword">infixr</a> <a id="665" class="Number">5</a> <a id="667" href="Amethyst.Network.html#779" class="InductiveConstructor Operator">_∷_</a>

<a id="672" class="Keyword">data</a> <a id="Network"></a><a id="677" href="Amethyst.Network.html#677" class="Datatype">Network</a> <a id="685" class="Symbol">(</a><a id="686" href="Amethyst.Network.html#686" class="Bound">A</a> <a id="688" class="Symbol">:</a> <a id="690" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="693" class="Symbol">)</a> <a id="695" class="Symbol">(</a><a id="696" href="Amethyst.Network.html#696" class="Bound">inputs</a> <a id="703" class="Symbol">:</a> <a id="705" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="706" class="Symbol">)</a> <a id="708" class="Symbol">:</a> <a id="710" class="Symbol">(</a><a id="711" href="Amethyst.Network.html#711" class="Bound">outputs</a> <a id="719" href="Amethyst.Network.html#719" class="Bound">layers</a> <a id="726" class="Symbol">:</a> <a id="728" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="729" class="Symbol">)</a> <a id="731" class="Symbol">→</a> <a id="733" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="737" class="Keyword">where</a>
  <a id="Network.[]"></a><a id="745" href="Amethyst.Network.html#745" class="InductiveConstructor">[]</a>  <a id="749" class="Symbol">:</a> <a id="751" href="Amethyst.Network.html#677" class="Datatype">Network</a> <a id="759" href="Amethyst.Network.html#686" class="Bound">A</a> <a id="761" href="Amethyst.Network.html#696" class="Bound">inputs</a> <a id="768" href="Amethyst.Network.html#696" class="Bound">inputs</a> <a id="775" class="Number">0</a>
  <a id="Network._∷_"></a><a id="779" href="Amethyst.Network.html#779" class="InductiveConstructor Operator">_∷_</a> <a id="783" class="Symbol">:</a> <a id="785" href="Amethyst.Network.html#497" class="Record">Layer</a> <a id="791" href="Amethyst.Network.html#686" class="Bound">A</a> <a id="793" href="Amethyst.Network.html#696" class="Bound">inputs</a> <a id="800" href="Amethyst.Network.html#301" class="Generalizable">hidden</a> <a id="807" class="Symbol">→</a> <a id="809" href="Amethyst.Network.html#677" class="Datatype">Network</a> <a id="817" href="Amethyst.Network.html#686" class="Bound">A</a> <a id="819" href="Amethyst.Network.html#301" class="Generalizable">hidden</a> <a id="826" href="Amethyst.Network.html#317" class="Generalizable">outputs</a> <a id="834" href="Amethyst.Network.html#333" class="Generalizable">layers</a> <a id="841" class="Symbol">→</a> <a id="843" href="Amethyst.Network.html#677" class="Datatype">Network</a> <a id="851" href="Amethyst.Network.html#686" class="Bound">A</a> <a id="853" href="Amethyst.Network.html#696" class="Bound">inputs</a> <a id="860" href="Amethyst.Network.html#317" class="Generalizable">outputs</a> <a id="868" class="Symbol">(</a><a id="869" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="873" href="Amethyst.Network.html#333" class="Generalizable">layers</a><a id="879" class="Symbol">)</a>
</pre></body></html>