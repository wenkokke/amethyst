<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Identity-1-Linear-1</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--------------------------------------------------------------------------------</a>
<a id="82" class="Comment">-- Amethyst Models: Examples of Neural Network Verification in Agda</a>
<a id="150" class="Comment">--</a>
<a id="153" class="Comment">-- This module contains an example use of Amethyst, to verify the correctness of</a>
<a id="234" class="Comment">-- the identity function network.</a>
<a id="268" class="Comment">--------------------------------------------------------------------------------</a>

<a id="350" class="Symbol">{-#</a> <a id="354" class="Keyword">OPTIONS</a> <a id="362" class="Pragma">--allow-exec</a> <a id="375" class="Symbol">#-}</a>

<a id="380" class="Keyword">module</a> <a id="387" href="Identity-1-Linear-1.html" class="Module">Identity-1-Linear-1</a> <a id="407" class="Keyword">where</a>

<a id="414" class="Keyword">open</a> <a id="419" class="Keyword">import</a> <a id="426" href="Amethyst.Prelude.html" class="Module">Amethyst.Prelude</a>
<a id="443" class="Keyword">open</a> <a id="448" class="Keyword">import</a> <a id="455" href="Data.Float.html" class="Module">Data.Float</a> <a id="466" class="Keyword">using</a> <a id="472" class="Symbol">(</a><a id="473" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a><a id="478" class="Symbol">)</a>
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="530" class="Keyword">using</a> <a id="536" class="Symbol">(</a><a id="537" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="540" class="Symbol">;</a> <a id="542" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="546" class="Symbol">)</a>

<a id="layer"></a><a id="549" href="Identity-1-Linear-1.html#549" class="Function">layer</a> <a id="555" class="Symbol">:</a> <a id="557" href="Amethyst.Network.Base.html#969" class="Record">Layer</a> <a id="563" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="569" class="Number">1</a> <a id="571" class="Number">1</a>
<a id="573" href="Identity-1-Linear-1.html#549" class="Function">layer</a> <a id="579" class="Symbol">=</a> <a id="581" class="Keyword">record</a>
  <a id="590" class="Symbol">{</a> <a id="592" href="Amethyst.Network.Base.html#1058" class="Field">weights</a>    <a id="603" class="Symbol">=</a> <a id="605" href="Data.Vec.Base.html#5711" class="Function Operator">[</a> <a id="607" class="Number">1.0</a> <a id="611" href="Data.Vec.Base.html#5711" class="Function Operator">]</a> <a id="613" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="615" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a>
  <a id="620" class="Symbol">;</a> <a id="622" href="Amethyst.Network.Base.html#1102" class="Field">biases</a>     <a id="633" class="Symbol">=</a> <a id="635" href="Data.Vec.Base.html#5711" class="Function Operator">[</a> <a id="637" class="Number">0.0</a> <a id="641" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
  <a id="645" class="Symbol">;</a> <a id="647" href="Amethyst.Network.Base.html#1030" class="Field">activation</a> <a id="658" class="Symbol">=</a> <a id="660" href="Amethyst.Network.Base.html#848" class="InductiveConstructor">linear</a>
  <a id="669" class="Symbol">}</a>

<a id="model"></a><a id="672" href="Identity-1-Linear-1.html#672" class="Function">model</a> <a id="678" class="Symbol">:</a> <a id="680" href="Amethyst.Network.Base.html#1287" class="Datatype">Network</a> <a id="688" href="Agda.Builtin.Float.html#354" class="Postulate">Float</a> <a id="694" class="Symbol">(</a><a id="695" class="Number">1</a> <a id="697" class="InductiveConstructor Operator">∷</a> <a id="699" class="Number">1</a> <a id="701" class="InductiveConstructor Operator">∷</a> <a id="703" class="InductiveConstructor">[]</a><a id="705" class="Symbol">)</a>
<a id="707" href="Identity-1-Linear-1.html#672" class="Function">model</a> <a id="713" class="Symbol">=</a> <a id="715" href="Identity-1-Linear-1.html#549" class="Function">layer</a> <a id="721" href="Amethyst.Network.Base.html#1388" class="InductiveConstructor Operator">∷</a> <a id="723" href="Amethyst.Network.Base.html#1353" class="InductiveConstructor">[]</a>

<a id="727" href="Identity-1-Linear-1.html#727" class="Function">_</a> <a id="729" class="Symbol">:</a> <a id="731" href="Amethyst.Network.As.Float.html#2120" class="Function">evalNetwork</a> <a id="743" href="Identity-1-Linear-1.html#672" class="Function">model</a> <a id="749" class="Symbol">(</a><a id="750" class="Number">0.0</a> <a id="754" class="InductiveConstructor Operator">∷</a> <a id="756" class="InductiveConstructor">[]</a><a id="758" class="Symbol">)</a> <a id="760" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="762" class="Symbol">(</a><a id="763" class="Number">0.0</a> <a id="767" class="InductiveConstructor Operator">∷</a> <a id="769" class="InductiveConstructor">[]</a><a id="771" class="Symbol">)</a>
<a id="773" class="Symbol">_</a> <a id="775" class="Symbol">=</a> <a id="777" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="782" href="Identity-1-Linear-1.html#782" class="Function">_</a> <a id="784" class="Symbol">:</a> <a id="786" href="Amethyst.Network.As.Float.html#2120" class="Function">evalNetwork</a> <a id="798" href="Identity-1-Linear-1.html#672" class="Function">model</a> <a id="804" class="Symbol">(</a><a id="805" class="Number">1.0</a> <a id="809" class="InductiveConstructor Operator">∷</a> <a id="811" class="InductiveConstructor">[]</a><a id="813" class="Symbol">)</a> <a id="815" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="817" class="Symbol">(</a><a id="818" class="Number">1.0</a> <a id="822" class="InductiveConstructor Operator">∷</a> <a id="824" class="InductiveConstructor">[]</a><a id="826" class="Symbol">)</a>
<a id="828" class="Symbol">_</a> <a id="830" class="Symbol">=</a> <a id="832" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>


<a id="839" class="Comment">-- Test some valid constraints</a>

<a id="constraints"></a><a id="871" href="Identity-1-Linear-1.html#871" class="Function">constraints</a> <a id="883" class="Symbol">:</a> <a id="885" href="Amethyst.Prelude.html#1197" class="Function">NetworkConstraints</a> <a id="904" class="Number">1</a> <a id="906" class="Number">1</a>
<a id="908" href="Identity-1-Linear-1.html#871" class="Function">constraints</a> <a id="920" class="Symbol">(</a><a id="921" href="Identity-1-Linear-1.html#921" class="Bound">i</a> <a id="923" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="925" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="927" class="Symbol">)</a> <a id="929" class="Symbol">(</a><a id="930" href="Identity-1-Linear-1.html#930" class="Bound">o</a> <a id="932" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="934" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="936" class="Symbol">)</a> <a id="938" class="Symbol">=</a>
  <a id="942" class="Symbol">(</a><a id="943" href="Identity-1-Linear-1.html#921" class="Bound">i</a> <a id="945" href="Amethyst.Prelude.html#3043" class="Function Operator">==</a> <a id="948" href="Amethyst.Prelude.html#2660" class="Function">0·0f</a> <a id="953" href="Amethyst.Prelude.html#2359" class="Function Operator">⇒</a> <a id="955" href="Identity-1-Linear-1.html#930" class="Bound">o</a> <a id="957" href="Amethyst.Prelude.html#3043" class="Function Operator">==</a> <a id="960" href="Amethyst.Prelude.html#2660" class="Function">0·0f</a><a id="964" class="Symbol">)</a> <a id="966" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a>
  <a id="970" class="Symbol">(</a><a id="971" href="Identity-1-Linear-1.html#921" class="Bound">i</a> <a id="973" href="Amethyst.Prelude.html#3043" class="Function Operator">==</a> <a id="976" href="Amethyst.Prelude.html#2665" class="Function">1·0f</a> <a id="981" href="Amethyst.Prelude.html#2359" class="Function Operator">⇒</a> <a id="983" href="Identity-1-Linear-1.html#930" class="Bound">o</a> <a id="985" href="Amethyst.Prelude.html#3043" class="Function Operator">==</a> <a id="988" href="Amethyst.Prelude.html#2665" class="Function">1·0f</a><a id="992" class="Symbol">)</a> <a id="994" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a>
  <a id="998" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="1002" href="Identity-1-Linear-1.html#1002" class="Function">_</a> <a id="1004" class="Symbol">:</a> <a id="1006" href="SMT.Backend.Z3.html#1871" class="Macro">z3</a> <a id="1009" class="Symbol">(</a><a id="1010" href="Amethyst.Prelude.html#1551" class="Function">query</a> <a id="1016" href="Identity-1-Linear-1.html#672" class="Function">model</a> <a id="1022" href="Identity-1-Linear-1.html#871" class="Function">constraints</a><a id="1033" class="Symbol">)</a> <a id="1035" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1037" href="SMT.Script.Base.html#5913" class="InductiveConstructor">unsat</a> <a id="1043" class="InductiveConstructor Operator">∷</a> <a id="1045" class="InductiveConstructor">[]</a>
<a id="1048" class="Symbol">_</a> <a id="1050" class="Symbol">=</a> <a id="1052" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>


<a id="1059" class="Comment">-- Test some invalid constraints</a>

<a id="invalidConstraints"></a><a id="1093" href="Identity-1-Linear-1.html#1093" class="Function">invalidConstraints</a> <a id="1112" class="Symbol">:</a> <a id="1114" href="Amethyst.Prelude.html#1197" class="Function">NetworkConstraints</a> <a id="1133" class="Number">1</a> <a id="1135" class="Number">1</a>
<a id="1137" href="Identity-1-Linear-1.html#1093" class="Function">invalidConstraints</a> <a id="1156" class="Symbol">(</a><a id="1157" href="Identity-1-Linear-1.html#1157" class="Bound">i</a> <a id="1159" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1161" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1163" class="Symbol">)</a> <a id="1165" class="Symbol">(</a><a id="1166" href="Identity-1-Linear-1.html#1166" class="Bound">o</a> <a id="1168" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1170" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="1172" class="Symbol">)</a> <a id="1174" class="Symbol">=</a>
  <a id="1178" class="Symbol">(</a><a id="1179" href="Identity-1-Linear-1.html#1157" class="Bound">i</a> <a id="1181" href="Amethyst.Prelude.html#3043" class="Function Operator">==</a> <a id="1184" href="Amethyst.Prelude.html#2660" class="Function">0·0f</a> <a id="1189" href="Amethyst.Prelude.html#2359" class="Function Operator">⇒</a> <a id="1191" href="Identity-1-Linear-1.html#1166" class="Bound">o</a> <a id="1193" href="Amethyst.Prelude.html#3043" class="Function Operator">==</a> <a id="1196" href="Amethyst.Prelude.html#2665" class="Function">1·0f</a><a id="1200" class="Symbol">)</a> <a id="1202" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a>
  <a id="1206" class="Symbol">(</a><a id="1207" href="Identity-1-Linear-1.html#1157" class="Bound">i</a> <a id="1209" href="Amethyst.Prelude.html#3043" class="Function Operator">==</a> <a id="1212" href="Amethyst.Prelude.html#2665" class="Function">1·0f</a> <a id="1217" href="Amethyst.Prelude.html#2359" class="Function Operator">⇒</a> <a id="1219" href="Identity-1-Linear-1.html#1166" class="Bound">o</a> <a id="1221" href="Amethyst.Prelude.html#3043" class="Function Operator">==</a> <a id="1224" href="Amethyst.Prelude.html#2665" class="Function">1·0f</a><a id="1228" class="Symbol">)</a> <a id="1230" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a>
  <a id="1234" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="1238" href="Identity-1-Linear-1.html#1238" class="Function">_</a> <a id="1240" class="Symbol">:</a> <a id="1242" href="SMT.Backend.Z3.html#1871" class="Macro">z3</a> <a id="1245" class="Symbol">(</a><a id="1246" href="Amethyst.Prelude.html#1551" class="Function">query</a> <a id="1252" href="Identity-1-Linear-1.html#672" class="Function">model</a> <a id="1258" href="Identity-1-Linear-1.html#1093" class="Function">invalidConstraints</a><a id="1276" class="Symbol">)</a> <a id="1278" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1280" href="SMT.Script.Base.html#5897" class="InductiveConstructor">sat</a> <a id="1284" class="InductiveConstructor Operator">∷</a> <a id="1286" class="InductiveConstructor">[]</a>
<a id="1289" class="Symbol">_</a> <a id="1291" class="Symbol">=</a> <a id="1293" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre></body></html>